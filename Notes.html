<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ML_Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Notes_files/libs/clipboard/clipboard.min.js"></script>
<script src="Notes_files/libs/quarto-html/quarto.js"></script>
<script src="Notes_files/libs/quarto-html/popper.min.js"></script>
<script src="Notes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Notes_files/libs/quarto-html/anchor.min.js"></script>
<link href="Notes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Notes_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Notes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Notes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Notes_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="full-width.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#lesson-1-overview-of-sl-ml" id="toc-lesson-1-overview-of-sl-ml" class="nav-link active" data-scroll-target="#lesson-1-overview-of-sl-ml"><span class="header-section-number">1</span> Lesson 1: Overview of SL &amp; ML</a>
  <ul class="collapse">
  <li><a href="#some-basic-terminologies" id="toc-some-basic-terminologies" class="nav-link" data-scroll-target="#some-basic-terminologies"><span class="header-section-number">1.1</span> Some Basic Terminologies</a></li>
  <li><a href="#some-basic-codes" id="toc-some-basic-codes" class="nav-link" data-scroll-target="#some-basic-codes"><span class="header-section-number">1.2</span> Some basic codes:</a></li>
  <li><a href="#classification-setting" id="toc-classification-setting" class="nav-link" data-scroll-target="#classification-setting"><span class="header-section-number">1.3</span> Classification Setting</a></li>
  </ul></li>
  <li><a href="#lesson-2-unsupervised-learning-i" id="toc-lesson-2-unsupervised-learning-i" class="nav-link" data-scroll-target="#lesson-2-unsupervised-learning-i"><span class="header-section-number">2</span> Lesson 2: Unsupervised Learning I</a>
  <ul class="collapse">
  <li><a href="#principal-components-analysis-pca" id="toc-principal-components-analysis-pca" class="nav-link" data-scroll-target="#principal-components-analysis-pca"><span class="header-section-number">2.1</span> Principal Components Analysis (PCA)</a>
  <ul class="collapse">
  <li><a href="#second-prinipal-component" id="toc-second-prinipal-component" class="nav-link" data-scroll-target="#second-prinipal-component"><span class="header-section-number">2.1.1</span> Second Prinipal Component</a></li>
  <li><a href="#singular-value-decomposition" id="toc-singular-value-decomposition" class="nav-link" data-scroll-target="#singular-value-decomposition"><span class="header-section-number">2.1.2</span> Singular Value Decomposition</a></li>
  </ul></li>
  <li><a href="#proportion-of-variance-explained-pve" id="toc-proportion-of-variance-explained-pve" class="nav-link" data-scroll-target="#proportion-of-variance-explained-pve"><span class="header-section-number">2.2</span> Proportion of Variance Explained (PVE)</a>
  <ul class="collapse">
  <li><a href="#coding" id="toc-coding" class="nav-link" data-scroll-target="#coding"><span class="header-section-number">2.2.1</span> Coding</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#lesson-3-unsupervised-learning-ii" id="toc-lesson-3-unsupervised-learning-ii" class="nav-link" data-scroll-target="#lesson-3-unsupervised-learning-ii"><span class="header-section-number">3</span> Lesson 3: Unsupervised Learning II</a>
  <ul class="collapse">
  <li><a href="#kmeans-clustering" id="toc-kmeans-clustering" class="nav-link" data-scroll-target="#kmeans-clustering"><span class="header-section-number">3.1</span> Kmeans-clustering</a>
  <ul class="collapse">
  <li><a href="#general-steps-in-k-clustering" id="toc-general-steps-in-k-clustering" class="nav-link" data-scroll-target="#general-steps-in-k-clustering"><span class="header-section-number">3.1.1</span> General steps in K-clustering</a></li>
  <li><a href="#practical-application" id="toc-practical-application" class="nav-link" data-scroll-target="#practical-application"><span class="header-section-number">3.1.2</span> Practical Application</a></li>
  </ul></li>
  <li><a href="#hierarchical-clustering---to-copy-over-from-python-notes" id="toc-hierarchical-clustering---to-copy-over-from-python-notes" class="nav-link" data-scroll-target="#hierarchical-clustering---to-copy-over-from-python-notes"><span class="header-section-number">3.2</span> Hierarchical clustering - (To copy over from python notes)</a>
  <ul class="collapse">
  <li><a href="#theory" id="toc-theory" class="nav-link" data-scroll-target="#theory"><span class="header-section-number">3.2.1</span> Theory</a></li>
  <li><a href="#types-of-linkages-and-its-numerical-example" id="toc-types-of-linkages-and-its-numerical-example" class="nav-link" data-scroll-target="#types-of-linkages-and-its-numerical-example"><span class="header-section-number">3.2.2</span> Types of linkages and its numerical example</a></li>
  <li><a href="#additional-information" id="toc-additional-information" class="nav-link" data-scroll-target="#additional-information"><span class="header-section-number">3.2.3</span> Additional information:</a></li>
  <li><a href="#example-code" id="toc-example-code" class="nav-link" data-scroll-target="#example-code"><span class="header-section-number">3.2.4</span> Example Code</a></li>
  <li><a href="#considerations-in-clustering" id="toc-considerations-in-clustering" class="nav-link" data-scroll-target="#considerations-in-clustering"><span class="header-section-number">3.2.5</span> Considerations in Clustering</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#lesson-4-multiple-linear-regression" id="toc-lesson-4-multiple-linear-regression" class="nav-link" data-scroll-target="#lesson-4-multiple-linear-regression"><span class="header-section-number">4</span> Lesson 4: Multiple Linear Regression</a>
  <ul class="collapse">
  <li><a href="#basic-theory-of-regression-model" id="toc-basic-theory-of-regression-model" class="nav-link" data-scroll-target="#basic-theory-of-regression-model"><span class="header-section-number">4.1</span> Basic theory of Regression Model</a></li>
  <li><a href="#dimension-reduction" id="toc-dimension-reduction" class="nav-link" data-scroll-target="#dimension-reduction"><span class="header-section-number">4.2</span> Dimension Reduction</a>
  <ul class="collapse">
  <li><a href="#best-subset-approach" id="toc-best-subset-approach" class="nav-link" data-scroll-target="#best-subset-approach"><span class="header-section-number">4.2.1</span> Best subset approach</a></li>
  <li><a href="#lasso-ridge" id="toc-lasso-ridge" class="nav-link" data-scroll-target="#lasso-ridge"><span class="header-section-number">4.2.2</span> Lasso / Ridge</a></li>
  <li><a href="#pcr-regression" id="toc-pcr-regression" class="nav-link" data-scroll-target="#pcr-regression"><span class="header-section-number">4.2.3</span> PCR regression</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#lesson-5-classification" id="toc-lesson-5-classification" class="nav-link" data-scroll-target="#lesson-5-classification"><span class="header-section-number">5</span> Lesson 5: Classification</a>
  <ul class="collapse">
  <li><a href="#multinomial-logistic-regression" id="toc-multinomial-logistic-regression" class="nav-link" data-scroll-target="#multinomial-logistic-regression"><span class="header-section-number">5.1</span> Multinomial Logistic Regression</a></li>
  <li><a href="#discriminant-analysis" id="toc-discriminant-analysis" class="nav-link" data-scroll-target="#discriminant-analysis"><span class="header-section-number">5.2</span> Discriminant Analysis</a>
  <ul class="collapse">
  <li><a href="#theory-bayes-theorem" id="toc-theory-bayes-theorem" class="nav-link" data-scroll-target="#theory-bayes-theorem"><span class="header-section-number">5.2.1</span> Theory (Bayes Theorem)</a></li>
  <li><a href="#linear-discriminant-analysis-lda" id="toc-linear-discriminant-analysis-lda" class="nav-link" data-scroll-target="#linear-discriminant-analysis-lda"><span class="header-section-number">5.2.2</span> Linear Discriminant Analysis (LDA)</a></li>
  <li><a href="#quadratic-discriminant-analysis-qda" id="toc-quadratic-discriminant-analysis-qda" class="nav-link" data-scroll-target="#quadratic-discriminant-analysis-qda"><span class="header-section-number">5.2.3</span> Quadratic Discriminant Analysis (QDA)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#lesson-6-support-vector-machines" id="toc-lesson-6-support-vector-machines" class="nav-link" data-scroll-target="#lesson-6-support-vector-machines"><span class="header-section-number">6</span> Lesson 6: Support Vector Machines</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ML_Notes</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="lesson-1-overview-of-sl-ml" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Lesson 1: Overview of SL &amp; ML</h1>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Statistical Learning VS Machine Learning</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 58%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Areas</th>
<th style="text-align: left;">Statistical_Learning</th>
<th style="text-align: left;">Machine_Learning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Scope</td>
<td style="text-align: left;">Subfield of Statistics</td>
<td style="text-align: left;">Subfield of AI</td>
</tr>
<tr class="even">
<td style="text-align: left;">Focus</td>
<td style="text-align: left;">Models building and their interpretability</td>
<td style="text-align: left;">Prediction accuracy</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Data</td>
<td style="text-align: left;">Use survey methods / experimental study to collect random data with a particular purpose or objective - understand ideas behind various techniques and accurately assess performance of each technique</td>
<td style="text-align: left;">Collect large or big data set in a routine way - Focuses on large scale applications</td>
</tr>
<tr class="even">
<td style="text-align: left;">Approach</td>
<td style="text-align: left;">Models with predefined assumptions and all data. Interpretable but holds limitations in capturing complex patterns</td>
<td style="text-align: left;">Use training data to build the model with no assumptions and use a test set to evaluation model</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Concern</td>
<td style="text-align: left;">Parameter estimation and hypothesis testing at a certain error rate</td>
<td style="text-align: left;">Bias-variance trade-off and prediction errors</td>
</tr>
<tr class="even">
<td style="text-align: left;">Application</td>
<td style="text-align: left;">Econometrics, biostatistics, finance, etc</td>
<td style="text-align: left;">Natural language proccessing, face recognition, traffic prediction, where predictive accuracy and pattern recognition are paramount</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Supervised learning VS Unsupervised learning</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 32%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Areas</th>
<th style="text-align: left;">Supervised_Learning</th>
<th style="text-align: left;">Unsupervised_Learning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Focus</td>
<td style="text-align: left;">Focus on outcome measurement, Y (dependent variable)</td>
<td style="text-align: left;">No outcome measurement, Y, just a set of predictors</td>
</tr>
<tr class="even">
<td style="text-align: left;">Variables</td>
<td style="text-align: left;">Use p predictor measurements (independent variables)</td>
<td style="text-align: left;">Find features of X that behave similarly or find linear combinations of X with the most variation</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Purpose</td>
<td style="text-align: left;">For regression / classification problems</td>
<td style="text-align: left;">Use unsupervised learning as first step of supervised learning</td>
</tr>
<tr class="even">
<td style="text-align: left;">Concern</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">Difficult to evaluate the performance of approaches because of no outcome measurement for comparisons</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="some-basic-terminologies" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="some-basic-terminologies"><span class="header-section-number">1.1</span> Some Basic Terminologies</h2>
<ul>
<li><p>Reducible Error <span class="math display">\[
f(X) - \hat{f}(X)
\]</span> where <span class="math inline">\(f(X)\)</span> is the true value while <span class="math inline">\(\hat{f}(x)\)</span> is the predicted value</p>
<ul>
<li>We seek to find the most appropriate statistical learning technique that minimises the reducible error</li>
</ul></li>
<li><p>Irreducible Error <span class="math display">\[
\epsilon = Y - f(X)
\]</span></p>
<ul>
<li><span class="math inline">\(\epsilon\)</span> cannot be predicted using <span class="math inline">\(X\)</span></li>
</ul></li>
<li><p>Total Errors The average of the squared difference between the predicted <span class="math inline">\(Y\)</span> and actual value <span class="math inline">\(Y\)</span> is <span class="math display">\[
E(Y-\hat{Y})^2 = E[f(X) +\epsilon -\hat{f}(X)]^2 + Var(\epsilon)
\]</span></p></li>
</ul>
<p><span class="math display">\[
E(Y-\hat{Y})^2 = [f(X)-\hat{f}(X)]^2 + Var(\epsilon)
\]</span></p>
<ul>
<li><p>Estimation of <span class="math inline">\(f\)</span></p>
<ul>
<li>Parametric
<ul>
<li>Assumes a function form/shape of <span class="math inline">\(f\)</span></li>
</ul></li>
<li>Non-parametric
<ul>
<li>Does not assume the shape of <span class="math inline">\(f\)</span></li>
</ul></li>
</ul></li>
<li><p>Training &amp; Testing Data</p>
<p>Objectives:</p>
<ul>
<li>Accurately predict unseen test cases</li>
<li>Understand which independent variables affect the dependent variable, and how</li>
<li>Assess quality of predictions or/and inferences</li>
</ul></li>
<li><p>Prediction Accuracy VS Interpretability</p>
<ul>
<li>More restrictive (less flexibility) means more interpretable in inference objective
<ul>
<li>Less flexibility, it is likely bias is higher. Vice Versa</li>
<li>Less flexibility, it is likely variance is smaller. Vice Versa</li>
</ul></li>
<li>For prediction objective, less restrictive does not always yield the best model.</li>
</ul></li>
</ul>
<p><img src="images/Lesson1_img1.png" class="img-fluid"></p>
<ul>
<li><pre><code>Bias Variance Trade Off</code></pre>
<p><span class="math display">\[
E(y_0-\hat{f}(x_0))^2 = Var(\hat{f}(x_0))+[Bias(\hat{f}(x_0))]^2+Var(\epsilon)
\]</span></p>
<ul>
<li>Bias: Error that is introduced by approximating a real-life situation with a much simpler model <span class="math inline">\(\hat{f}\)</span></li>
<li>Variance: Amount by which <span class="math inline">\(\hat{f}\)</span> would change if we estimated it again using a different training data set</li>
<li>Relationship with flexibility: As flexibility increases, its variance increases while its bias decreases. <img src="images/Lesson1_img2.png" class="img-fluid"></li>
</ul></li>
<li><p>Validation</p>
<ul>
<li>Model is fitted on a training data set and tested with a validation set.</li>
<li>The validation test set provides a validation-set error which provides an estimate of the test error</li>
</ul></li>
<li><p>K-Fold Cross Validation</p>
<ul>
<li>Widely used approach for estimating test error</li>
<li>Randomly divide the data into <span class="math inline">\(K\)</span> equal-sized parts</li>
<li>Results from each K parts are combined at the end</li>
</ul></li>
<li><p>Validation and Cross-Validation</p>
<ul>
<li>Use cross-validation to identify the parameter values for a given approach</li>
<li>Use validation to choose best approach among all the considered approaches</li>
</ul></li>
</ul>
<p>As the foundation of this course is from Statistical learning with R, refer to <a href="file:///Users/junhaoteo/Documents/SMU_Modules/Y2S2/Statistical%20Learning%20with%20R/DSA211_notes.html">Statistical Learning Notes</a> where the various codes can be obtained.</p>
</section>
<section id="some-basic-codes" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="some-basic-codes"><span class="header-section-number">1.2</span> Some basic codes:</h2>
<ul>
<li>Multiple regression model + Quadratic variables</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carseats example in textbook </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)     </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Carseats)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Carseats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Sales"       "CompPrice"   "Income"      "Advertising" "Population" 
 [6] "Price"       "ShelveLoc"   "Age"         "Education"   "Urban"      
[11] "US"         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Carseats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Sales          CompPrice       Income        Advertising    
 Min.   : 0.000   Min.   : 77   Min.   : 21.00   Min.   : 0.000  
 1st Qu.: 5.390   1st Qu.:115   1st Qu.: 42.75   1st Qu.: 0.000  
 Median : 7.490   Median :125   Median : 69.00   Median : 5.000  
 Mean   : 7.496   Mean   :125   Mean   : 68.66   Mean   : 6.635  
 3rd Qu.: 9.320   3rd Qu.:135   3rd Qu.: 91.00   3rd Qu.:12.000  
 Max.   :16.270   Max.   :175   Max.   :120.00   Max.   :29.000  
   Population        Price        ShelveLoc        Age          Education   
 Min.   : 10.0   Min.   : 24.0   Bad   : 96   Min.   :25.00   Min.   :10.0  
 1st Qu.:139.0   1st Qu.:100.0   Good  : 85   1st Qu.:39.75   1st Qu.:12.0  
 Median :272.0   Median :117.0   Medium:219   Median :54.50   Median :14.0  
 Mean   :264.8   Mean   :115.8                Mean   :53.32   Mean   :13.9  
 3rd Qu.:398.5   3rd Qu.:131.0                3rd Qu.:66.00   3rd Qu.:16.0  
 Max.   :509.0   Max.   :191.0                Max.   :80.00   Max.   :18.0  
 Urban       US     
 No :118   No :142  
 Yes:282   Yes:258  
                    
                    
                    
                    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#multiple regression model including all independent variables</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>lm.carseat1<span class="ot">=</span><span class="fu">lm</span>(Sales<span class="sc">~</span>., <span class="at">data=</span>Carseats)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.carseat1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ ., data = Carseats)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.8692 -0.6908  0.0211  0.6636  3.4115 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      5.6606231  0.6034487   9.380  &lt; 2e-16 ***
CompPrice        0.0928153  0.0041477  22.378  &lt; 2e-16 ***
Income           0.0158028  0.0018451   8.565 2.58e-16 ***
Advertising      0.1230951  0.0111237  11.066  &lt; 2e-16 ***
Population       0.0002079  0.0003705   0.561    0.575    
Price           -0.0953579  0.0026711 -35.700  &lt; 2e-16 ***
ShelveLocGood    4.8501827  0.1531100  31.678  &lt; 2e-16 ***
ShelveLocMedium  1.9567148  0.1261056  15.516  &lt; 2e-16 ***
Age             -0.0460452  0.0031817 -14.472  &lt; 2e-16 ***
Education       -0.0211018  0.0197205  -1.070    0.285    
UrbanYes         0.1228864  0.1129761   1.088    0.277    
USYes           -0.1840928  0.1498423  -1.229    0.220    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.019 on 388 degrees of freedom
Multiple R-squared:  0.8734,    Adjusted R-squared:  0.8698 
F-statistic: 243.4 on 11 and 388 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple regression model with significant factors</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>lm.carseat2<span class="ot">=</span><span class="fu">lm</span>(Sales<span class="sc">~</span>CompPrice<span class="sc">+</span>Income<span class="sc">+</span>Advertising<span class="sc">+</span>Price<span class="sc">+</span>ShelveLoc<span class="sc">+</span>Age, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>Carseats)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.carseat2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ CompPrice + Income + Advertising + Price + 
    ShelveLoc + Age, data = Carseats)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.7728 -0.6954  0.0282  0.6732  3.3292 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      5.475226   0.505005   10.84   &lt;2e-16 ***
CompPrice        0.092571   0.004123   22.45   &lt;2e-16 ***
Income           0.015785   0.001838    8.59   &lt;2e-16 ***
Advertising      0.115903   0.007724   15.01   &lt;2e-16 ***
Price           -0.095319   0.002670  -35.70   &lt;2e-16 ***
ShelveLocGood    4.835675   0.152499   31.71   &lt;2e-16 ***
ShelveLocMedium  1.951993   0.125375   15.57   &lt;2e-16 ***
Age             -0.046128   0.003177  -14.52   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.019 on 392 degrees of freedom
Multiple R-squared:  0.872, Adjusted R-squared:  0.8697 
F-statistic: 381.4 on 7 and 392 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm.carseat2, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      2.5 %      97.5 %
(Intercept)      4.48236820  6.46808427
CompPrice        0.08446498  0.10067795
Income           0.01217210  0.01939784
Advertising      0.10071856  0.13108825
Price           -0.10056844 -0.09006946
ShelveLocGood    4.53585700  5.13549250
ShelveLocMedium  1.70550103  2.19848429
Age             -0.05237301 -0.03988204</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lm.carseat2, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">data.frame</span>(<span class="at">CompPrice=</span><span class="dv">116</span>, <span class="at">Income=</span><span class="dv">80</span>, <span class="at">Advertising=</span><span class="dv">7</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Price=</span><span class="dv">100</span>, <span class="at">ShelveLoc=</span><span class="st">"Good"</span>, <span class="at">Age=</span><span class="dv">56</span>), </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval=</span><span class="st">"confidence"</span>, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">level=</span>.<span class="dv">95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 11.00828 10.77329 11.24326</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lm.carseat2, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">data.frame</span>(<span class="at">CompPrice=</span><span class="dv">116</span>, <span class="at">Income=</span><span class="dv">80</span>, <span class="at">Advertising=</span><span class="dv">7</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Price=</span><span class="dv">100</span>, <span class="at">ShelveLoc=</span><span class="st">"Good"</span>, <span class="at">Age=</span><span class="dv">56</span>), </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval=</span><span class="st">"prediction"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">level=</span>.<span class="dv">95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit    lwr      upr
1 11.00828 8.9903 13.02625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quadratic relationship</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>lm.carseat3<span class="ot">=</span><span class="fu">lm</span>(Sales<span class="sc">~</span>CompPrice<span class="sc">+</span>Income<span class="sc">+</span>Advertising<span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                 Price<span class="sc">+</span>ShelveLoc<span class="sc">+</span>Age<span class="sc">+</span><span class="fu">I</span>(Price<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>Carseats)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.carseat3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ CompPrice + Income + Advertising + Price + 
    ShelveLoc + Age + I(Price^2), data = Carseats)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.7580 -0.7084  0.0344  0.6883  3.2802 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      5.988e+00  8.756e-01   6.839 3.09e-11 ***
CompPrice        9.268e-02  4.129e-03  22.448  &lt; 2e-16 ***
Income           1.577e-02  1.839e-03   8.576 2.32e-16 ***
Advertising      1.163e-01  7.744e-03  15.012  &lt; 2e-16 ***
Price           -1.050e-01  1.380e-02  -7.613 2.03e-13 ***
ShelveLocGood    4.832e+00  1.527e-01  31.645  &lt; 2e-16 ***
ShelveLocMedium  1.953e+00  1.255e-01  15.564  &lt; 2e-16 ***
Age             -4.603e-02  3.182e-03 -14.466  &lt; 2e-16 ***
I(Price^2)       4.227e-05  5.896e-05   0.717    0.474    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.02 on 391 degrees of freedom
Multiple R-squared:  0.8722,    Adjusted R-squared:  0.8695 
F-statistic: 333.4 on 8 and 391 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>Code for train-test split for multiple regression</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Auto)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3344</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>Auto1 <span class="ot">&lt;-</span> Auto[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Auto1), <span class="dv">200</span>) <span class="co">#sample 200 out of the whole sample size</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="sc">-</span>train</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>auto.train <span class="ot">&lt;-</span> Auto1[train,]</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>auto.test <span class="ot">&lt;-</span> Auto1[test,]</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple regression model</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg<span class="sc">~</span>., <span class="at">data=</span>auto.train)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>lm.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm.fit, auto.test)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>mse.mrm <span class="ot">&lt;-</span> <span class="fu">mean</span>((auto.test<span class="sc">$</span>mpg<span class="sc">-</span>lm.pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>mse.mrm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.55657</code></pre>
</div>
</div>
<ul>
<li>Lasso &amp; Ridge Regularization</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lasso </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>train.x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mpg<span class="sc">~</span>., <span class="at">data=</span>auto.train)[,<span class="sc">-</span><span class="dv">1</span>]      <span class="co"># Remove the intercept</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>train.y <span class="ot">&lt;-</span>auto.train<span class="sc">$</span>mpg</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>test.x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mpg<span class="sc">~</span>., <span class="at">data=</span>auto.test)[,<span class="sc">-</span><span class="dv">1</span>]        <span class="co"># Remove the intercept</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>test.y <span class="ot">&lt;-</span> auto.test<span class="sc">$</span>mpg</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>lasso.mod <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(train.x, train.y, <span class="at">alpha=</span><span class="dv">1</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>cv.out <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(train.x, train.y, <span class="at">alpha=</span><span class="dv">1</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nfolds =</span> <span class="dv">10</span>)            <span class="co"># Default 10 Fold, change this for other fold value</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>lambda.lasso <span class="ot">&lt;-</span> cv.out<span class="sc">$</span>lambda.min</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>lambda.lasso</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.007414423</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>lasso.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lasso.mod, <span class="at">newx=</span>test.x, <span class="at">s=</span>lambda.lasso)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>mse.lasso <span class="ot">&lt;-</span> <span class="fu">mean</span>((test.y<span class="sc">-</span>lasso.pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>mse.lasso</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.52336</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ridge regression</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ridge.mod <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(train.x, train.y, <span class="at">alpha=</span><span class="dv">0</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>cv.out <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(train.x, train.y, <span class="at">alpha=</span><span class="dv">0</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>lambda.rr <span class="ot">&lt;-</span> cv.out<span class="sc">$</span>lambda.min</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>lambda.rr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6600431</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ridge.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge.mod, <span class="at">newx=</span>test.x, <span class="at">s=</span>lambda.rr)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>mse.rr <span class="ot">&lt;-</span> <span class="fu">mean</span>((test.y<span class="sc">-</span>ridge.pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>mse.rr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.00824</code></pre>
</div>
</div>
<p>After comparing all models above using the Auto Dataset, we have that Lasso is the best model.</p>
<p>Rebuild the model using all of the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mpg<span class="sc">~</span>., <span class="at">data=</span>Auto1)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Auto1<span class="sc">$</span>mpg</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>out.lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y, <span class="at">alpha=</span><span class="dv">1</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>lasso.m2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(out.lasso, <span class="at">type=</span><span class="st">"coefficients"</span>, <span class="at">s=</span>lambda.lasso)[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,]</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>lasso.m2[lasso.m2<span class="sc">!=</span><span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)     cylinders  displacement    horsepower        weight 
-17.226062638  -0.388797977   0.016409017  -0.015275841  -0.006357916 
 acceleration          year        origin 
  0.073666083   0.747775775   1.380164964 </code></pre>
</div>
</div>
</section>
<section id="classification-setting" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="classification-setting"><span class="header-section-number">1.3</span> Classification Setting</h2>
<ul>
<li><p>Testing Error for Classification</p></li>
<li><p>Confusion Matrix</p></li>
</ul>
<p><img src="images/Lesson1_img3.png" class="img-fluid"></p>
</section>
</section>
<section id="lesson-2-unsupervised-learning-i" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Lesson 2: Unsupervised Learning I</h1>
<section id="principal-components-analysis-pca" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="principal-components-analysis-pca"><span class="header-section-number">2.1</span> Principal Components Analysis (PCA)</h2>
<ul>
<li><p>What is it?</p>
<ul>
<li>A dimensionality reduction method by reducing the dimensionality of large data sets</li>
<li>Finds a sequence of linear combinations of the variables that have <strong>maximal variance</strong>, and <strong>mutually uncorrelated</strong></li>
</ul></li>
</ul>
<p><span class="math display">\[
X_1, X_2, â€¦, X_{1000} \\
\text{The above is converted through PCA to output: } \\
Var(Y_1+Y_2) = Var(Y_1)+Var(Y_2)+2Cov(Y_1, Y_2)
\]</span></p>
<pre><code>-   Reducing dimension comes at the expense of accuracy, but essentially to trade little accuracy for simplicity
    -   Low dimension data sets are easier to explore and visualize and makes analysing data points easier and faster for machine learning</code></pre>
<ul>
<li>Applications of PCA</li>
</ul>
<p>Use the principal components:</p>
<pre><code>- In understanding and visualising the data
- As a tool for data imputation, for filling in missing values (No time to cover)
- As predictors in a regression model, instead of original larger set of independent variables</code></pre>
<ul>
<li>Mathematical Representation of PCA</li>
</ul>
<p>Each observation (row) is multiplied to the loading vector to obtain the scores, <span class="math inline">\(Z\)</span>.</p>
<p>Loading vector <span class="math display">\[
\phi_i = (\phi_{11}, \phi_{21},... \phi_{p1})^T
\]</span></p>
<p>Under PCA, the objective is to minimise the perpendicular distance from the observation to the line. As such the distance of the line is maximised.</p>
<p>Goal: <span class="math display">\[
\max{\frac{\sum^{n}_{i=1} Z_i^2} {n}}
\]</span> (To input graphs from slides)</p>
<section id="second-prinipal-component" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="second-prinipal-component"><span class="header-section-number">2.1.1</span> Second Prinipal Component</h3>
<p>Steps are similar to the First Principal Component, however, it has to be uncorrelated with <span class="math inline">\(Z_1\)</span>.</p>
</section>
<section id="singular-value-decomposition" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="singular-value-decomposition"><span class="header-section-number">2.1.2</span> Singular Value Decomposition</h3>
<p>(TO ADD IN THEORY)</p>
<section id="simple-numerical-example-of-singular-value-decomposition---manual-calculation" class="level4" data-number="2.1.2.1">
<h4 data-number="2.1.2.1" class="anchored" data-anchor-id="simple-numerical-example-of-singular-value-decomposition---manual-calculation"><span class="header-section-number">2.1.2.1</span> Simple Numerical Example of Singular Value Decomposition - Manual calculation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">3</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(data, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    3    1    4    1
[2,]    5    9    2    6
[3,]    5    3    5    8
[4,]    9    7    9    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>sA <span class="ot">&lt;-</span> <span class="fu">svd</span>(A) <span class="co"># Do SVD</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "d" "u" "v"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> sA<span class="sc">$</span>d</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> sA<span class="sc">$</span>u</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> sA<span class="sc">$</span>v</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">diag</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(U, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]  [,4]
[1,] -0.21  0.37 -0.13 -0.89
[2,] -0.52 -0.70  0.43 -0.23
[3,] -0.48 -0.21 -0.84  0.15
[4,] -0.67  0.57  0.31  0.36</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">t</span>(V), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]  [,4]
[1,] -0.55 -0.52 -0.49 -0.43
[2,]  0.26 -0.40  0.65 -0.59
[3,]  0.07  0.70 -0.22 -0.68
[4,]  0.79 -0.29 -0.54 -0.04</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(D, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4]
[1,] 21.23 0.00 0.00 0.00
[2,]  0.00 6.43 0.00 0.00
[3,]  0.00 0.00 4.88 0.00
[4,]  0.00 0.00 0.00 0.15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">t</span>(V) <span class="sc">%*%</span> V, <span class="dv">2</span>) <span class="co"># Matrix multiplication - Becomes identity matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">t</span>(U) <span class="sc">%*%</span> U, <span class="dv">2</span>) <span class="co"># Matrix multiplication - Becomes identity matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(U <span class="sc">%*%</span> D <span class="sc">%*%</span> <span class="fu">t</span>(V), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    3    1    4    1
[2,]    5    9    2    6
[3,]    5    3    5    8
[4,]    9    7    9    3</code></pre>
</div>
</div>
<p>Using the example above, we have that:</p>
<p><img src="images/Lesson2_img1.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> U[,<span class="dv">1</span>]</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>u1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2147262 -0.5186023 -0.4814399 -0.6731715</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> V[,<span class="dv">1</span>]</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>v1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5512099 -0.5199228 -0.4880448 -0.4331977</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> d[<span class="dv">1</span>]</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>d1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.23136</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> u1 <span class="sc">%*%</span> <span class="fu">t</span>(v1)<span class="sc">*</span>d1</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(A1,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,] 2.51 2.37 2.22 1.97
[2,] 6.07 5.72 5.37 4.77
[3,] 5.63 5.31 4.99 4.43
[4,] 7.88 7.43 6.98 6.19</code></pre>
</div>
</div>
<p>We see that A1 is still quite far from the original A matrix. By adding another principal component we have:</p>
<p><img src="images/Lesson2_img2.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> U[,<span class="dv">2</span>]</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>u2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.3739765 -0.7013767 -0.2082253  0.5699602</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> V[,<span class="dv">2</span>]</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>v2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.2648388 -0.4000607  0.6500900 -0.5892325</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d[<span class="dv">2</span>]</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>d2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.432445</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>A2 <span class="ot">&lt;-</span> u2 <span class="sc">%*%</span> <span class="fu">t</span>(v2)<span class="sc">*</span>d2</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(A2,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]  [,4]
[1,]  0.64 -0.96  1.56 -1.42
[2,] -1.19  1.80 -2.93  2.66
[3,] -0.35  0.54 -0.87  0.79
[4,]  0.97 -1.47  2.38 -2.16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>A1A2 <span class="ot">&lt;-</span> A1<span class="sc">+</span>A2</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(A1A2,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,] 3.15 1.41 3.79 0.56
[2,] 4.87 7.53 2.44 7.43
[3,] 5.28 5.85 4.12 5.22
[4,] 8.85 5.96 9.36 4.03</code></pre>
</div>
</div>
<p>From the above, we see that with PC1 and PC2, it gets closer to the original A matrix.</p>
<p>Repeating the steps one more time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>u3 <span class="ot">&lt;-</span> U[,<span class="dv">3</span>]</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>u3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1315028  0.4302032 -0.8377092  0.3096378</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> V[,<span class="dv">3</span>]</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>v3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.07265877  0.69537763 -0.21865293 -0.68070665</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> d[<span class="dv">3</span>]</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>d3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.881755</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> u3 <span class="sc">%*%</span> <span class="fu">t</span>(v3)<span class="sc">*</span>d3</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(A3,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]  [,4]
[1,] -0.05 -0.45  0.14  0.44
[2,]  0.15  1.46 -0.46 -1.43
[3,] -0.30 -2.84  0.89  2.78
[4,]  0.11  1.05 -0.33 -1.03</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>A1A2A3 <span class="ot">&lt;-</span> A1<span class="sc">+</span>A2<span class="sc">+</span>A3</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(A1A2A3, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,] 3.10 0.96 3.93 0.99
[2,] 5.03 8.99 1.98 6.00
[3,] 4.98 3.01 5.01 8.00
[4,] 8.96 7.02 9.03 3.00</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="proportion-of-variance-explained-pve" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="proportion-of-variance-explained-pve"><span class="header-section-number">2.2</span> Proportion of Variance Explained (PVE)</h2>
<ul>
<li><p>Determines the number of principal components</p>
<ul>
<li>PVEs should sum to one when maximum number of principal component is used</li>
</ul></li>
</ul>
<section id="coding" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="coding"><span class="header-section-number">2.2.1</span> Coding</h3>
<p>Using another numerical example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">21</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">34</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">43</span>, <span class="dv">59</span>, <span class="dv">20</span>, <span class="dv">35</span>, <span class="dv">30</span>, <span class="dv">48</span>, <span class="dv">32</span>, <span class="dv">56</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">matrix</span>(data, <span class="at">nrow=</span><span class="dv">6</span>)  <span class="co"># data matrix with dimension 6x3</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]   12   26   20
[2,]   13   34   35
[3,]   15   28   30
[4,]   17   29   48
[5,]   21   43   32
[6,]   24   59   56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual calculation</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">scale</span>(M)  <span class="co"># scale the matrix M, to ensure data has a mean of 0</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>               <span class="co"># The standard deviation is also adjusted to 1</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(X, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]    [,2]    [,3]
[1,] -1.0660 -0.8335 -1.2919
[2,] -0.8528 -0.1985 -0.1407
[3,] -0.4264 -0.6747 -0.5245
[4,]  0.0000 -0.5954  0.8570
[5,]  0.8528  0.5160 -0.3710
[6,]  1.4924  1.7861  1.4710
attr(,"scaled:center")
[1] 17.00000 36.50000 36.83333
attr(,"scaled:scale")
[1]  4.690416 12.597619 13.029454</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>sX <span class="ot">&lt;-</span> <span class="fu">svd</span>(X) <span class="co"># do SVD</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "d" "u" "v"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> sX<span class="sc">$</span>d</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> sX<span class="sc">$</span>u</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> sX<span class="sc">$</span>v</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">diag</span>(d)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(U, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]    [,2]    [,3]
[1,] -0.5148 -0.2737  0.1578
[2,] -0.1979  0.1764  0.6615
[3,] -0.2636  0.0004 -0.2499
[4,]  0.0322  0.7302 -0.4417
[5,]  0.1724 -0.5997 -0.4325
[6,]  0.7717 -0.0337  0.3047</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(V, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]    [,2]    [,3]
[1,] 0.5987 -0.3116 -0.7379
[2,] 0.5890 -0.4531  0.6692
[3,] 0.5428  0.8353  0.0877</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(D, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]   [,2]   [,3]
[1,] 3.5557 0.0000 0.0000
[2,] 0.0000 1.3496 0.0000
[3,] 0.0000 0.0000 0.7318</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">t</span>(V) <span class="sc">%*%</span> V, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    0    0
[2,]    0    1    0
[3,]    0    0    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">t</span>(U) <span class="sc">%*%</span> U, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    0    0
[2,]    0    1    0
[3,]    0    0    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(U <span class="sc">%*%</span> D <span class="sc">%*%</span> <span class="fu">t</span>(V), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]    [,2]    [,3]
[1,] -1.0660 -0.8335 -1.2919
[2,] -0.8528 -0.1985 -0.1407
[3,] -0.4264 -0.6747 -0.5245
[4,]  0.0000 -0.5954  0.8570
[5,]  0.8528  0.5160 -0.3710
[6,]  1.4924  1.7861  1.4710</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>pcs <span class="ot">&lt;-</span> U <span class="sc">%*%</span> D</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>pcs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]          [,2]       [,3]
[1,] -1.8304133 -0.3693701932  0.1155180
[2,] -0.7038288  0.2380860647  0.4841423
[3,] -0.9373818  0.0004838648 -0.1828813
[4,]  0.1145313  0.9855754071 -0.3232196
[5,]  0.6131207 -0.8093127525 -0.3165460
[6,]  2.7439719 -0.0454623909  0.2229866</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>pcss <span class="ot">&lt;-</span> X <span class="sc">%*%</span> V</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>pcss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]          [,2]       [,3]
[1,] -1.8304133 -0.3693701932  0.1155180
[2,] -0.7038288  0.2380860647  0.4841423
[3,] -0.9373818  0.0004838648 -0.1828813
[4,]  0.1145313  0.9855754071 -0.3232196
[5,]  0.6131207 -0.8093127525 -0.3165460
[6,]  2.7439719 -0.0454623909  0.2229866</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using pcob</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>pcob <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(M, <span class="at">scale=</span><span class="cn">TRUE</span>)  <span class="co"># use R function prcomp, with scaling</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>                               <span class="co"># Use scaling when the features are very different.</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pcob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sdev"     "rotation" "center"   "scale"    "x"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pcob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2     PC3
Standard deviation     1.5902 0.6036 0.32729
Proportion of Variance 0.8429 0.1214 0.03571
Cumulative Proportion  0.8429 0.9643 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>pcob<span class="sc">$</span>sdev      <span class="co"># standard deviation from PCs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5901502 0.6035781 0.3272855</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>pcob<span class="sc">$</span>rotation  <span class="co"># same as matrix V</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           PC1        PC2         PC3
[1,] 0.5986878 -0.3115670 -0.73790166
[2,] 0.5890133 -0.4530530  0.66918331
[3,] 0.5428040  0.8352658  0.08772019</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>pcob<span class="sc">$</span>center    <span class="co"># means for scaling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.00000 36.50000 36.83333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>pcob<span class="sc">$</span>scale     <span class="co"># sd for scaling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  4.690416 12.597619 13.029454</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>pcob<span class="sc">$</span>x        <span class="co"># XV or UD</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            PC1           PC2        PC3
[1,] -1.8304133 -0.3693701932  0.1155180
[2,] -0.7038288  0.2380860647  0.4841423
[3,] -0.9373818  0.0004838648 -0.1828813
[4,]  0.1145313  0.9855754071 -0.3232196
[5,]  0.6131207 -0.8093127525 -0.3165460
[6,]  2.7439719 -0.0454623909  0.2229866</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>totalsum <span class="ot">&lt;-</span> <span class="fu">sum</span>(pcss<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># total sum</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>pc1sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(pcss[,<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="co"># sum from PC1</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>pc2sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(pcss[,<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="co"># sum from PC2</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>pc3sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(pcss[,<span class="dv">3</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="co"># sum from PC3</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">c</span>(pc1sum, pc2sum, pc3sum)<span class="sc">/</span>(<span class="dv">6-1</span>)) <span class="co"># n-1=6-1=5 </span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>sd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5901502 0.6035781 0.3272855</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>totalsum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>pc1sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.64289</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>pc2sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.821532</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>pc3sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.535579</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>propvar <span class="ot">&lt;-</span> <span class="fu">c</span>(pc1sum, pc2sum, pc3sum)<span class="sc">/</span>totalsum</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(propvar, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8429 0.1214 0.0357</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pcob, <span class="at">scale=</span><span class="dv">0</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pcob<span class="sc">$</span>x[,<span class="dv">1</span>], pcob<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">xlab=</span><span class="st">"PC1"</span>, <span class="at">ylab=</span><span class="st">"PC2"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Plot PC1 vs. PC2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Using the US Arrest Dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the USArrests data and set row names as state names</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"USArrests"</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">row.names</span>(USArrests)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(USArrests) <span class="ot">&lt;-</span> states</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Display dimensions and variable names of the dataset</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(USArrests)</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="co"># names(USArrests)</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Optionally, calculate means and standard deviations for each variable</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="co"># apply(USArrests, 2, mean)</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="co"># apply(USArrests, 2, sd)</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA on the scaled data</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>pr.out <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(USArrests, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pr.out) <span class="co"># 2 principal components are sufficient</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2     PC3     PC4
Standard deviation     1.5749 0.9949 0.59713 0.41645
Proportion of Variance 0.6201 0.2474 0.08914 0.04336
Cumulative Proportion  0.6201 0.8675 0.95664 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the components of the PCA output</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>center  <span class="co"># Mean of each variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Murder  Assault UrbanPop     Rape 
   7.788  170.760   65.540   21.232 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>scale   <span class="co"># Scaling applied to each variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Murder   Assault  UrbanPop      Rape 
 4.355510 83.337661 14.474763  9.366385 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>rotation  <span class="co"># The rotation (loading of each variable on the principal components)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                PC1        PC2        PC3         PC4
Murder   -0.5358995  0.4181809 -0.3412327  0.64922780
Assault  -0.5831836  0.1879856 -0.2681484 -0.74340748
UrbanPop -0.2781909 -0.8728062 -0.3780158  0.13387773
Rape     -0.5434321 -0.1673186  0.8177779  0.08902432</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dimensions and plot of the first two principal components</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pr.out<span class="sc">$</span>x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50  4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pr.out, <span class="at">scale =</span> <span class="dv">0</span>, <span class="at">main =</span> <span class="st">"The first two Principal Components"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For the above graph, the top represents PC1 score while the right scale represents PC2 score.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To create a mirrored version of the biplot</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="do">## The software may result in different sign for its loading vectors, the rotation converts the sign.</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>rotation <span class="ot">&lt;-</span> <span class="sc">-</span>pr.out<span class="sc">$</span>rotation</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="sc">-</span>pr.out<span class="sc">$</span>x</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pr.out, <span class="at">scale =</span> <span class="dv">0</span>, <span class="at">main =</span> <span class="st">"The first two Principal Components mirror image"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the proportion of variance explained by each principal component</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>pr.var <span class="ot">&lt;-</span> pr.out<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>pve <span class="ot">&lt;-</span> pr.var<span class="sc">/</span><span class="fu">sum</span>(pr.var)</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(pve, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6201 0.2474 0.0891 0.0434</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the variance explained</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pve, <span class="at">xlab =</span> <span class="st">"Principal Component"</span>, <span class="at">ylab =</span> <span class="st">"Proportion of Variance Explained"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">type =</span> <span class="st">"b"</span>)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cumsum</span>(pve), <span class="at">xlab =</span> <span class="st">"Cumulative Principal Component"</span>, <span class="at">ylab =</span> <span class="st">"Proportion of Variance Explained"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">type =</span> <span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="lesson-3-unsupervised-learning-ii" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Lesson 3: Unsupervised Learning II</h1>
<section id="kmeans-clustering" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="kmeans-clustering"><span class="header-section-number">3.1</span> Kmeans-clustering</h2>
<p>An approach for partitioning a dataset into <span class="math inline">\(K\)</span> distinct, non-overlapping clusters - Properties</p>
<pre><code>- Each observation belongs to at least one of the K clusters
- Clusters are non-overlapping: No observation belongs to more than one cluster</code></pre>
<ul>
<li><p>Within Cluster Variation <span class="math display">\[
\min_{C_1,...,C_K} \{\sum^K_{k=1} WCV(C_k) \}
\]</span> The formula above is to be solved such that the total within-cluster variation, summed over all <span class="math inline">\(K\)</span> clusters, is minimised.</p>
<ul>
<li>Euclidean distance calculation: <span class="math display">\[
WCV(C_k)= \frac{1}{|C_k|} \sum_{i,i'\epsilon C_k} \sum^p_{j=1} (x_{ij}-x_{i'j})^2
\]</span> where <span class="math inline">\(|C_k|\)</span> denotes the no. of obs in the <span class="math inline">\(k\)</span>th cluster.</li>
</ul></li>
</ul>
<p><span class="math inline">\((x_{ij}-x_{i'j})^2\)</span> : Represents the distance between two observation</p>
<p>Combining the two formulas above gives us: <span class="math display">\[
\min_{C_1,...,C_K} \{\sum^K_{k=1} \frac{1}{|C_k|} \sum_{i,i'\epsilon C_k} \sum^p_{j=1} (x_{ij}-x_{i'j})^2 \}
\]</span> Can be simplied to: <span class="math display">\[
2\sum_{i\subset C_k}\sum^{p}_{j=1} (x_{ij}-\bar{x}_{kj})^2
\]</span> ${x}_{kj} $ : Represents the mean of the cluster The code chunk below uses the formulas above to deduce the total sum.</p>
<p>(Need more inputs after lesson)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">20</span>)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">27</span>)</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>su1<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="fu">length</span>(d1)) {</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>  su1 <span class="ot">&lt;-</span> su1 <span class="sc">+</span> <span class="fu">sum</span>((d1[i]<span class="sc">-</span>d1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> su1<span class="sc">/</span><span class="fu">length</span>(d1)</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>s1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 85.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>su2<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="fu">length</span>(d2)) {</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  su2 <span class="ot">&lt;-</span> su2 <span class="sc">+</span> <span class="fu">sum</span>((d2[i]<span class="sc">-</span>d2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> su2<span class="sc">/</span><span class="fu">length</span>(d2)</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>s2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>su3<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="fu">length</span>(d3)) {</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  su3 <span class="ot">&lt;-</span> su3 <span class="sc">+</span> <span class="fu">sum</span>((d3[i]<span class="sc">-</span>d3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>s3 <span class="ot">&lt;-</span> su3<span class="sc">/</span><span class="fu">length</span>(d3)</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>s3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 117.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>tots <span class="ot">&lt;-</span> s1<span class="sc">+</span>s2<span class="sc">+</span>s3</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>tots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 239.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>sum1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((d1<span class="sc">-</span><span class="fu">mean</span>(d1))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>sum2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((d2<span class="sc">-</span><span class="fu">mean</span>(d2))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>sum3 <span class="ot">&lt;-</span> <span class="fu">sum</span>((d3<span class="sc">-</span><span class="fu">mean</span>(d3))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>totsum <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(sum1<span class="sc">+</span>sum2<span class="sc">+</span>sum3)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(sum1, sum2, sum3, totsum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  42.8  18.0  58.8 239.2</code></pre>
</div>
</div>
<section id="general-steps-in-k-clustering" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="general-steps-in-k-clustering"><span class="header-section-number">3.1.1</span> General steps in K-clustering</h3>
<ol type="1">
<li><p>Randomly assign a number, from 1 to <span class="math inline">\(K\)</span>, to each observation. These serve as initial cluster assignments.</p></li>
<li><p>Iterate until cluster assignments stop changing:</p>
<p>2.1: For each of the <span class="math inline">\(K\)</span> clusters, compute the cluster centroid. The <span class="math inline">\(k\)</span>th cluster centroid is the vector of the <span class="math inline">\(p\)</span> feature means for the observations in the <span class="math inline">\(k\)</span>th cluster.</p>
<p>2.2: Assign each observation to the cluster whose centroid is closest, defined by the Euclidean distance.</p></li>
</ol>
<p>Visual Representation of the steps:</p>
<p><img src="images/Lesson3_img3.png" class="img-fluid"> #### Example Code of the steps shown above</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">11</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">22</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="co"># x # To view the matrix</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">"plot of X1 and X2"</span>, <span class="at">xlab=</span><span class="st">"X1"</span>, <span class="at">ylab=</span><span class="st">"X2"</span>, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>k.out <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(x, <span class="at">centers =</span> <span class="dv">2</span>, <span class="at">nstart=</span><span class="dv">20</span>)  <span class="co"># centers : No. of clusters, nstart: No. of random sets</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>k.out<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 2 2 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span>(k.out<span class="sc">$</span>cluster<span class="sc">+</span><span class="dv">1</span>), <span class="at">main=</span><span class="st">"K-means Clustering Results with K=2"</span>,</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"X1"</span>, <span class="at">ylab=</span><span class="st">"X2"</span>, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>k.out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 2 clusters of sizes 2, 3

Cluster means:
  [,1]     [,2]
1   17 21.50000
2   12 18.66667

Clustering vector:
[1] 2 2 2 1 1

Within cluster sum of squares by cluster:
[1] 2.500000 6.666667
 (between_SS / total_SS =  81.2 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
<p>Total variation is reduced by 81.2% by clustering them.</p>
<p>Below is how the variation is manually calculated. We can see that the end result is the same as the above</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual calculation of the variation:</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> k.out<span class="sc">$</span>centers[<span class="dv">1</span>,]</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> k.out<span class="sc">$</span>centers[<span class="dv">2</span>,]</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate total sum of squares</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>tot <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">5</span>)</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>  tot[i] <span class="ot">&lt;-</span> (x[i,<span class="dv">1</span>]<span class="sc">-</span><span class="fu">mean</span>(x[,<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(x[i,<span class="dv">2</span>]<span class="sc">-</span><span class="fu">mean</span>(x[,<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>sstot <span class="ot">&lt;-</span> <span class="fu">sum</span>(tot)</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>sstot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the sum of squares due to group 1</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>totg1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">2</span>)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>  totg1[i<span class="dv">-3</span>] <span class="ot">&lt;-</span> (x[i,<span class="dv">1</span>]<span class="sc">-</span>g1[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(x[i,<span class="dv">2</span>]<span class="sc">-</span>g1[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>ssg1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(totg1)</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>ssg1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the sum of squares due to group 2</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>totg2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">3</span>)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  totg2[i] <span class="ot">&lt;-</span> (x[i,<span class="dv">1</span>]<span class="sc">-</span>g2[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(x[i,<span class="dv">2</span>]<span class="sc">-</span>g2[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>ssg2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(totg2)</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>ssg2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the proportion of sum of squares explained by clusters</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span>(ssg1<span class="sc">+</span>ssg2)<span class="sc">/</span>sstot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8121585</code></pre>
</div>
</div>
</section>
<section id="practical-application" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="practical-application"><span class="header-section-number">3.1.2</span> Practical Application</h3>
<section id="initial-visualisation-of-pca" class="level4" data-number="3.1.2.1">
<h4 data-number="3.1.2.1" class="anchored" data-anchor-id="initial-visualisation-of-pca"><span class="header-section-number">3.1.2.1</span> Initial Visualisation of PCA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>score <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Datasets/Score.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Participation     Assignment         Test             Exam       
 Min.   :70.00   Min.   : 27.0   Min.   : 15.00   Min.   : 17.00  
 1st Qu.:76.00   1st Qu.: 81.0   1st Qu.: 50.00   1st Qu.: 53.00  
 Median :78.00   Median : 88.0   Median : 65.00   Median : 64.00  
 Mean   :78.17   Mean   : 83.5   Mean   : 65.38   Mean   : 64.66  
 3rd Qu.:80.00   3rd Qu.: 93.0   3rd Qu.: 85.00   3rd Qu.: 78.00  
 Max.   :86.00   Max.   :100.0   Max.   :100.00   Max.   :100.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 257   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(score)</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="co"># perform PCA</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>pr.out <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(score)  <span class="co"># we do not scale the data  </span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pr.out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                           PC1     PC2     PC3     PC4
Standard deviation     26.6739 12.6139 10.4077 4.20077
Proportion of Variance  0.7139  0.1597  0.1087 0.01771
Cumulative Proportion   0.7139  0.8736  0.9823 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pr.out, <span class="at">scale=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>rotation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      PC1         PC2         PC3          PC4
Participation -0.02389266 -0.02455078  0.02916386  0.998987422
Assignment    -0.32485603 -0.80661523  0.49201636 -0.041956287
Test          -0.75938555  0.53357169  0.37199696 -0.015909112
Exam          -0.56323288 -0.25312127 -0.78656700  0.003271184</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>pc1 <span class="ot">&lt;-</span> pr.out<span class="sc">$</span>x[,<span class="dv">1</span>]</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pc1, score<span class="sc">$</span>Participation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pc1, score<span class="sc">$</span>Assignment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pc1, score<span class="sc">$</span>Test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-20-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pc1, score<span class="sc">$</span>Exam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-20-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="k-means-clustering" class="level4" data-number="3.1.2.2">
<h4 data-number="3.1.2.2" class="anchored" data-anchor-id="k-means-clustering"><span class="header-section-number">3.1.2.2</span> K-means clustering</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>k.out <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(score, <span class="dv">4</span>, <span class="at">nstart=</span><span class="dv">20</span>)  <span class="co"># we set 4 clusters</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>k.out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 4 clusters of sizes 45, 91, 87, 34

Cluster means:
  Participation Assignment     Test     Exam
1      77.80000   87.15556 37.95556 50.57778
2      78.26374   86.12088 63.09890 63.93407
3      78.89655   90.89655 89.05747 80.75862
4      76.55882   52.73529 47.20588 44.05882

Clustering vector:
  [1] 2 3 3 3 3 1 3 2 1 4 3 2 3 3 1 2 3 3 3 2 3 2 3 1 4 2 2 3 4 2 3 2 1 3 2 3 1
 [38] 2 2 2 4 2 1 2 1 3 3 3 4 3 2 2 3 1 4 1 1 2 1 4 1 1 3 3 3 2 2 4 2 4 2 3 4 3
 [75] 2 2 4 2 3 1 4 1 3 2 1 2 2 2 3 2 2 4 3 2 4 2 4 2 3 3 3 1 3 3 1 3 3 4 2 3 2
[112] 3 3 4 3 4 2 4 4 4 2 2 4 3 3 3 2 1 3 2 1 3 3 3 3 3 3 4 3 3 3 2 3 1 2 2 4 2
[149] 1 4 2 2 4 2 3 3 2 3 3 3 3 2 2 4 3 3 4 4 2 2 2 3 3 4 2 2 4 1 1 4 2 1 2 2 1
[186] 2 3 2 2 3 3 3 2 3 2 3 1 1 2 3 2 1 2 1 3 3 1 3 3 3 1 2 3 3 2 2 2 2 2 1 2 2
[223] 1 1 1 1 1 3 2 1 1 3 2 2 2 2 3 1 1 2 2 2 4 2 2 2 1 2 2 2 1 3 3 3 2 4 3

Within cluster sum of squares by cluster:
[1] 13106.00 24081.05 18410.78 20946.44
 (between_SS / total_SS =  70.0 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only K-means</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(score<span class="sc">$</span>Exam, score<span class="sc">$</span>Test, <span class="at">col=</span>(k.out<span class="sc">$</span>cluster<span class="sc">+</span><span class="dv">1</span>), </span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"K-means Clustering Results with K=4 based on Exam and Test scores"</span>,</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Exam"</span>, <span class="at">ylab=</span><span class="st">"Test"</span>, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With PCA</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pr.out<span class="sc">$</span>x[,<span class="dv">1</span>], pr.out<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">col=</span>(k.out<span class="sc">$</span>cluster<span class="sc">+</span><span class="dv">1</span>), </span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"K-means Clustering Results with K=4 based on PCA"</span>,</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"PC1"</span>, <span class="at">ylab=</span><span class="st">"PC2"</span>, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="hierarchical-clustering---to-copy-over-from-python-notes" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="hierarchical-clustering---to-copy-over-from-python-notes"><span class="header-section-number">3.2</span> Hierarchical clustering - (To copy over from python notes)</h2>
<section id="theory" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="theory"><span class="header-section-number">3.2.1</span> Theory</h3>
<ul>
<li><p>Difference to K-Means</p>
<ul>
<li>Does not require pre-determination of clusters</li>
<li>Results in an attractive tree-based representation</li>
<li>Dendrogram is built starting from the leaves and combining clusters up to the trunk (bottom-up clusters)</li>
</ul></li>
<li><p>Methodology (As illustrated below):</p>
<ol type="1">
<li>Start with each point in its own cluster</li>
<li>Identify the closest two clusters and merge them</li>
<li>Repeat Step 1 and 2</li>
<li>Ends when all points are in a single cluster</li>
</ol></li>
</ul>
<p><img src="images/Lesson3_img1.png" class="img-fluid"></p>
<p>For the example above,</p>
<ol type="1">
<li>We start by identifying A and C to be the closest, forming the first part of the Dendrogram</li>
<li>Afterwards, we find the next closest, which is D and E, which forms the second part of the Dendrogram.</li>
<li>Next, cluster AC is closest to B and therefore we merge them together to form one cluster. This is represented in the Dendrogram as well.</li>
<li>Lastly, cluster ACB and cluster DE are merged together, forming the entire Dendrogram</li>
</ol>
</section>
<section id="types-of-linkages-and-its-numerical-example" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="types-of-linkages-and-its-numerical-example"><span class="header-section-number">3.2.2</span> Types of linkages and its numerical example</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Types of Linkages</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 96%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Linkage</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Complete</td>
<td style="text-align: left;">Maximal inter-cluster dissimilarity. Compute all pairwise dissimilarities between the observations in cluster A and the observations in cluster B, and record the largest of these dissimilarities.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Single</td>
<td style="text-align: left;">Minimal inter-cluster dissimilarity. Compute all pairwise dissimilarities between the observations. Compute all pairwise dissimilarities between the observations in cluster A and the observations in cluster B, and record the smallest of these dissimilarities.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Average</td>
<td style="text-align: left;">Mean inter-cluster dissimilarity. Compute all pairwise dissimilarities between the observations in cluster A and the observations in cluster B, and record the average of these dissimilarities.</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Formal formulas: Complete: <span class="math display">\[
d_{CL}(G,H) =\max_{i\space \epsilon \space G,i' \space \epsilon \space H} {d_{ii'}}
\]</span> Letâ€™s say:</p>
<ul>
<li><p>Cluster 1 has 2 observations: <span class="math display">\[
(2, 4), (3, 5)
\]</span></p></li>
<li><p>Cluster 2 has 2 observations: <span class="math display">\[
(4, 6), (7,6)
\]</span></p></li>
<li><p>Cluster 3 has 1 observation: <span class="math display">\[
(5, 9)
\]</span></p></li>
</ul>
<p>The inter-cluster dissimilarity between Clusters 1 and 2:</p>
<ul>
<li><p>(2, 4) and (4, 6) dissimilarity measure =<span class="math inline">\(\sqrt{(2-4)^2+(4-6)^2} = \sqrt{8}\)</span></p></li>
<li><p>(2, 4) and (7, 6) dissimilarity measure =<span class="math inline">\(\sqrt{(2-7)^2+(4-6)^2 }= \sqrt{29}\)</span></p></li>
<li><p>(3, 5) and (4, 6) dissimilarity measure =<span class="math inline">\(\sqrt{(3-4)^2+(5-6)^2}=\sqrt{2}\)</span></p></li>
<li><p>(3, 5) and (7, 6) dissimilarity measure =<span class="math inline">\(\sqrt{(3-7)^2+(5-6)^2}=\sqrt{17}\)</span></p></li>
</ul>
<p>The inter-cluster dissimilarity between Clusters 2 and 3:</p>
<ul>
<li><p>(4, 6) and (5, 9) dissimilarity measure =<span class="math inline">\(\sqrt{(4-5)^2+(6-9)^2} = \sqrt{10}\)</span></p></li>
<li><p>(7, 6) and (5, 9) dissimilarity measure =<span class="math inline">\(\sqrt{(7-5)^2+(6-9)^2 }= \sqrt{13}\)</span></p></li>
</ul>
<p>The inter-cluster dissimilarity between Clusters 1 and 3:</p>
<ul>
<li><p>(2, 4) and (5, 9) dissimilarity measure =<span class="math inline">\(\sqrt{(2-5)^2+(4-9)^2} = \sqrt{34}\)</span></p></li>
<li><p>(3, 5) and (5, 9) dissimilarity measure =<span class="math inline">\(\sqrt{(3-5)^2+(5-9)^2 }= \sqrt{20}\)</span></p></li>
</ul>
<p><strong>Complete linkage</strong>: Focus on farthest pair of points, producing tight, compact clusters</p>
<p>Therefore, inter-cluster dissimilarity between Clusters 1 and 2 = <span class="math inline">\(\max(\sqrt{8},\sqrt{29},\sqrt{2},\sqrt{17})=\sqrt{29}\)</span></p>
<p><strong>Single linkage</strong>: Focuses on closest pair of points, resulting in elongated clusters</p>
<p>Therefore, inter-cluster dissimilarity between Clusters 1 and 2 = <span class="math inline">\(\min(\sqrt{8},\sqrt{29},\sqrt{2},\sqrt{17})=\sqrt{2}\)</span></p>
<p><strong>Average linkage</strong>: Leads to balanced clustering</p>
<p>Therefore, inter-cluster dissimilarity between Clusters 1 and 2 = <span class="math inline">\(\frac{(\sqrt{8}+\sqrt{29}+\sqrt{2}+\sqrt{17})}{4}=3.4377\)</span></p>
</section>
<section id="additional-information" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="additional-information"><span class="header-section-number">3.2.3</span> Additional information:</h3>
<ul>
<li><pre><code>Correlation-based distance</code></pre>
<ul>
<li>If two observations are highly correlated but they have high Euclidean distance, correlation-based distance may be prefered
<ul>
<li>This measure focuses on the shapes of observation profiles rather than their magnitudes</li>
</ul></li>
</ul></li>
</ul>
<p><img src="images/Lesson3_img2.png" class="img-fluid"></p>
</section>
<section id="example-code" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="example-code"><span class="header-section-number">3.2.4</span> Example Code</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>super <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Datasets/Supermarket.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(super)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Customers      Milk         Bread          Beer        Shampoo    
 A      :1   Min.   :0.0   Min.   :0.0   Min.   :0.0   Min.   :0.00  
 B      :1   1st Qu.:0.0   1st Qu.:0.0   1st Qu.:0.0   1st Qu.:0.25  
 C      :1   Median :1.0   Median :1.0   Median :0.0   Median :1.00  
 D      :1   Mean   :1.1   Mean   :0.6   Mean   :1.4   Mean   :0.90  
 E      :1   3rd Qu.:2.0   3rd Qu.:1.0   3rd Qu.:2.5   3rd Qu.:1.00  
 F      :1   Max.   :3.0   Max.   :1.0   Max.   :6.0   Max.   :2.00  
 (Other):4                                                           
     Chips    
 Min.   :0.0  
 1st Qu.:0.0  
 Median :0.5  
 Mean   :1.2  
 3rd Qu.:2.5  
 Max.   :4.0  
              </code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(super)</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9876</span>)</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>k.out <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(super[,<span class="sc">-</span><span class="dv">1</span>], <span class="dv">3</span>, <span class="at">nstart=</span><span class="dv">20</span>) <span class="co"># Remove the customer column</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>k.out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 3 clusters of sizes 3, 4, 3

Cluster means:
       Milk     Bread      Beer   Shampoo     Chips
1 0.6666667 0.3333333 0.3333333 0.3333333 0.3333333
2 2.2500000 1.0000000 0.0000000 1.5000000 0.2500000
3 0.0000000 0.3333333 4.3333333 0.6666667 3.3333333

Clustering vector:
 [1] 2 2 3 3 1 2 2 1 1 3

Within cluster sum of squares by cluster:
[1] 3.333333 2.500000 6.666667
 (between_SS / total_SS =  84.8 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>km.cluster <span class="ot">&lt;-</span> k.out<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that under Dendrogram, the function <em>cutree(tree, cluster)</em> helps us cut the tree such that we achieve the desired number of cluster.</p>
<p><strong>Correlation Distance Graph</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">cor</span>(<span class="fu">t</span>(super[,<span class="sc">-</span><span class="dv">1</span>])))  <span class="co"># find the correlation-based distance</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>kkc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dd, <span class="at">method=</span><span class="st">"complete"</span>)</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kkc, <span class="at">main=</span><span class="st">"Complete Linkage with Correlation-Based Distance"</span>,</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">sub=</span><span class="st">""</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>hc.cluster <span class="ot">&lt;-</span> <span class="fu">cutree</span>(kkc, <span class="dv">3</span>)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>hc.cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 2 1 1 1 3 2 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(km.cluster, hc.cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          hc.cluster
km.cluster 1 2 3
         1 1 1 1
         2 4 0 0
         3 0 3 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>kks <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dd, <span class="at">method=</span><span class="st">"single"</span>)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kks, <span class="at">main=</span><span class="st">"Single Linkage with Correlation-Based Distance"</span>,</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">sub=</span><span class="st">""</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(kks, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 2 1 1 1 3 2 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>kka <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dd, <span class="at">method=</span><span class="st">"average"</span>)</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kka, <span class="at">main=</span><span class="st">"Average Linkage with Correlation-Based Distance"</span>,</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">sub=</span><span class="st">""</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(kka, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 2 1 1 1 3 2 2</code></pre>
</div>
</div>
<p><strong>Euclidean Distance Graph</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Euclidean distance</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>ggc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(super[,<span class="sc">-</span><span class="dv">1</span>]), <span class="at">method=</span><span class="st">"complete"</span>)  <span class="co"># use Euclidean distance</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ggc, <span class="at">main=</span><span class="st">"Complete Linkage with Euclidean Distance"</span>,</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">sub=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(ggc, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 2 3 1 1 3 3 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>ggs <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(super[,<span class="sc">-</span><span class="dv">1</span>]), <span class="at">method=</span><span class="st">"single"</span>)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ggs, <span class="at">main=</span><span class="st">"Single Linkage with Euclidean Distance"</span>,</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">sub=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(ggs, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 3 1 1 1 1 1 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>gga <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(super[,<span class="sc">-</span><span class="dv">1</span>]), <span class="at">method=</span><span class="st">"average"</span>)</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gga, <span class="at">main=</span><span class="st">"Average Linkage with Euclidean Distance"</span>,</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">sub=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-25-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(gga, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 3 1 1 1 1 1 2</code></pre>
</div>
</div>
</section>
<section id="considerations-in-clustering" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="considerations-in-clustering"><span class="header-section-number">3.2.5</span> Considerations in Clustering</h3>
<ol type="1">
<li>Should observations first be standardized?</li>
<li>How many clusters should be used for K-means clustering</li>
<li>For hierarchical clustering, what dissimilarity measure, linkage and cutting point of the dendrogram should be used?</li>
</ol>
</section>
</section>
</section>
<section id="lesson-4-multiple-linear-regression" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Lesson 4: Multiple Linear Regression</h1>
<section id="basic-theory-of-regression-model" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="basic-theory-of-regression-model"><span class="header-section-number">4.1</span> Basic theory of Regression Model</h2>
<ul>
<li>(Copy over from Stat learning)</li>
</ul>
</section>
<section id="dimension-reduction" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="dimension-reduction"><span class="header-section-number">4.2</span> Dimension Reduction</h2>
<section id="best-subset-approach" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="best-subset-approach"><span class="header-section-number">4.2.1</span> Best subset approach</h3>
<ul>
<li>(Copy over from Stat learning)</li>
</ul>
</section>
<section id="lasso-ridge" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="lasso-ridge"><span class="header-section-number">4.2.2</span> Lasso / Ridge</h3>
<ul>
<li>(Copy over from Stat learning)</li>
</ul>
</section>
<section id="pcr-regression" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="pcr-regression"><span class="header-section-number">4.2.3</span> PCR regression</h3>
</section>
</section>
</section>
<section id="lesson-5-classification" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Lesson 5: Classification</h1>
<section id="multinomial-logistic-regression" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="multinomial-logistic-regression"><span class="header-section-number">5.1</span> Multinomial Logistic Regression</h2>
<ul>
<li>Theory to take from python notes</li>
</ul>
</section>
<section id="discriminant-analysis" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="discriminant-analysis"><span class="header-section-number">5.2</span> Discriminant Analysis</h2>
<section id="theory-bayes-theorem" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="theory-bayes-theorem"><span class="header-section-number">5.2.1</span> Theory (Bayes Theorem)</h3>
</section>
<section id="linear-discriminant-analysis-lda" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="linear-discriminant-analysis-lda"><span class="header-section-number">5.2.2</span> Linear Discriminant Analysis (LDA)</h3>
</section>
<section id="quadratic-discriminant-analysis-qda" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="quadratic-discriminant-analysis-qda"><span class="header-section-number">5.2.3</span> Quadratic Discriminant Analysis (QDA)</h3>
</section>
</section>
</section>
<section id="lesson-6-support-vector-machines" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Lesson 6: Support Vector Machines</h1>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>