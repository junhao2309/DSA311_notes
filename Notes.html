<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ML_Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Notes_files/libs/clipboard/clipboard.min.js"></script>
<script src="Notes_files/libs/quarto-html/quarto.js"></script>
<script src="Notes_files/libs/quarto-html/popper.min.js"></script>
<script src="Notes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Notes_files/libs/quarto-html/anchor.min.js"></script>
<link href="Notes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Notes_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Notes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Notes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Notes_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="full-width.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#lesson-1-overview-of-sl-ml" id="toc-lesson-1-overview-of-sl-ml" class="nav-link active" data-scroll-target="#lesson-1-overview-of-sl-ml"><span class="header-section-number">1</span> Lesson 1: Overview of SL &amp; ML üêà</a>
  <ul class="collapse">
  <li><a href="#some-basic-terminologies" id="toc-some-basic-terminologies" class="nav-link" data-scroll-target="#some-basic-terminologies"><span class="header-section-number">1.1</span> Some Basic Terminologies</a></li>
  <li><a href="#some-basic-codes" id="toc-some-basic-codes" class="nav-link" data-scroll-target="#some-basic-codes"><span class="header-section-number">1.2</span> Some basic codes:</a></li>
  <li><a href="#classification-setting" id="toc-classification-setting" class="nav-link" data-scroll-target="#classification-setting"><span class="header-section-number">1.3</span> Classification Setting</a></li>
  </ul></li>
  <li><a href="#lesson-2-unsupervised-learning-i" id="toc-lesson-2-unsupervised-learning-i" class="nav-link" data-scroll-target="#lesson-2-unsupervised-learning-i"><span class="header-section-number">2</span> Lesson 2: Unsupervised Learning I üêï</a>
  <ul class="collapse">
  <li><a href="#principal-components-analysis-pca" id="toc-principal-components-analysis-pca" class="nav-link" data-scroll-target="#principal-components-analysis-pca"><span class="header-section-number">2.1</span> Principal Components Analysis (PCA)</a>
  <ul class="collapse">
  <li><a href="#second-prinipal-component" id="toc-second-prinipal-component" class="nav-link" data-scroll-target="#second-prinipal-component"><span class="header-section-number">2.1.1</span> Second Prinipal Component</a></li>
  <li><a href="#singular-value-decomposition" id="toc-singular-value-decomposition" class="nav-link" data-scroll-target="#singular-value-decomposition"><span class="header-section-number">2.1.2</span> Singular Value Decomposition</a></li>
  </ul></li>
  <li><a href="#proportion-of-variance-explained-pve" id="toc-proportion-of-variance-explained-pve" class="nav-link" data-scroll-target="#proportion-of-variance-explained-pve"><span class="header-section-number">2.2</span> Proportion of Variance Explained (PVE)</a>
  <ul class="collapse">
  <li><a href="#coding" id="toc-coding" class="nav-link" data-scroll-target="#coding"><span class="header-section-number">2.2.1</span> Coding</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#lesson-3-unsupervised-learning-ii" id="toc-lesson-3-unsupervised-learning-ii" class="nav-link" data-scroll-target="#lesson-3-unsupervised-learning-ii"><span class="header-section-number">3</span> Lesson 3: Unsupervised Learning II üêü</a>
  <ul class="collapse">
  <li><a href="#kmeans-clustering" id="toc-kmeans-clustering" class="nav-link" data-scroll-target="#kmeans-clustering"><span class="header-section-number">3.1</span> Kmeans-clustering</a>
  <ul class="collapse">
  <li><a href="#general-steps-in-k-clustering" id="toc-general-steps-in-k-clustering" class="nav-link" data-scroll-target="#general-steps-in-k-clustering"><span class="header-section-number">3.1.1</span> General steps in K-clustering</a></li>
  <li><a href="#example-code-of-the-steps-shown-above" id="toc-example-code-of-the-steps-shown-above" class="nav-link" data-scroll-target="#example-code-of-the-steps-shown-above"><span class="header-section-number">3.1.2</span> Example Code of the steps shown above</a></li>
  <li><a href="#practical-application" id="toc-practical-application" class="nav-link" data-scroll-target="#practical-application"><span class="header-section-number">3.1.3</span> Practical Application</a></li>
  </ul></li>
  <li><a href="#hierarchical-clustering" id="toc-hierarchical-clustering" class="nav-link" data-scroll-target="#hierarchical-clustering"><span class="header-section-number">3.2</span> Hierarchical clustering</a>
  <ul class="collapse">
  <li><a href="#theory" id="toc-theory" class="nav-link" data-scroll-target="#theory"><span class="header-section-number">3.2.1</span> Theory</a></li>
  <li><a href="#types-of-linkages-and-its-numerical-example" id="toc-types-of-linkages-and-its-numerical-example" class="nav-link" data-scroll-target="#types-of-linkages-and-its-numerical-example"><span class="header-section-number">3.2.2</span> Types of linkages and its numerical example</a></li>
  <li><a href="#additional-information" id="toc-additional-information" class="nav-link" data-scroll-target="#additional-information"><span class="header-section-number">3.2.3</span> Additional information:</a></li>
  <li><a href="#example-code" id="toc-example-code" class="nav-link" data-scroll-target="#example-code"><span class="header-section-number">3.2.4</span> Example Code</a></li>
  <li><a href="#considerations-in-clustering" id="toc-considerations-in-clustering" class="nav-link" data-scroll-target="#considerations-in-clustering"><span class="header-section-number">3.2.5</span> Considerations in Clustering</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#lesson-4-multiple-linear-regression" id="toc-lesson-4-multiple-linear-regression" class="nav-link" data-scroll-target="#lesson-4-multiple-linear-regression"><span class="header-section-number">4</span> Lesson 4: Multiple Linear Regression üê∞</a>
  <ul class="collapse">
  <li><a href="#basic-theory-of-regression-model" id="toc-basic-theory-of-regression-model" class="nav-link" data-scroll-target="#basic-theory-of-regression-model"><span class="header-section-number">4.1</span> Basic theory of Regression Model</a></li>
  <li><a href="#dimension-reduction" id="toc-dimension-reduction" class="nav-link" data-scroll-target="#dimension-reduction"><span class="header-section-number">4.2</span> Dimension Reduction</a>
  <ul class="collapse">
  <li><a href="#best-subset-approach" id="toc-best-subset-approach" class="nav-link" data-scroll-target="#best-subset-approach"><span class="header-section-number">4.2.1</span> Best subset approach</a></li>
  <li><a href="#lasso-ridge" id="toc-lasso-ridge" class="nav-link" data-scroll-target="#lasso-ridge"><span class="header-section-number">4.2.11</span> Lasso / Ridge</a></li>
  <li><a href="#pcr-regression" id="toc-pcr-regression" class="nav-link" data-scroll-target="#pcr-regression"><span class="header-section-number">4.2.12</span> PCR regression</a></li>
  <li><a href="#partial-least-squares-method" id="toc-partial-least-squares-method" class="nav-link" data-scroll-target="#partial-least-squares-method"><span class="header-section-number">4.2.13</span> Partial Least Squares Method</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#lesson-5-classification" id="toc-lesson-5-classification" class="nav-link" data-scroll-target="#lesson-5-classification"><span class="header-section-number">5</span> Lesson 5: Classification üêë</a>
  <ul class="collapse">
  <li><a href="#multinomial-logistic-regression" id="toc-multinomial-logistic-regression" class="nav-link" data-scroll-target="#multinomial-logistic-regression"><span class="header-section-number">5.1</span> Multinomial Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#code-example" id="toc-code-example" class="nav-link" data-scroll-target="#code-example"><span class="header-section-number">5.1.1</span> Code example</a></li>
  </ul></li>
  <li><a href="#linear-and-quadratic-discriminant-analysis" id="toc-linear-and-quadratic-discriminant-analysis" class="nav-link" data-scroll-target="#linear-and-quadratic-discriminant-analysis"><span class="header-section-number">5.2</span> Linear and Quadratic Discriminant Analysis</a>
  <ul class="collapse">
  <li><a href="#theory-bayes-theorem" id="toc-theory-bayes-theorem" class="nav-link" data-scroll-target="#theory-bayes-theorem"><span class="header-section-number">5.2.1</span> Theory (Bayes Theorem)</a></li>
  <li><a href="#linear-discriminant-analysis-lda" id="toc-linear-discriminant-analysis-lda" class="nav-link" data-scroll-target="#linear-discriminant-analysis-lda"><span class="header-section-number">5.2.2</span> Linear Discriminant Analysis (LDA)</a></li>
  <li><a href="#quadratic-discriminant-analysis-qda" id="toc-quadratic-discriminant-analysis-qda" class="nav-link" data-scroll-target="#quadratic-discriminant-analysis-qda"><span class="header-section-number">5.2.3</span> Quadratic Discriminant Analysis (QDA)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#lesson-6-support-vector-machines" id="toc-lesson-6-support-vector-machines" class="nav-link" data-scroll-target="#lesson-6-support-vector-machines"><span class="header-section-number">6</span> Lesson 6: Support Vector Machines üê¥</a>
  <ul class="collapse">
  <li><a href="#separating-hyperplane" id="toc-separating-hyperplane" class="nav-link" data-scroll-target="#separating-hyperplane"><span class="header-section-number">6.1</span> Separating Hyperplane</a></li>
  <li><a href="#margin" id="toc-margin" class="nav-link" data-scroll-target="#margin"><span class="header-section-number">6.2</span> Margin</a></li>
  <li><a href="#maximal-margin-classifier" id="toc-maximal-margin-classifier" class="nav-link" data-scroll-target="#maximal-margin-classifier"><span class="header-section-number">6.3</span> Maximal Margin Classifier</a></li>
  <li><a href="#support-vector-classifier" id="toc-support-vector-classifier" class="nav-link" data-scroll-target="#support-vector-classifier"><span class="header-section-number">6.4</span> Support Vector classifier</a></li>
  <li><a href="#numeric-example-1" id="toc-numeric-example-1" class="nav-link" data-scroll-target="#numeric-example-1"><span class="header-section-number">6.5</span> Numeric Example 1:</a>
  <ul class="collapse">
  <li><a href="#simulation-of-data-and-basic-logistic-regression" id="toc-simulation-of-data-and-basic-logistic-regression" class="nav-link" data-scroll-target="#simulation-of-data-and-basic-logistic-regression"><span class="header-section-number">6.5.1</span> Simulation of data and basic logistic regression</a></li>
  <li><a href="#svm-with-cost-0.10" id="toc-svm-with-cost-0.10" class="nav-link" data-scroll-target="#svm-with-cost-0.10"><span class="header-section-number">6.5.2</span> SVM with cost= 0.10</a></li>
  <li><a href="#svm-with-cost-10" id="toc-svm-with-cost-10" class="nav-link" data-scroll-target="#svm-with-cost-10"><span class="header-section-number">6.5.3</span> SVM with cost= 10</a></li>
  </ul></li>
  <li><a href="#classification-with-non-linear-decision-boundaries-numeric-example-2" id="toc-classification-with-non-linear-decision-boundaries-numeric-example-2" class="nav-link" data-scroll-target="#classification-with-non-linear-decision-boundaries-numeric-example-2"><span class="header-section-number">6.6</span> Classification with Non-Linear Decision Boundaries (Numeric Example 2)</a></li>
  <li><a href="#numeric-example-2" id="toc-numeric-example-2" class="nav-link" data-scroll-target="#numeric-example-2"><span class="header-section-number">6.7</span> Numeric Example 2:</a>
  <ul class="collapse">
  <li><a href="#simulation-of-data" id="toc-simulation-of-data" class="nav-link" data-scroll-target="#simulation-of-data"><span class="header-section-number">6.7.1</span> Simulation of data</a></li>
  <li><a href="#svm-with-cost-10-1" id="toc-svm-with-cost-10-1" class="nav-link" data-scroll-target="#svm-with-cost-10-1"><span class="header-section-number">6.7.2</span> SVM with cost 10</a></li>
  <li><a href="#svm-with-cost-0.1" id="toc-svm-with-cost-0.1" class="nav-link" data-scroll-target="#svm-with-cost-0.1"><span class="header-section-number">6.7.3</span> SVM with cost 0.1</a></li>
  <li><a href="#tuning-cross-validation" id="toc-tuning-cross-validation" class="nav-link" data-scroll-target="#tuning-cross-validation"><span class="header-section-number">6.7.4</span> Tuning (Cross validation)</a></li>
  </ul></li>
  <li><a href="#polynomial-kernel" id="toc-polynomial-kernel" class="nav-link" data-scroll-target="#polynomial-kernel"><span class="header-section-number">6.8</span> Polynomial Kernel</a></li>
  <li><a href="#radial-kernel" id="toc-radial-kernel" class="nav-link" data-scroll-target="#radial-kernel"><span class="header-section-number">6.9</span> Radial Kernel</a></li>
  <li><a href="#numeric-example-3" id="toc-numeric-example-3" class="nav-link" data-scroll-target="#numeric-example-3"><span class="header-section-number">6.10</span> Numeric Example 3:</a>
  <ul class="collapse">
  <li><a href="#simulation-of-data-1" id="toc-simulation-of-data-1" class="nav-link" data-scroll-target="#simulation-of-data-1"><span class="header-section-number">6.10.1</span> Simulation of data</a></li>
  <li><a href="#train-test-split" id="toc-train-test-split" class="nav-link" data-scroll-target="#train-test-split"><span class="header-section-number">6.10.2</span> Train-test split</a></li>
  <li><a href="#perform-cv-to-select-gamma-and-cost" id="toc-perform-cv-to-select-gamma-and-cost" class="nav-link" data-scroll-target="#perform-cv-to-select-gamma-and-cost"><span class="header-section-number">6.10.3</span> Perform CV to select <span class="math inline">\(\gamma\)</span> and cost</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ML_Notes</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="lesson-1-overview-of-sl-ml" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Lesson 1: Overview of SL &amp; ML üêà</h1>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Statistical Learning VS Machine Learning</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 58%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Areas</th>
<th style="text-align: left;">Statistical_Learning</th>
<th style="text-align: left;">Machine_Learning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Scope</td>
<td style="text-align: left;">Subfield of Statistics</td>
<td style="text-align: left;">Subfield of AI</td>
</tr>
<tr class="even">
<td style="text-align: left;">Focus</td>
<td style="text-align: left;">Models building and their interpretability</td>
<td style="text-align: left;">Prediction accuracy</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Data</td>
<td style="text-align: left;">Use survey methods / experimental study to collect random data with a particular purpose or objective - understand ideas behind various techniques and accurately assess performance of each technique</td>
<td style="text-align: left;">Collect large or big data set in a routine way - Focuses on large scale applications</td>
</tr>
<tr class="even">
<td style="text-align: left;">Approach</td>
<td style="text-align: left;">Models with predefined assumptions and all data. Interpretable but holds limitations in capturing complex patterns</td>
<td style="text-align: left;">Use training data to build the model with no assumptions and use a test set to evaluation model</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Concern</td>
<td style="text-align: left;">Parameter estimation and hypothesis testing at a certain error rate</td>
<td style="text-align: left;">Bias-variance trade-off and prediction errors</td>
</tr>
<tr class="even">
<td style="text-align: left;">Application</td>
<td style="text-align: left;">Econometrics, biostatistics, finance, etc</td>
<td style="text-align: left;">Natural language proccessing, face recognition, traffic prediction, where predictive accuracy and pattern recognition are paramount</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Supervised learning VS Unsupervised learning</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 32%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Areas</th>
<th style="text-align: left;">Supervised_Learning</th>
<th style="text-align: left;">Unsupervised_Learning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Focus</td>
<td style="text-align: left;">Focus on outcome measurement, Y (dependent variable)</td>
<td style="text-align: left;">No outcome measurement, Y, just a set of predictors</td>
</tr>
<tr class="even">
<td style="text-align: left;">Variables</td>
<td style="text-align: left;">Use p predictor measurements (independent variables)</td>
<td style="text-align: left;">Find features of X that behave similarly or find linear combinations of X with the most variation</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Purpose</td>
<td style="text-align: left;">For regression / classification problems</td>
<td style="text-align: left;">Use unsupervised learning as first step of supervised learning</td>
</tr>
<tr class="even">
<td style="text-align: left;">Concern</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">Difficult to evaluate the performance of approaches because of no outcome measurement for comparisons</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="some-basic-terminologies" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="some-basic-terminologies"><span class="header-section-number">1.1</span> Some Basic Terminologies</h2>
<ul>
<li><p>Reducible Error <span class="math display">\[
f(X) - \hat{f}(X)
\]</span> where <span class="math inline">\(f(X)\)</span> is the true value while <span class="math inline">\(\hat{f}(x)\)</span> is the predicted value</p>
<ul>
<li>We seek to find the most appropriate statistical learning technique that minimises the reducible error</li>
</ul></li>
<li><p>Irreducible Error <span class="math display">\[
\epsilon = Y - f(X)
\]</span></p>
<ul>
<li><span class="math inline">\(\epsilon\)</span> cannot be predicted using <span class="math inline">\(X\)</span></li>
</ul></li>
<li><p>Total Errors The average of the squared difference between the predicted <span class="math inline">\(Y\)</span> and actual value <span class="math inline">\(Y\)</span> is <span class="math display">\[
E(Y-\hat{Y})^2 = E[f(X) +\epsilon -\hat{f}(X)]^2 + Var(\epsilon)
\]</span></p></li>
</ul>
<p><span class="math display">\[
E(Y-\hat{Y})^2 = [f(X)-\hat{f}(X)]^2 + Var(\epsilon)
\]</span></p>
<ul>
<li><p>Estimation of <span class="math inline">\(f\)</span></p>
<ul>
<li>Parametric (Linear, logistic, regression tree, Lasso)
<ul>
<li>Assumes a function form/shape of <span class="math inline">\(f\)</span></li>
<li>Use the training data to fit</li>
</ul></li>
<li>Non-parametric (Random forest, bagging, bootstrap)
<ul>
<li>Does not assume the shape of <span class="math inline">\(f\)</span></li>
<li>Need a very large number of observations</li>
</ul></li>
</ul></li>
<li><p>Training &amp; Testing Data</p>
<p>Objectives:</p>
<ul>
<li>Accurately predict unseen test cases</li>
<li>Understand which independent variables affect the dependent variable, and how</li>
<li>Assess quality of predictions or/and inferences</li>
</ul></li>
<li><p>Prediction Accuracy VS Interpretability</p>
<ul>
<li>More restrictive (less flexibility) means more interpretable in inference objective
<ul>
<li>Less flexibility, it is likely bias is higher and variance is smaller. Vice Versa</li>
</ul></li>
<li>For prediction objective, less restrictive does not always yield the best model.</li>
</ul></li>
</ul>
<p><img src="images/Lesson1_img1.png" class="img-fluid"></p>
<ul>
<li><p>Bias Variance Trade Off</p>
<p><span class="math display">\[
E(y_0-\hat{f}(x_0))^2 = Var(\hat{f}(x_0))+[Bias(\hat{f}(x_0))]^2+Var(\epsilon)
\]</span></p>
<ul>
<li>Bias: Error that is introduced by approximating a real-life situation with a much simpler model <span class="math inline">\(\hat{f}\)</span></li>
<li>Variance: Amount by which <span class="math inline">\(\hat{f}\)</span> would change if we estimated it again using a different training data set</li>
<li>Relationship with flexibility: As flexibility increases, its variance increases while its bias decreases. <img src="images/Lesson1_img2.png" class="img-fluid"></li>
</ul></li>
<li><p>Validation</p>
<ul>
<li>Model is fitted on a training data set and tested with a validation set.</li>
<li>The validation test set provides a validation-set error which provides an estimate of the test error</li>
</ul></li>
<li><p>K-Fold Cross Validation</p>
<ul>
<li>Widely used approach for estimating test error</li>
<li>Randomly divide the data into <span class="math inline">\(K\)</span> equal-sized parts</li>
<li>Results from each K parts are combined at the end</li>
</ul></li>
<li><p>Validation and Cross-Validation</p>
<ul>
<li>Use cross-validation to identify the parameter values for a given approach</li>
<li>Use validation to choose best approach among all the considered approaches</li>
</ul></li>
</ul>
<p>As the foundation of this course is from Statistical learning with R, refer to <a href="file:///Users/junhaoteo/Documents/SMU_Modules/Y2S2/Statistical%20Learning%20with%20R/DSA211_notes.html">Statistical Learning Notes</a> where the various codes can be obtained.</p>
</section>
<section id="some-basic-codes" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="some-basic-codes"><span class="header-section-number">1.2</span> Some basic codes:</h2>
<ul>
<li>Multiple regression model + Quadratic variables</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carseats example in textbook </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)     </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Carseats)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Carseats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Sales"       "CompPrice"   "Income"      "Advertising" "Population" 
 [6] "Price"       "ShelveLoc"   "Age"         "Education"   "Urban"      
[11] "US"         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Carseats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Sales          CompPrice       Income        Advertising    
 Min.   : 0.000   Min.   : 77   Min.   : 21.00   Min.   : 0.000  
 1st Qu.: 5.390   1st Qu.:115   1st Qu.: 42.75   1st Qu.: 0.000  
 Median : 7.490   Median :125   Median : 69.00   Median : 5.000  
 Mean   : 7.496   Mean   :125   Mean   : 68.66   Mean   : 6.635  
 3rd Qu.: 9.320   3rd Qu.:135   3rd Qu.: 91.00   3rd Qu.:12.000  
 Max.   :16.270   Max.   :175   Max.   :120.00   Max.   :29.000  
   Population        Price        ShelveLoc        Age          Education   
 Min.   : 10.0   Min.   : 24.0   Bad   : 96   Min.   :25.00   Min.   :10.0  
 1st Qu.:139.0   1st Qu.:100.0   Good  : 85   1st Qu.:39.75   1st Qu.:12.0  
 Median :272.0   Median :117.0   Medium:219   Median :54.50   Median :14.0  
 Mean   :264.8   Mean   :115.8                Mean   :53.32   Mean   :13.9  
 3rd Qu.:398.5   3rd Qu.:131.0                3rd Qu.:66.00   3rd Qu.:16.0  
 Max.   :509.0   Max.   :191.0                Max.   :80.00   Max.   :18.0  
 Urban       US     
 No :118   No :142  
 Yes:282   Yes:258  
                    
                    
                    
                    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#multiple regression model including all independent variables</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>lm.carseat1<span class="ot">=</span><span class="fu">lm</span>(Sales<span class="sc">~</span>., <span class="at">data=</span>Carseats)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.carseat1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ ., data = Carseats)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.8692 -0.6908  0.0211  0.6636  3.4115 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      5.6606231  0.6034487   9.380  &lt; 2e-16 ***
CompPrice        0.0928153  0.0041477  22.378  &lt; 2e-16 ***
Income           0.0158028  0.0018451   8.565 2.58e-16 ***
Advertising      0.1230951  0.0111237  11.066  &lt; 2e-16 ***
Population       0.0002079  0.0003705   0.561    0.575    
Price           -0.0953579  0.0026711 -35.700  &lt; 2e-16 ***
ShelveLocGood    4.8501827  0.1531100  31.678  &lt; 2e-16 ***
ShelveLocMedium  1.9567148  0.1261056  15.516  &lt; 2e-16 ***
Age             -0.0460452  0.0031817 -14.472  &lt; 2e-16 ***
Education       -0.0211018  0.0197205  -1.070    0.285    
UrbanYes         0.1228864  0.1129761   1.088    0.277    
USYes           -0.1840928  0.1498423  -1.229    0.220    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.019 on 388 degrees of freedom
Multiple R-squared:  0.8734,    Adjusted R-squared:  0.8698 
F-statistic: 243.4 on 11 and 388 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple regression model with significant factors</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>lm.carseat2<span class="ot">=</span><span class="fu">lm</span>(Sales<span class="sc">~</span>CompPrice<span class="sc">+</span>Income<span class="sc">+</span>Advertising<span class="sc">+</span>Price<span class="sc">+</span>ShelveLoc<span class="sc">+</span>Age, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>Carseats)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.carseat2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ CompPrice + Income + Advertising + Price + 
    ShelveLoc + Age, data = Carseats)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.7728 -0.6954  0.0282  0.6732  3.3292 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      5.475226   0.505005   10.84   &lt;2e-16 ***
CompPrice        0.092571   0.004123   22.45   &lt;2e-16 ***
Income           0.015785   0.001838    8.59   &lt;2e-16 ***
Advertising      0.115903   0.007724   15.01   &lt;2e-16 ***
Price           -0.095319   0.002670  -35.70   &lt;2e-16 ***
ShelveLocGood    4.835675   0.152499   31.71   &lt;2e-16 ***
ShelveLocMedium  1.951993   0.125375   15.57   &lt;2e-16 ***
Age             -0.046128   0.003177  -14.52   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.019 on 392 degrees of freedom
Multiple R-squared:  0.872, Adjusted R-squared:  0.8697 
F-statistic: 381.4 on 7 and 392 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm.carseat2, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      2.5 %      97.5 %
(Intercept)      4.48236820  6.46808427
CompPrice        0.08446498  0.10067795
Income           0.01217210  0.01939784
Advertising      0.10071856  0.13108825
Price           -0.10056844 -0.09006946
ShelveLocGood    4.53585700  5.13549250
ShelveLocMedium  1.70550103  2.19848429
Age             -0.05237301 -0.03988204</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lm.carseat2, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">data.frame</span>(<span class="at">CompPrice=</span><span class="dv">116</span>, <span class="at">Income=</span><span class="dv">80</span>, <span class="at">Advertising=</span><span class="dv">7</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Price=</span><span class="dv">100</span>, <span class="at">ShelveLoc=</span><span class="st">"Good"</span>, <span class="at">Age=</span><span class="dv">56</span>), </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval=</span><span class="st">"confidence"</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">level=</span>.<span class="dv">95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 11.00828 10.77329 11.24326</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lm.carseat2, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">data.frame</span>(<span class="at">CompPrice=</span><span class="dv">116</span>, <span class="at">Income=</span><span class="dv">80</span>, <span class="at">Advertising=</span><span class="dv">7</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Price=</span><span class="dv">100</span>, <span class="at">ShelveLoc=</span><span class="st">"Good"</span>, <span class="at">Age=</span><span class="dv">56</span>), </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval=</span><span class="st">"prediction"</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">level=</span>.<span class="dv">95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit    lwr      upr
1 11.00828 8.9903 13.02625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quadratic relationship</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>lm.carseat3<span class="ot">=</span><span class="fu">lm</span>(Sales<span class="sc">~</span>CompPrice<span class="sc">+</span>Income<span class="sc">+</span>Advertising<span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                 Price<span class="sc">+</span>ShelveLoc<span class="sc">+</span>Age<span class="sc">+</span><span class="fu">I</span>(Price<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>Carseats)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.carseat3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ CompPrice + Income + Advertising + Price + 
    ShelveLoc + Age + I(Price^2), data = Carseats)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.7580 -0.7084  0.0344  0.6883  3.2802 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      5.988e+00  8.756e-01   6.839 3.09e-11 ***
CompPrice        9.268e-02  4.129e-03  22.448  &lt; 2e-16 ***
Income           1.577e-02  1.839e-03   8.576 2.32e-16 ***
Advertising      1.163e-01  7.744e-03  15.012  &lt; 2e-16 ***
Price           -1.050e-01  1.380e-02  -7.613 2.03e-13 ***
ShelveLocGood    4.832e+00  1.527e-01  31.645  &lt; 2e-16 ***
ShelveLocMedium  1.953e+00  1.255e-01  15.564  &lt; 2e-16 ***
Age             -4.603e-02  3.182e-03 -14.466  &lt; 2e-16 ***
I(Price^2)       4.227e-05  5.896e-05   0.717    0.474    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.02 on 391 degrees of freedom
Multiple R-squared:  0.8722,    Adjusted R-squared:  0.8695 
F-statistic: 333.4 on 8 and 391 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>Code for train-test split for multiple regression</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Auto)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3344</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>Auto1 <span class="ot">&lt;-</span> Auto[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Auto1), <span class="dv">200</span>) <span class="co">#sample 200 out of the whole sample size</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="sc">-</span>train</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>auto.train <span class="ot">&lt;-</span> Auto1[train,]</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>auto.test <span class="ot">&lt;-</span> Auto1[test,]</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple regression model</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg<span class="sc">~</span>., <span class="at">data=</span>auto.train)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>lm.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm.fit, auto.test)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>mse.mrm <span class="ot">&lt;-</span> <span class="fu">mean</span>((auto.test<span class="sc">$</span>mpg<span class="sc">-</span>lm.pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>mse.mrm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.55657</code></pre>
</div>
</div>
<ul>
<li>Lasso &amp; Ridge Regularization</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lasso </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>train.x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mpg<span class="sc">~</span>., <span class="at">data=</span>auto.train)[,<span class="sc">-</span><span class="dv">1</span>]      <span class="co"># Remove the intercept</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>train.y <span class="ot">&lt;-</span>auto.train<span class="sc">$</span>mpg</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>test.x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mpg<span class="sc">~</span>., <span class="at">data=</span>auto.test)[,<span class="sc">-</span><span class="dv">1</span>]        <span class="co"># Remove the intercept</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>test.y <span class="ot">&lt;-</span> auto.test<span class="sc">$</span>mpg</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>lasso.mod <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(train.x, train.y, <span class="at">alpha=</span><span class="dv">1</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>cv.out <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(train.x, train.y, <span class="at">alpha=</span><span class="dv">1</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nfolds =</span> <span class="dv">10</span>)            <span class="co"># Default 10 Fold, change this for other fold value</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>lambda.lasso <span class="ot">&lt;-</span> cv.out<span class="sc">$</span>lambda.min</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>lambda.lasso</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.007414423</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>lasso.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lasso.mod, <span class="at">newx=</span>test.x, <span class="at">s=</span>lambda.lasso)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>mse.lasso <span class="ot">&lt;-</span> <span class="fu">mean</span>((test.y<span class="sc">-</span>lasso.pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>mse.lasso</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.52336</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ridge regression</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ridge.mod <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(train.x, train.y, <span class="at">alpha=</span><span class="dv">0</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>cv.out <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(train.x, train.y, <span class="at">alpha=</span><span class="dv">0</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>lambda.rr <span class="ot">&lt;-</span> cv.out<span class="sc">$</span>lambda.min</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>lambda.rr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6600431</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ridge.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge.mod, <span class="at">newx=</span>test.x, <span class="at">s=</span>lambda.rr)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>mse.rr <span class="ot">&lt;-</span> <span class="fu">mean</span>((test.y<span class="sc">-</span>ridge.pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>mse.rr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.00824</code></pre>
</div>
</div>
<p>After comparing all models above using the Auto Dataset, we have that Lasso is the best model.</p>
<p>Rebuild the model using all of the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mpg<span class="sc">~</span>., <span class="at">data=</span>Auto1)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Auto1<span class="sc">$</span>mpg</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>out.lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y, <span class="at">alpha=</span><span class="dv">1</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>lasso.m2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(out.lasso, <span class="at">type=</span><span class="st">"coefficients"</span>, <span class="at">s=</span>lambda.lasso)[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>lasso.m2[lasso.m2<span class="sc">!=</span><span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)     cylinders  displacement    horsepower        weight 
-17.226062638  -0.388797977   0.016409017  -0.015275841  -0.006357916 
 acceleration          year        origin 
  0.073666083   0.747775775   1.380164964 </code></pre>
</div>
</div>
</section>
<section id="classification-setting" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="classification-setting"><span class="header-section-number">1.3</span> Classification Setting</h2>
<ul>
<li><p>Testing Error for Classification</p>
<ul>
<li>False negative rate (FNR): Incorrectly assign a default individual to the no default category</li>
<li>False positive rate (FPR): Incorrectly assign a no default individual to the default category</li>
</ul></li>
<li><p>Confusion Matrix</p>
<ul>
<li>Sensitivity: % of true defaulters that are identified as defaulters</li>
<li>Specificity: % of true non-defaulters that are correctly identified as non-defaulters</li>
</ul></li>
</ul>
<p>Formula:<br>
<span class="math display">\[
Sensitivity = \frac{Predicted \space Default}{Total \space no.\space of\space True \space Default}
\]</span> <span class="math display">\[
Specificity = \frac{Predicted \space No \space Default}{Total \space no.\space of\space True \space No \space Default}
\]</span> <img src="images/Lesson1_img3.png" class="img-fluid"></p>
</section>
</section>
<section id="lesson-2-unsupervised-learning-i" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Lesson 2: Unsupervised Learning I üêï</h1>
<ul>
<li><p>Goals of Unsupervised learning</p>
<ul>
<li>Observe only the features, <span class="math inline">\(X_1, X_2,..., X_p\)</span></li>
<li>Gather insights from the data and is not interested in prediction</li>
</ul></li>
</ul>
<section id="principal-components-analysis-pca" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="principal-components-analysis-pca"><span class="header-section-number">2.1</span> Principal Components Analysis (PCA)</h2>
<ul>
<li><p>What is it?</p>
<ul>
<li>A dimensionality reduction method by reducing the dimensionality of large data sets</li>
<li>Finds a sequence of linear combinations of the variables that have <strong>maximal variance</strong>, and <strong>mutually uncorrelated</strong></li>
<li>Reducing dimension comes at the expense of accuracy, but essentially to trade little accuracy for simplicity</li>
<li>Low dimension data sets are easier to explore and visualize and makes analysing data points easier and faster for machine learning</li>
</ul></li>
</ul>
<p>Below refers to the above point 2: <span class="math display">\[
X_1, X_2, ‚Ä¶, X_{1000}
\]</span></p>
<p><span class="math display">\[
\text{The above is converted through PCA to output: }
\]</span></p>
<p><span class="math display">\[
Var(Y_1+Y_2) = Var(Y_1)+Var(Y_2)+2Cov(Y_1, Y_2)
\]</span></p>
<p><strong>Applications of PCA</strong></p>
<p>Use the principal components:</p>
<ul>
<li><p>In understanding and visualising the data</p></li>
<li><p>As a tool for data imputation, for filling in missing values (No time to cover)</p></li>
<li><p>As predictors in a regression model, instead of original larger set of independent variables</p></li>
</ul>
<p>Mathematical Representation of PCA</p>
<p>Each observation (X_1,X_2,‚Ä¶,X_p) is multiplied to the loading vector to obtain the scores, <span class="math inline">\(Z\)</span>.</p>
<p>Observations vector: <span class="math display">\[
X =
\begin{bmatrix}
  X_1 &amp; X_2 &amp; ... &amp; X_p
\end{bmatrix}
\]</span></p>
<p>Loading vector: $$ _i =</p>
<span class="math display">\[\begin{bmatrix}
\phi_{11} \\ \phi_{21} \\... \\ \phi_{p1}

\end{bmatrix}\]</span>
<p>$$ The above creates a normalized linear combination of features:</p>
$$ Z=X_i=
<span class="math display">\[\begin{bmatrix}
  X_1 &amp; X_2 &amp; ... &amp; X_p
\end{bmatrix} \begin{bmatrix}
\phi_{11} \\ \phi_{21} \\... \\ \phi_{p1}

\end{bmatrix}\]</span>
<p>\</p>
<p>Z= <em>{11}X_1+</em>{21}X_2+‚Ä¶+_{p1}X_p</p>
<p>$$</p>
<p>Under PCA, the objective is to minimise the perpendicular distance from the observation to the line. As such the distance of the line is maximised.</p>
<p>Goal:</p>
<p><span class="math display">\[
\max{\frac{\sum^{n}_{i=1} Z_i^2} {n}}
\]</span></p>
<section id="second-prinipal-component" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="second-prinipal-component"><span class="header-section-number">2.1.1</span> Second Prinipal Component</h3>
<p>Steps are similar to the First Principal Component, however, it has to be uncorrelated with <span class="math inline">\(Z_1\)</span>.</p>
</section>
<section id="singular-value-decomposition" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="singular-value-decomposition"><span class="header-section-number">2.1.2</span> Singular Value Decomposition</h3>
<p>(TO ADD IN THEORY)</p>
<section id="simple-numerical-example-of-singular-value-decomposition---manual-calculation" class="level4" data-number="2.1.2.1">
<h4 data-number="2.1.2.1" class="anchored" data-anchor-id="simple-numerical-example-of-singular-value-decomposition---manual-calculation"><span class="header-section-number">2.1.2.1</span> Simple Numerical Example of Singular Value Decomposition - Manual calculation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">3</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(data, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    3    1    4    1
[2,]    5    9    2    6
[3,]    5    3    5    8
[4,]    9    7    9    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>sA <span class="ot">&lt;-</span> <span class="fu">svd</span>(A) <span class="co"># Do SVD</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "d" "u" "v"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> sA<span class="sc">$</span>d</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> sA<span class="sc">$</span>u</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> sA<span class="sc">$</span>v</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">diag</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(U, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]  [,4]
[1,] -0.21  0.37 -0.13 -0.89
[2,] -0.52 -0.70  0.43 -0.23
[3,] -0.48 -0.21 -0.84  0.15
[4,] -0.67  0.57  0.31  0.36</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">t</span>(V), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]  [,4]
[1,] -0.55 -0.52 -0.49 -0.43
[2,]  0.26 -0.40  0.65 -0.59
[3,]  0.07  0.70 -0.22 -0.68
[4,]  0.79 -0.29 -0.54 -0.04</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(D, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4]
[1,] 21.23 0.00 0.00 0.00
[2,]  0.00 6.43 0.00 0.00
[3,]  0.00 0.00 4.88 0.00
[4,]  0.00 0.00 0.00 0.15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">t</span>(V) <span class="sc">%*%</span> V, <span class="dv">2</span>) <span class="co"># Matrix multiplication - Becomes identity matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">t</span>(U) <span class="sc">%*%</span> U, <span class="dv">2</span>) <span class="co"># Matrix multiplication - Becomes identity matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(U <span class="sc">%*%</span> D <span class="sc">%*%</span> <span class="fu">t</span>(V), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    3    1    4    1
[2,]    5    9    2    6
[3,]    5    3    5    8
[4,]    9    7    9    3</code></pre>
</div>
</div>
<p>Using the example above, we have that:</p>
<p><img src="images/Lesson2_img1.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Third principal component set of values</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> U[,<span class="dv">1</span>]</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> V[,<span class="dv">1</span>]</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> d[<span class="dv">1</span>]</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> u1 <span class="sc">%*%</span> <span class="fu">t</span>(v1)<span class="sc">*</span>d1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>u1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2147262 -0.5186023 -0.4814399 -0.6731715</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>v1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5512099 -0.5199228 -0.4880448 -0.4331977</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>d1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.23136</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>A1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]     [,2]     [,3]     [,4]
[1,] 2.512927 2.370291 2.224962 1.974917
[2,] 6.069168 5.724678 5.373681 4.769779
[3,] 5.634260 5.314455 4.988610 4.427983
[4,] 7.878082 7.430916 6.975304 6.191410</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(A1,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,] 2.51 2.37 2.22 1.97
[2,] 6.07 5.72 5.37 4.77
[3,] 5.63 5.31 4.99 4.43
[4,] 7.88 7.43 6.98 6.19</code></pre>
</div>
</div>
<p>We see that A1 is still quite far from the original A matrix. By adding another principal component we have:</p>
<p><img src="images/Lesson2_img2.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Second principal component set of values</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> U[,<span class="dv">2</span>]</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> V[,<span class="dv">2</span>]</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d[<span class="dv">2</span>]</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>A2 <span class="ot">&lt;-</span> u2 <span class="sc">%*%</span> <span class="fu">t</span>(v2)<span class="sc">*</span>d2</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>A1A2 <span class="ot">&lt;-</span> A1<span class="sc">+</span>A2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>u2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.3739765 -0.7013767 -0.2082253  0.5699602</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>v2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.2648388 -0.4000607  0.6500900 -0.5892325</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>d2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.432445</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>A2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]       [,2]       [,3]       [,4]
[1,]  0.6370919 -0.9623793  1.5638455 -1.4174477
[2,] -1.1948381  1.8049004 -2.9329242  2.6583615
[3,] -0.3547245  0.5358403 -0.8707289  0.7892165
[4,]  0.9709620 -1.4667173  2.3833840 -2.1602660</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(A2,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]  [,4]
[1,]  0.64 -0.96  1.56 -1.42
[2,] -1.19  1.80 -2.93  2.66
[3,] -0.35  0.54 -0.87  0.79
[4,]  0.97 -1.47  2.38 -2.16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(A1A2, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,] 3.15 1.41 3.79 0.56
[2,] 4.87 7.53 2.44 7.43
[3,] 5.28 5.85 4.12 5.22
[4,] 8.85 5.96 9.36 4.03</code></pre>
</div>
</div>
<p>From the above, we see that with PC1 and PC2, it gets closer to the original A matrix.</p>
<p>Repeating the steps one more time.</p>
<p><img src="images/Lesson2_img3.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Third principal component set of values</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>u3 <span class="ot">&lt;-</span> U[,<span class="dv">3</span>]</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> V[,<span class="dv">3</span>]</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> d[<span class="dv">3</span>]</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> u3 <span class="sc">%*%</span> <span class="fu">t</span>(v3)<span class="sc">*</span>d3</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>A1A2A3 <span class="ot">&lt;-</span> A1<span class="sc">+</span>A2<span class="sc">+</span>A3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>u3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1315028  0.4302032 -0.8377092  0.3096378</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>v3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.07265877  0.69537763 -0.21865293 -0.68070665</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>d3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.881755</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>A3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]       [,2]       [,3]       [,4]
[1,] -0.04664435 -0.4464077  0.1403674  0.4369894
[2,]  0.15259409  1.4603951 -0.4592033 -1.4295839
[3,] -0.29713740 -2.8437406  0.8941792  2.7837438
[4,]  0.10982926  1.0511162 -0.3305105 -1.0289399</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(A3,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]  [,4]
[1,] -0.05 -0.45  0.14  0.44
[2,]  0.15  1.46 -0.46 -1.43
[3,] -0.30 -2.84  0.89  2.78
[4,]  0.11  1.05 -0.33 -1.03</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(A1A2A3, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,] 3.10 0.96 3.93 0.99
[2,] 5.03 8.99 1.98 6.00
[3,] 4.98 3.01 5.01 8.00
[4,] 8.96 7.02 9.03 3.00</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="proportion-of-variance-explained-pve" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="proportion-of-variance-explained-pve"><span class="header-section-number">2.2</span> Proportion of Variance Explained (PVE)</h2>
<ul>
<li><p>Determines the number of principal components</p>
<ul>
<li>PVEs should sum to one when maximum number of principal component is used</li>
</ul></li>
</ul>
<section id="coding" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="coding"><span class="header-section-number">2.2.1</span> Coding</h3>
<p>Using another numerical example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">21</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">34</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">43</span>, <span class="dv">59</span>, <span class="dv">20</span>, <span class="dv">35</span>, <span class="dv">30</span>, <span class="dv">48</span>, <span class="dv">32</span>, <span class="dv">56</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">matrix</span>(data, <span class="at">nrow=</span><span class="dv">6</span>)  <span class="co"># data matrix with dimension 6x3</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]   12   26   20
[2,]   13   34   35
[3,]   15   28   30
[4,]   17   29   48
[5,]   21   43   32
[6,]   24   59   56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual calculation</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">scale</span>(M)  <span class="co"># scale the matrix M, to ensure data has a mean of 0</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>               <span class="co"># The standard deviation is also adjusted to 1</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(X, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]    [,2]    [,3]
[1,] -1.0660 -0.8335 -1.2919
[2,] -0.8528 -0.1985 -0.1407
[3,] -0.4264 -0.6747 -0.5245
[4,]  0.0000 -0.5954  0.8570
[5,]  0.8528  0.5160 -0.3710
[6,]  1.4924  1.7861  1.4710
attr(,"scaled:center")
[1] 17.00000 36.50000 36.83333
attr(,"scaled:scale")
[1]  4.690416 12.597619 13.029454</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>sX <span class="ot">&lt;-</span> <span class="fu">svd</span>(X) <span class="co"># do SVD</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "d" "u" "v"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> sX<span class="sc">$</span>d</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> sX<span class="sc">$</span>u</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> sX<span class="sc">$</span>v</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">diag</span>(d)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(U, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]    [,2]    [,3]
[1,] -0.5148 -0.2737  0.1578
[2,] -0.1979  0.1764  0.6615
[3,] -0.2636  0.0004 -0.2499
[4,]  0.0322  0.7302 -0.4417
[5,]  0.1724 -0.5997 -0.4325
[6,]  0.7717 -0.0337  0.3047</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(V, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]    [,2]    [,3]
[1,] 0.5987 -0.3116 -0.7379
[2,] 0.5890 -0.4531  0.6692
[3,] 0.5428  0.8353  0.0877</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(D, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]   [,2]   [,3]
[1,] 3.5557 0.0000 0.0000
[2,] 0.0000 1.3496 0.0000
[3,] 0.0000 0.0000 0.7318</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">t</span>(V) <span class="sc">%*%</span> V, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    0    0
[2,]    0    1    0
[3,]    0    0    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">t</span>(U) <span class="sc">%*%</span> U, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    0    0
[2,]    0    1    0
[3,]    0    0    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(U <span class="sc">%*%</span> D <span class="sc">%*%</span> <span class="fu">t</span>(V), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]    [,2]    [,3]
[1,] -1.0660 -0.8335 -1.2919
[2,] -0.8528 -0.1985 -0.1407
[3,] -0.4264 -0.6747 -0.5245
[4,]  0.0000 -0.5954  0.8570
[5,]  0.8528  0.5160 -0.3710
[6,]  1.4924  1.7861  1.4710</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>pcs <span class="ot">&lt;-</span> U <span class="sc">%*%</span> D</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>pcs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]          [,2]       [,3]
[1,] -1.8304133 -0.3693701932  0.1155180
[2,] -0.7038288  0.2380860647  0.4841423
[3,] -0.9373818  0.0004838648 -0.1828813
[4,]  0.1145313  0.9855754071 -0.3232196
[5,]  0.6131207 -0.8093127525 -0.3165460
[6,]  2.7439719 -0.0454623909  0.2229866</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>pcss <span class="ot">&lt;-</span> X <span class="sc">%*%</span> V</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>pcss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]          [,2]       [,3]
[1,] -1.8304133 -0.3693701932  0.1155180
[2,] -0.7038288  0.2380860647  0.4841423
[3,] -0.9373818  0.0004838648 -0.1828813
[4,]  0.1145313  0.9855754071 -0.3232196
[5,]  0.6131207 -0.8093127525 -0.3165460
[6,]  2.7439719 -0.0454623909  0.2229866</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using pcob</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>pcob <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(M, <span class="at">scale=</span><span class="cn">TRUE</span>)  <span class="co"># use R function prcomp, with scaling</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                               <span class="co"># Use scaling when the features are very different.</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pcob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sdev"     "rotation" "center"   "scale"    "x"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pcob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2     PC3
Standard deviation     1.5902 0.6036 0.32729
Proportion of Variance 0.8429 0.1214 0.03571
Cumulative Proportion  0.8429 0.9643 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>pcob<span class="sc">$</span>sdev      <span class="co"># standard deviation from PCs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5901502 0.6035781 0.3272855</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>pcob<span class="sc">$</span>rotation  <span class="co"># same as matrix V</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           PC1        PC2         PC3
[1,] 0.5986878 -0.3115670 -0.73790166
[2,] 0.5890133 -0.4530530  0.66918331
[3,] 0.5428040  0.8352658  0.08772019</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>pcob<span class="sc">$</span>center    <span class="co"># means for scaling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.00000 36.50000 36.83333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>pcob<span class="sc">$</span>scale     <span class="co"># sd for scaling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  4.690416 12.597619 13.029454</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>pcob<span class="sc">$</span>x        <span class="co"># XV or UD</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            PC1           PC2        PC3
[1,] -1.8304133 -0.3693701932  0.1155180
[2,] -0.7038288  0.2380860647  0.4841423
[3,] -0.9373818  0.0004838648 -0.1828813
[4,]  0.1145313  0.9855754071 -0.3232196
[5,]  0.6131207 -0.8093127525 -0.3165460
[6,]  2.7439719 -0.0454623909  0.2229866</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>totalsum <span class="ot">&lt;-</span> <span class="fu">sum</span>(pcss<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># total sum</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>pc1sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(pcss[,<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="co"># sum from PC1</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>pc2sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(pcss[,<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="co"># sum from PC2</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>pc3sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(pcss[,<span class="dv">3</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="co"># sum from PC3</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">c</span>(pc1sum, pc2sum, pc3sum)<span class="sc">/</span>(<span class="dv">6-1</span>)) <span class="co"># n-1=6-1=5 </span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>sd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5901502 0.6035781 0.3272855</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>totalsum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>pc1sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.64289</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>pc2sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.821532</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>pc3sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.535579</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>propvar <span class="ot">&lt;-</span> <span class="fu">c</span>(pc1sum, pc2sum, pc3sum)<span class="sc">/</span>totalsum</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(propvar, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8429 0.1214 0.0357</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pcob, <span class="at">scale=</span><span class="dv">0</span>)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pcob<span class="sc">$</span>x[,<span class="dv">1</span>], pcob<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">xlab=</span><span class="st">"PC1"</span>, <span class="at">ylab=</span><span class="st">"PC2"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Plot PC1 vs. PC2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Using the US Arrest Dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the USArrests data and set row names as state names</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"USArrests"</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">row.names</span>(USArrests)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(USArrests) <span class="ot">&lt;-</span> states</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Display dimensions and variable names of the dataset</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(USArrests)</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co"># names(USArrests)</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Optionally, calculate means and standard deviations for each variable</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="co"># apply(USArrests, 2, mean)</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="co"># apply(USArrests, 2, sd)</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA on the scaled data</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>pr.out <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(USArrests, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pr.out) <span class="co"># 2 principal components are sufficient</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2     PC3     PC4
Standard deviation     1.5749 0.9949 0.59713 0.41645
Proportion of Variance 0.6201 0.2474 0.08914 0.04336
Cumulative Proportion  0.6201 0.8675 0.95664 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the components of the PCA output</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>center  <span class="co"># Mean of each variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Murder  Assault UrbanPop     Rape 
   7.788  170.760   65.540   21.232 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>scale   <span class="co"># Scaling applied to each variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Murder   Assault  UrbanPop      Rape 
 4.355510 83.337661 14.474763  9.366385 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>rotation  <span class="co"># The rotation (loading of each variable on the principal components)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                PC1        PC2        PC3         PC4
Murder   -0.5358995  0.4181809 -0.3412327  0.64922780
Assault  -0.5831836  0.1879856 -0.2681484 -0.74340748
UrbanPop -0.2781909 -0.8728062 -0.3780158  0.13387773
Rape     -0.5434321 -0.1673186  0.8177779  0.08902432</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dimensions and plot of the first two principal components</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pr.out<span class="sc">$</span>x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50  4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pr.out, <span class="at">scale =</span> <span class="dv">0</span>, <span class="at">main =</span> <span class="st">"The first two Principal Components"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For the above graph, the top represents PC1 score while the right scale represents PC2 score.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To create a mirrored version of the biplot</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="do">## The software may result in different sign for its loading vectors, the rotation converts the sign.</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>rotation <span class="ot">&lt;-</span> <span class="sc">-</span>pr.out<span class="sc">$</span>rotation</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="sc">-</span>pr.out<span class="sc">$</span>x</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pr.out, <span class="at">scale =</span> <span class="dv">0</span>, <span class="at">main =</span> <span class="st">"The first two Principal Components mirror image"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Explanation of the graph above:</p>
<ul>
<li><p>Red Arrows:</p>
<ul>
<li>The direction of an arrow shows how that variable influences the principal components.</li>
<li>The length of an arrow indicates how strongly that variable contributes to the principal components.</li>
</ul></li>
<li><p>Interpretation of Loading:</p>
<ul>
<li>Murder, Assault, and Rape are pointing in the same general direction, meaning they are correlated.
<ul>
<li>It suggest that Florida seems to have relately high values for Murder, Assault and Rape.</li>
<li>The states on the left side have lower values for murder, assault and rape</li>
</ul></li>
<li>UrbanPop is pointing in a different direction, suggesting it has a different relationship with crime rates.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the proportion of variance explained by each principal component</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>pr.var <span class="ot">&lt;-</span> pr.out<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>pve <span class="ot">&lt;-</span> pr.var<span class="sc">/</span><span class="fu">sum</span>(pr.var)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(pve, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6201 0.2474 0.0891 0.0434</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the variance explained</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pve, <span class="at">xlab =</span> <span class="st">"Principal Component"</span>, <span class="at">ylab =</span> <span class="st">"Proportion of Variance Explained"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">type =</span> <span class="st">"b"</span>)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cumsum</span>(pve), <span class="at">xlab =</span> <span class="st">"Cumulative Principal Component"</span>, <span class="at">ylab =</span> <span class="st">"Proportion of Variance Explained"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">type =</span> <span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="lesson-3-unsupervised-learning-ii" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Lesson 3: Unsupervised Learning II üêü</h1>
<section id="kmeans-clustering" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="kmeans-clustering"><span class="header-section-number">3.1</span> Kmeans-clustering</h2>
<p>An approach for partitioning a dataset into <span class="math inline">\(K\)</span> distinct, non-overlapping clusters</p>
<ul>
<li><p>Properties</p>
<ul>
<li><p>Each observation belongs to at least one of the K clusters</p></li>
<li><p>Clusters are non-overlapping: No observation belongs to more than one cluster</p></li>
</ul></li>
<li><p>Within Cluster Variation</p></li>
</ul>
<p><span class="math display">\[
\min_{C_1,...,C_K} \{\sum^K_{k=1} WCV(C_k) \}
\]</span></p>
<p>The formula above is to be solved such that the total within-cluster variation, summed over all <span class="math inline">\(K\)</span> clusters, is minimised.</p>
<ul>
<li>Euclidean distance calculation:</li>
</ul>
<p><span class="math display">\[
WCV(C_k)= \frac{1}{|C_k|} \sum_{i,i'\epsilon C_k} \sum^p_{j=1} (x_{ij}-x_{i'j})^2
\]</span> where <span class="math inline">\(|C_k|\)</span> denotes the no. of obs in the <span class="math inline">\(k\)</span>th cluster.</p>
<p><span class="math inline">\((x_{ij}-x_{i'j})^2\)</span> : Represents the distance between two observation</p>
<p>Combining the two formulas above gives us:</p>
<p><span class="math display">\[
\min_{C_1,...,C_K} \{\sum^K_{k=1} \frac{1}{|C_k|} \sum_{i,i'\epsilon C_k} \sum^p_{j=1} (x_{ij}-x_{i'j})^2 \}
\]</span> Can be simplied to: <span class="math display">\[
2\sum_{i\subset C_k}\sum^{p}_{j=1} (x_{ij}-\bar{x}_{kj})^2
\]</span></p>
<p><span class="math inline">\(\bar{x}\_{kj}\)</span> : Represents the mean of the cluster The code chunk below uses the formulas above to deduce the total sum.</p>
<p>The code chunk below manually calculates the formula seen above</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">20</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">27</span>)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>su1<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="fu">length</span>(d1)) {</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  su1 <span class="ot">&lt;-</span> su1 <span class="sc">+</span> <span class="fu">sum</span>((d1[i]<span class="sc">-</span>d1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> su1<span class="sc">/</span><span class="fu">length</span>(d1)</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>su2<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="fu">length</span>(d2)) {</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>  su2 <span class="ot">&lt;-</span> su2 <span class="sc">+</span> <span class="fu">sum</span>((d2[i]<span class="sc">-</span>d2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> su2<span class="sc">/</span><span class="fu">length</span>(d2)</span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a>su3<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="fu">length</span>(d3)) {</span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a>  su3 <span class="ot">&lt;-</span> su3 <span class="sc">+</span> <span class="fu">sum</span>((d3[i]<span class="sc">-</span>d3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a>s3 <span class="ot">&lt;-</span> su3<span class="sc">/</span><span class="fu">length</span>(d3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>s1 ; s2 ; s3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 85.6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 117.6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>tots <span class="ot">&lt;-</span> s1<span class="sc">+</span>s2<span class="sc">+</span>s3</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>tots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 239.2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>sum1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((d1<span class="sc">-</span><span class="fu">mean</span>(d1))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>sum2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((d2<span class="sc">-</span><span class="fu">mean</span>(d2))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>sum3 <span class="ot">&lt;-</span> <span class="fu">sum</span>((d3<span class="sc">-</span><span class="fu">mean</span>(d3))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>totsum <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(sum1<span class="sc">+</span>sum2<span class="sc">+</span>sum3)</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(sum1, sum2, sum3, totsum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  42.8  18.0  58.8 239.2</code></pre>
</div>
</div>
<p>We see that both formula yield the same total value.</p>
<section id="general-steps-in-k-clustering" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="general-steps-in-k-clustering"><span class="header-section-number">3.1.1</span> General steps in K-clustering</h3>
<ol type="1">
<li><p>Randomly assign a number, from 1 to <span class="math inline">\(K\)</span>, to each observation. These serve as initial cluster assignments.</p></li>
<li><p>Iterate until cluster assignments stop changing:</p>
<p>2.1: For each of the <span class="math inline">\(K\)</span> clusters, compute the cluster centroid. The <span class="math inline">\(k\)</span>th cluster centroid is the vector of the <span class="math inline">\(p\)</span> feature means for the observations in the <span class="math inline">\(k\)</span>th cluster.</p>
<p>2.2: Assign each observation to the cluster whose centroid is closest, defined by the Euclidean distance.</p></li>
</ol>
<p>Visual Representation of the steps:</p>
<p><img src="images/Lesson3_img3.png" class="img-fluid"></p>
</section>
<section id="example-code-of-the-steps-shown-above" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="example-code-of-the-steps-shown-above"><span class="header-section-number">3.1.2</span> Example Code of the steps shown above</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">11</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">22</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>x <span class="co"># To view the matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   12   17
[2,]   13   19
[3,]   11   20
[4,]   18   21
[5,]   16   22</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">"plot of X1 and X2"</span>, <span class="at">xlab=</span><span class="st">"X1"</span>, <span class="at">ylab=</span><span class="st">"X2"</span>, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>k.out <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(x, <span class="at">centers =</span> <span class="dv">2</span>, <span class="at">nstart=</span><span class="dv">20</span>)  <span class="co"># centers : No. of clusters, nstart: No. of random sets</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>k.out<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 2 2 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Clusters</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span>(k.out<span class="sc">$</span>cluster<span class="sc">+</span><span class="dv">1</span>), <span class="at">main=</span><span class="st">"K-means Clustering Results with K=2"</span>,</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"X1"</span>, <span class="at">ylab=</span><span class="st">"X2"</span>, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the summary of the cluster</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>k.out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 2 clusters of sizes 2, 3

Cluster means:
  [,1]     [,2]
1   17 21.50000
2   12 18.66667

Clustering vector:
[1] 2 2 2 1 1

Within cluster sum of squares by cluster:
[1] 2.500000 6.666667
 (between_SS / total_SS =  81.2 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
<p>Total variation is reduced by 81.2% by clustering them.</p>
<p><strong>Steps taken from the above example:</strong></p>
<ol type="1">
<li>Randomly placed with 2 clusters</li>
</ol>
<pre><code>-   Cluster 1: </code></pre>
<p><span class="math display">\[
(12,17),\space (16,22)
\]</span></p>
<pre><code>-   Cluster 2: </code></pre>
<p><span class="math display">\[
(13,19),\space (11,20), \space (18,21)
\]</span></p>
<ol start="2" type="1">
<li>Calculate the centroid of each cluster</li>
</ol>
<pre><code>-   Cluster 1: </code></pre>
<p><span class="math display">\[
[\frac{12+16}{2},\space \frac{17+22}{2}] = [14, 19.5]
\]</span></p>
<pre><code>-   Cluster 2:</code></pre>
<p><span class="math display">\[
[\frac{13+11+18}{3},\space \frac{19+20+21}{3}] = [14, 20]
\]</span></p>
<ol start="3" type="1">
<li>Form the new cluster by comparing the distance from the centroid of each cluster</li>
</ol>
<pre><code>-   New cluster 1: </code></pre>
<p><span class="math display">\[
(12,17), (13,19)
\]</span></p>
<pre><code>-   New cluster 2:</code></pre>
<p><span class="math display">\[
(16, 22), (11,20), (18,21)
\]</span></p>
<p>From the above, we see that observation <span class="math inline">\((13,19)\)</span> is closer to the centroid of cluster 1. Hence we bring that observation over. Similarly for observation <span class="math inline">\((16,22)\)</span> where it is closer to the centroid of cluster 2. Hence we will bring that observation over.</p>
<p>The steps above will be repeated until no more changes can be made.</p>
<p><strong>Below is how the variation is manually calculated. We can see that the end result is the same as the above</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual calculation of the variation:</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> k.out<span class="sc">$</span>centers[<span class="dv">1</span>,]</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> k.out<span class="sc">$</span>centers[<span class="dv">2</span>,]</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate total sum of squares</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>tot <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">5</span>)</span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>  tot[i] <span class="ot">&lt;-</span> (x[i,<span class="dv">1</span>]<span class="sc">-</span><span class="fu">mean</span>(x[,<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(x[i,<span class="dv">2</span>]<span class="sc">-</span><span class="fu">mean</span>(x[,<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>sstot <span class="ot">&lt;-</span> <span class="fu">sum</span>(tot)</span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>sstot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the sum of squares due to group 1</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>totg1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">2</span>)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  totg1[i<span class="dv">-3</span>] <span class="ot">&lt;-</span> (x[i,<span class="dv">1</span>]<span class="sc">-</span>g1[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(x[i,<span class="dv">2</span>]<span class="sc">-</span>g1[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>ssg1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(totg1)</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>ssg1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the sum of squares due to group 2</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>totg2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">3</span>)</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>  totg2[i] <span class="ot">&lt;-</span> (x[i,<span class="dv">1</span>]<span class="sc">-</span>g2[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(x[i,<span class="dv">2</span>]<span class="sc">-</span>g2[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>ssg2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(totg2)</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>ssg2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the proportion of sum of squares explained by clusters</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span>(ssg1<span class="sc">+</span>ssg2)<span class="sc">/</span>sstot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8121585</code></pre>
</div>
</div>
</section>
<section id="practical-application" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="practical-application"><span class="header-section-number">3.1.3</span> Practical Application</h3>
<section id="initial-visualisation-of-pca" class="level4" data-number="3.1.3.1">
<h4 data-number="3.1.3.1" class="anchored" data-anchor-id="initial-visualisation-of-pca"><span class="header-section-number">3.1.3.1</span> Initial Visualisation of PCA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>score <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Datasets/Score.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Participation     Assignment         Test             Exam       
 Min.   :70.00   Min.   : 27.0   Min.   : 15.00   Min.   : 17.00  
 1st Qu.:76.00   1st Qu.: 81.0   1st Qu.: 50.00   1st Qu.: 53.00  
 Median :78.00   Median : 88.0   Median : 65.00   Median : 64.00  
 Mean   :78.17   Mean   : 83.5   Mean   : 65.38   Mean   : 64.66  
 3rd Qu.:80.00   3rd Qu.: 93.0   3rd Qu.: 85.00   3rd Qu.: 78.00  
 Max.   :86.00   Max.   :100.0   Max.   :100.00   Max.   :100.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 257   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(score)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="co"># perform PCA</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>pr.out <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(score)  <span class="co"># we do not scale the data  </span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pr.out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                           PC1     PC2     PC3     PC4
Standard deviation     26.6739 12.6139 10.4077 4.20077
Proportion of Variance  0.7139  0.1597  0.1087 0.01771
Cumulative Proportion   0.7139  0.8736  0.9823 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pr.out, <span class="at">scale=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>rotation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      PC1         PC2         PC3          PC4
Participation -0.02389266 -0.02455078  0.02916386  0.998987422
Assignment    -0.32485603 -0.80661523  0.49201636 -0.041956287
Test          -0.75938555  0.53357169  0.37199696 -0.015909112
Exam          -0.56323288 -0.25312127 -0.78656700  0.003271184</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>pc1 <span class="ot">&lt;-</span> pr.out<span class="sc">$</span>x[,<span class="dv">1</span>]</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pc1, score<span class="sc">$</span>Participation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pc1, score<span class="sc">$</span>Assignment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-28-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pc1, score<span class="sc">$</span>Test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-28-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pc1, score<span class="sc">$</span>Exam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-28-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="k-means-clustering" class="level4" data-number="3.1.3.2">
<h4 data-number="3.1.3.2" class="anchored" data-anchor-id="k-means-clustering"><span class="header-section-number">3.1.3.2</span> K-means clustering</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>k.out <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(score, <span class="dv">4</span>, <span class="at">nstart=</span><span class="dv">20</span>)  <span class="co"># we set 4 clusters</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>k.out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 4 clusters of sizes 45, 91, 87, 34

Cluster means:
  Participation Assignment     Test     Exam
1      77.80000   87.15556 37.95556 50.57778
2      78.26374   86.12088 63.09890 63.93407
3      78.89655   90.89655 89.05747 80.75862
4      76.55882   52.73529 47.20588 44.05882

Clustering vector:
  [1] 2 3 3 3 3 1 3 2 1 4 3 2 3 3 1 2 3 3 3 2 3 2 3 1 4 2 2 3 4 2 3 2 1 3 2 3 1
 [38] 2 2 2 4 2 1 2 1 3 3 3 4 3 2 2 3 1 4 1 1 2 1 4 1 1 3 3 3 2 2 4 2 4 2 3 4 3
 [75] 2 2 4 2 3 1 4 1 3 2 1 2 2 2 3 2 2 4 3 2 4 2 4 2 3 3 3 1 3 3 1 3 3 4 2 3 2
[112] 3 3 4 3 4 2 4 4 4 2 2 4 3 3 3 2 1 3 2 1 3 3 3 3 3 3 4 3 3 3 2 3 1 2 2 4 2
[149] 1 4 2 2 4 2 3 3 2 3 3 3 3 2 2 4 3 3 4 4 2 2 2 3 3 4 2 2 4 1 1 4 2 1 2 2 1
[186] 2 3 2 2 3 3 3 2 3 2 3 1 1 2 3 2 1 2 1 3 3 1 3 3 3 1 2 3 3 2 2 2 2 2 1 2 2
[223] 1 1 1 1 1 3 2 1 1 3 2 2 2 2 3 1 1 2 2 2 4 2 2 2 1 2 2 2 1 3 3 3 2 4 3

Within cluster sum of squares by cluster:
[1] 13106.00 24081.05 18410.78 20946.44
 (between_SS / total_SS =  70.0 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only K-means</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(score<span class="sc">$</span>Exam, score<span class="sc">$</span>Test, <span class="at">col=</span>(k.out<span class="sc">$</span>cluster<span class="sc">+</span><span class="dv">1</span>), </span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"K-means Clustering Results with K=4 based on Exam and Test scores"</span>,</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Exam"</span>, <span class="at">ylab=</span><span class="st">"Test"</span>, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With PCA</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pr.out<span class="sc">$</span>x[,<span class="dv">1</span>], pr.out<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">col=</span>(k.out<span class="sc">$</span>cluster<span class="sc">+</span><span class="dv">1</span>), </span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"K-means Clustering Results with K=4 based on PCA"</span>,</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"PC1"</span>, <span class="at">ylab=</span><span class="st">"PC2"</span>, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="hierarchical-clustering" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="hierarchical-clustering"><span class="header-section-number">3.2</span> Hierarchical clustering</h2>
<section id="theory" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="theory"><span class="header-section-number">3.2.1</span> Theory</h3>
<ul>
<li><p>Difference to K-Means</p>
<ul>
<li>Does not require pre-determination of clusters</li>
<li>Results in an attractive tree-based representation</li>
<li>Dendrogram is built starting from the leaves and combining clusters up to the trunk (bottom-up clusters)</li>
</ul></li>
<li><p>Methodology (As illustrated below):</p>
<ol type="1">
<li>Start with each point in its own cluster</li>
<li>Identify the closest two clusters and merge them</li>
<li>Repeat Step 1 and 2</li>
<li>Ends when all points are in a single cluster</li>
</ol></li>
</ul>
<p><img src="images/Lesson3_img1.png" class="img-fluid"></p>
<p>For the example above,</p>
<ol type="1">
<li>We start by identifying A and C to be the closest, forming the first part of the Dendrogram</li>
<li>Afterwards, we find the next closest, which is D and E, which forms the second part of the Dendrogram.</li>
<li>Next, cluster AC is closest to B and therefore we merge them together to form one cluster. This is represented in the Dendrogram as well.</li>
<li>Lastly, cluster ACB and cluster DE are merged together, forming the entire Dendrogram</li>
</ol>
</section>
<section id="types-of-linkages-and-its-numerical-example" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="types-of-linkages-and-its-numerical-example"><span class="header-section-number">3.2.2</span> Types of linkages and its numerical example</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Types of Linkages</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 96%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Linkage</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Complete</td>
<td style="text-align: left;">Maximal inter-cluster dissimilarity. Compute all pairwise dissimilarities between the observations in cluster A and the observations in cluster B, and record the largest of these dissimilarities.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Single</td>
<td style="text-align: left;">Minimal inter-cluster dissimilarity. Compute all pairwise dissimilarities between the observations. Compute all pairwise dissimilarities between the observations in cluster A and the observations in cluster B, and record the smallest of these dissimilarities.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Average</td>
<td style="text-align: left;">Mean inter-cluster dissimilarity. Compute all pairwise dissimilarities between the observations in cluster A and the observations in cluster B, and record the average of these dissimilarities.</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Formal formulas: Complete: <span class="math display">\[
d_{CL}(G,H) =\max_{i\space \epsilon \space G,i' \space \epsilon \space H} {d_{ii'}}
\]</span> Let‚Äôs say:</p>
<ul>
<li><p>Cluster 1 has 2 observations: <span class="math display">\[
(2, 4), (3, 5)
\]</span></p></li>
<li><p>Cluster 2 has 2 observations: <span class="math display">\[
(4, 6), (7,6)
\]</span></p></li>
<li><p>Cluster 3 has 1 observation: <span class="math display">\[
(5, 9)
\]</span></p></li>
</ul>
<p>The inter-cluster dissimilarity between Clusters 1 and 2:</p>
<ul>
<li><p>(2, 4) and (4, 6) dissimilarity measure =<span class="math inline">\(\sqrt{(2-4)^2+(4-6)^2} = \sqrt{8}\)</span></p></li>
<li><p>(2, 4) and (7, 6) dissimilarity measure =<span class="math inline">\(\sqrt{(2-7)^2+(4-6)^2 }= \sqrt{29}\)</span></p></li>
<li><p>(3, 5) and (4, 6) dissimilarity measure =<span class="math inline">\(\sqrt{(3-4)^2+(5-6)^2}=\sqrt{2}\)</span></p></li>
<li><p>(3, 5) and (7, 6) dissimilarity measure =<span class="math inline">\(\sqrt{(3-7)^2+(5-6)^2}=\sqrt{17}\)</span></p></li>
</ul>
<p>The inter-cluster dissimilarity between Clusters 2 and 3:</p>
<ul>
<li><p>(4, 6) and (5, 9) dissimilarity measure =<span class="math inline">\(\sqrt{(4-5)^2+(6-9)^2} = \sqrt{10}\)</span></p></li>
<li><p>(7, 6) and (5, 9) dissimilarity measure =<span class="math inline">\(\sqrt{(7-5)^2+(6-9)^2 }= \sqrt{13}\)</span></p></li>
</ul>
<p>The inter-cluster dissimilarity between Clusters 1 and 3:</p>
<ul>
<li><p>(2, 4) and (5, 9) dissimilarity measure =<span class="math inline">\(\sqrt{(2-5)^2+(4-9)^2} = \sqrt{34}\)</span></p></li>
<li><p>(3, 5) and (5, 9) dissimilarity measure =<span class="math inline">\(\sqrt{(3-5)^2+(5-9)^2 }= \sqrt{20}\)</span></p></li>
</ul>
<p><strong>Complete linkage</strong>: Focus on farthest pair of points, producing tight, compact clusters</p>
<p>Therefore, inter-cluster dissimilarity between Clusters 1 and 2 = <span class="math inline">\(\max(\sqrt{8},\sqrt{29},\sqrt{2},\sqrt{17})=\sqrt{29}\)</span></p>
<p><strong>Single linkage</strong>: Focuses on closest pair of points, resulting in elongated clusters</p>
<p>Therefore, inter-cluster dissimilarity between Clusters 1 and 2 = <span class="math inline">\(\min(\sqrt{8},\sqrt{29},\sqrt{2},\sqrt{17})=\sqrt{2}\)</span></p>
<p><strong>Average linkage</strong>: Leads to balanced clustering</p>
<p>Therefore, inter-cluster dissimilarity between Clusters 1 and 2 = <span class="math inline">\(\frac{(\sqrt{8}+\sqrt{29}+\sqrt{2}+\sqrt{17})}{4}=3.4377\)</span></p>
</section>
<section id="additional-information" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="additional-information"><span class="header-section-number">3.2.3</span> Additional information:</h3>
<ul>
<li><pre><code>Correlation-based distance</code></pre>
<ul>
<li>If two observations are highly correlated but they have high Euclidean distance, correlation-based distance may be prefered
<ul>
<li>This measure focuses on the shapes of observation profiles rather than their magnitudes</li>
</ul></li>
</ul></li>
</ul>
<p><img src="images/Lesson3_img2.png" class="img-fluid"></p>
</section>
<section id="example-code" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="example-code"><span class="header-section-number">3.2.4</span> Example Code</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>super <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Datasets/Supermarket.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(super)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Customers      Milk         Bread          Beer        Shampoo    
 A      :1   Min.   :0.0   Min.   :0.0   Min.   :0.0   Min.   :0.00  
 B      :1   1st Qu.:0.0   1st Qu.:0.0   1st Qu.:0.0   1st Qu.:0.25  
 C      :1   Median :1.0   Median :1.0   Median :0.0   Median :1.00  
 D      :1   Mean   :1.1   Mean   :0.6   Mean   :1.4   Mean   :0.90  
 E      :1   3rd Qu.:2.0   3rd Qu.:1.0   3rd Qu.:2.5   3rd Qu.:1.00  
 F      :1   Max.   :3.0   Max.   :1.0   Max.   :6.0   Max.   :2.00  
 (Other):4                                                           
     Chips    
 Min.   :0.0  
 1st Qu.:0.0  
 Median :0.5  
 Mean   :1.2  
 3rd Qu.:2.5  
 Max.   :4.0  
              </code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(super)</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9876</span>)</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>k.out <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(super[,<span class="sc">-</span><span class="dv">1</span>], <span class="dv">3</span>, <span class="at">nstart=</span><span class="dv">20</span>) <span class="co"># Remove the customer column</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>k.out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 3 clusters of sizes 3, 4, 3

Cluster means:
       Milk     Bread      Beer   Shampoo     Chips
1 0.6666667 0.3333333 0.3333333 0.3333333 0.3333333
2 2.2500000 1.0000000 0.0000000 1.5000000 0.2500000
3 0.0000000 0.3333333 4.3333333 0.6666667 3.3333333

Clustering vector:
 [1] 2 2 3 3 1 2 2 1 1 3

Within cluster sum of squares by cluster:
[1] 3.333333 2.500000 6.666667
 (between_SS / total_SS =  84.8 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>km.cluster <span class="ot">&lt;-</span> k.out<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that under Dendrogram, the function <em>cutree(tree, cluster)</em> helps us cut the tree such that we achieve the desired number of cluster.</p>
<p><strong>Correlation Distance Graph</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">cor</span>(<span class="fu">t</span>(super[,<span class="sc">-</span><span class="dv">1</span>])))  <span class="co"># find the correlation-based distance</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>kkc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dd, <span class="at">method=</span><span class="st">"complete"</span>)</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kkc, <span class="at">main=</span><span class="st">"Complete Linkage with Correlation-Based Distance"</span>,</span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">sub=</span><span class="st">""</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>hc.cluster <span class="ot">&lt;-</span> <span class="fu">cutree</span>(kkc, <span class="dv">3</span>)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>hc.cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 2 1 1 1 3 2 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(km.cluster, hc.cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          hc.cluster
km.cluster 1 2 3
         1 1 1 1
         2 4 0 0
         3 0 3 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>kks <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dd, <span class="at">method=</span><span class="st">"single"</span>)</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kks, <span class="at">main=</span><span class="st">"Single Linkage with Correlation-Based Distance"</span>,</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">sub=</span><span class="st">""</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(kks, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 2 1 1 1 3 2 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>kka <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dd, <span class="at">method=</span><span class="st">"average"</span>)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kka, <span class="at">main=</span><span class="st">"Average Linkage with Correlation-Based Distance"</span>,</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">sub=</span><span class="st">""</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-32-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(kka, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 2 1 1 1 3 2 2</code></pre>
</div>
</div>
<p><strong>Euclidean Distance Graph</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Euclidean distance</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>ggc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(super[,<span class="sc">-</span><span class="dv">1</span>]), <span class="at">method=</span><span class="st">"complete"</span>)  <span class="co"># use Euclidean distance</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ggc, <span class="at">main=</span><span class="st">"Complete Linkage with Euclidean Distance"</span>,</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">sub=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(ggc, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 2 3 1 1 3 3 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>ggs <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(super[,<span class="sc">-</span><span class="dv">1</span>]), <span class="at">method=</span><span class="st">"single"</span>)</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ggs, <span class="at">main=</span><span class="st">"Single Linkage with Euclidean Distance"</span>,</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">sub=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(ggs, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 3 1 1 1 1 1 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>gga <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(super[,<span class="sc">-</span><span class="dv">1</span>]), <span class="at">method=</span><span class="st">"average"</span>)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gga, <span class="at">main=</span><span class="st">"Average Linkage with Euclidean Distance"</span>,</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">sub=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-33-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(gga, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 3 1 1 1 1 1 2</code></pre>
</div>
</div>
</section>
<section id="considerations-in-clustering" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="considerations-in-clustering"><span class="header-section-number">3.2.5</span> Considerations in Clustering</h3>
<ol type="1">
<li>Should observations first be standardized?</li>
<li>How many clusters should be used for K-means clustering</li>
<li>For hierarchical clustering, what dissimilarity measure, linkage and cutting point of the dendrogram should be used?</li>
</ol>
</section>
</section>
</section>
<section id="lesson-4-multiple-linear-regression" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Lesson 4: Multiple Linear Regression üê∞</h1>
<section id="basic-theory-of-regression-model" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="basic-theory-of-regression-model"><span class="header-section-number">4.1</span> Basic theory of Regression Model</h2>
<p>Note: (Refer to stat learning notes)</p>
<p><span class="math display">\[
Y = \beta_0 +\beta_1X_1
+\beta_2X_2+ ...+\beta_p X_p+\epsilon
\]</span></p>
<ul>
<li><p>Interpretation of coefficient</p></li>
<li><p>Qualitative Variables</p>
<ul>
<li>Refers to binary variables</li>
</ul></li>
<li><p>Interaction variables</p>
<ul>
<li>Refers to multiplying two variables together to create an interaction effect</li>
</ul></li>
<li><p>Non-linear effects</p>
<ul>
<li>Refers to the use of power terms in the regression to capture non-linear effects</li>
</ul></li>
</ul>
</section>
<section id="dimension-reduction" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="dimension-reduction"><span class="header-section-number">4.2</span> Dimension Reduction</h2>
<section id="best-subset-approach" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="best-subset-approach"><span class="header-section-number">4.2.1</span> Best subset approach</h3>
<p>Note: Taken from Stat learning with R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps) <span class="co"># Subset package</span></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Important to remove NA values from dataset</span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>Hit <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Hitters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Best Subset Selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Forward Stepwise Selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Backward Stepwise Selection</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<section id="do-best-subset-model" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="do-best-subset-model"><span class="header-section-number">4.2.2</span> Do best subset model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>regfit2.all <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>., Hit, <span class="at">nvmax=</span><span class="dv">19</span>) <span class="co"># nvmax = 19 as there are 19 variables. Categorical variable counts as total number of levels - 1</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>reg2.summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(regfit2.all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualize-plots" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="visualize-plots"><span class="header-section-number">4.2.3</span> Visualize Plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg2.summary<span class="sc">$</span>rss, <span class="at">main=</span><span class="st">"RSS plot"</span>, </span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of variables"</span>, <span class="at">ylab=</span><span class="st">"RSS"</span>, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg2.summary<span class="sc">$</span>adjr2, <span class="at">main=</span><span class="st">"Adjusted r^2 plot"</span>, </span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of variables"</span>, <span class="at">ylab=</span><span class="st">"Adjusted r^2"</span>, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg2.summary<span class="sc">$</span>cp, <span class="at">main=</span><span class="st">"Cp plot"</span>, </span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of variables"</span>, <span class="at">ylab=</span><span class="st">"Cp"</span>, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-36-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg2.summary<span class="sc">$</span>bic, <span class="at">main=</span><span class="st">"BIC plot"</span>, </span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of variables"</span>, <span class="at">ylab=</span><span class="st">"BIC"</span>, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-36-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pick-best-model-based-on-selected-criterion" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="pick-best-model-based-on-selected-criterion"><span class="header-section-number">4.2.4</span> Pick best model based on selected Criterion</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">which.min</span>(reg2.summary<span class="sc">$</span>rss)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">which.max</span>(reg2.summary<span class="sc">$</span>adjr2)</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">which.min</span>(reg2.summary<span class="sc">$</span>cp)</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">which.min</span>(reg2.summary<span class="sc">$</span>bic)</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit2.all, a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        AtBat         Hits        HmRun         Runs          RBI 
 163.1035878   -1.9798729    7.5007675    4.3308829   -2.3762100   -1.0449620 
       Walks        Years       CAtBat        CHits       CHmRun        CRuns 
   6.2312863   -3.4890543   -0.1713405    0.1339910   -0.1728611    1.4543049 
        CRBI       CWalks      LeagueN    DivisionW      PutOuts      Assists 
   0.8077088   -0.8115709   62.5994230 -116.8492456    0.2818925    0.3710692 
      Errors   NewLeagueN 
  -3.3607605  -24.7623251 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit2.all, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        AtBat         Hits        Walks       CAtBat        CRuns 
 135.7512195   -2.1277482    6.9236994    5.6202755   -0.1389914    1.4553310 
        CRBI       CWalks      LeagueN    DivisionW      PutOuts      Assists 
   0.7852528   -0.8228559   43.1116152 -111.1460252    0.2894087    0.2688277 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit2.all, c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        AtBat         Hits        Walks       CAtBat        CRuns 
 162.5354420   -2.1686501    6.9180175    5.7732246   -0.1300798    1.4082490 
        CRBI       CWalks    DivisionW      PutOuts      Assists 
   0.7743122   -0.8308264 -112.3800575    0.2973726    0.2831680 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit2.all, d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        AtBat         Hits        Walks         CRBI    DivisionW 
  91.5117981   -1.8685892    7.6043976    3.6976468    0.6430169 -122.9515338 
     PutOuts 
   0.2643076 </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<section id="do-best-subset-model-1" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="do-best-subset-model-1"><span class="header-section-number">4.2.5</span> Do best subset model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>regfit4.all <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>., Hit, <span class="at">nvmax=</span><span class="dv">19</span>,</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">method =</span><span class="st">"forward"</span>) <span class="co"># nvmax = 19 as there are 19 variables. Categorical variable counts as total number of levels - 1</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>reg4.summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(regfit4.all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualize-plots-1" class="level3" data-number="4.2.6">
<h3 data-number="4.2.6" class="anchored" data-anchor-id="visualize-plots-1"><span class="header-section-number">4.2.6</span> Visualize Plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg4.summary<span class="sc">$</span>rss, <span class="at">main=</span><span class="st">"RSS plot"</span>, </span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of variables"</span>, <span class="at">ylab=</span><span class="st">"RSS"</span>, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg4.summary<span class="sc">$</span>adjr2, <span class="at">main=</span><span class="st">"Adjusted r^2 plot"</span>, </span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of variables"</span>, <span class="at">ylab=</span><span class="st">"Adjusted r^2"</span>, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-39-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg4.summary<span class="sc">$</span>cp, <span class="at">main=</span><span class="st">"Cp plot"</span>, </span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of variables"</span>, <span class="at">ylab=</span><span class="st">"Cp"</span>, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-39-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg4.summary<span class="sc">$</span>bic, <span class="at">main=</span><span class="st">"BIC plot"</span>, </span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of variables"</span>, <span class="at">ylab=</span><span class="st">"BIC"</span>, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-39-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pick-best-model-based-on-selected-criterion-1" class="level3" data-number="4.2.7">
<h3 data-number="4.2.7" class="anchored" data-anchor-id="pick-best-model-based-on-selected-criterion-1"><span class="header-section-number">4.2.7</span> Pick best model based on selected Criterion</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">which.min</span>(reg4.summary<span class="sc">$</span>rss)</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">which.max</span>(reg4.summary<span class="sc">$</span>adjr2)</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">which.min</span>(reg4.summary<span class="sc">$</span>cp)</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">which.min</span>(reg4.summary<span class="sc">$</span>bic)</span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit4.all, a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        AtBat         Hits        HmRun         Runs          RBI 
 163.1035878   -1.9798729    7.5007675    4.3308829   -2.3762100   -1.0449620 
       Walks        Years       CAtBat        CHits       CHmRun        CRuns 
   6.2312863   -3.4890543   -0.1713405    0.1339910   -0.1728611    1.4543049 
        CRBI       CWalks      LeagueN    DivisionW      PutOuts      Assists 
   0.8077088   -0.8115709   62.5994230 -116.8492456    0.2818925    0.3710692 
      Errors   NewLeagueN 
  -3.3607605  -24.7623251 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit4.all, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        AtBat         Hits        Walks       CAtBat        CRuns 
 135.7512195   -2.1277482    6.9236994    5.6202755   -0.1389914    1.4553310 
        CRBI       CWalks      LeagueN    DivisionW      PutOuts      Assists 
   0.7852528   -0.8228559   43.1116152 -111.1460252    0.2894087    0.2688277 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit4.all, c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        AtBat         Hits        Walks       CAtBat        CRuns 
 162.5354420   -2.1686501    6.9180175    5.7732246   -0.1300798    1.4082490 
        CRBI       CWalks    DivisionW      PutOuts      Assists 
   0.7743122   -0.8308264 -112.3800575    0.2973726    0.2831680 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit4.all, d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        AtBat         Hits        Walks         CRBI    DivisionW 
  91.5117981   -1.8685892    7.6043976    3.6976468    0.6430169 -122.9515338 
     PutOuts 
   0.2643076 </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<section id="do-backward-selection-model" class="level3" data-number="4.2.8">
<h3 data-number="4.2.8" class="anchored" data-anchor-id="do-backward-selection-model"><span class="header-section-number">4.2.8</span> Do Backward selection model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>regfit3.all <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>., Hit, <span class="at">nvmax=</span><span class="dv">19</span>,</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">method =</span> <span class="st">"backward"</span>) </span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="co"># nvmax = 19 as there are 19 variables. Categorical variable counts as total number of levels - 1</span></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>reg3.summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(regfit3.all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualize-plots-2" class="level3" data-number="4.2.9">
<h3 data-number="4.2.9" class="anchored" data-anchor-id="visualize-plots-2"><span class="header-section-number">4.2.9</span> Visualize Plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg3.summary<span class="sc">$</span>rss, <span class="at">main=</span><span class="st">"RSS plot"</span>, </span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of variables"</span>, <span class="at">ylab=</span><span class="st">"RSS"</span>, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg3.summary<span class="sc">$</span>adjr2, <span class="at">main=</span><span class="st">"Adjusted r^2 plot"</span>, </span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of variables"</span>, <span class="at">ylab=</span><span class="st">"Adjusted r^2"</span>, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg3.summary<span class="sc">$</span>cp, <span class="at">main=</span><span class="st">"Cp plot"</span>, </span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of variables"</span>, <span class="at">ylab=</span><span class="st">"Cp"</span>, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-42-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg3.summary<span class="sc">$</span>bic, <span class="at">main=</span><span class="st">"BIC plot"</span>, </span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of variables"</span>, <span class="at">ylab=</span><span class="st">"BIC"</span>, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-42-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pick-best-model-based-on-selected-criterion-2" class="level3" data-number="4.2.10">
<h3 data-number="4.2.10" class="anchored" data-anchor-id="pick-best-model-based-on-selected-criterion-2"><span class="header-section-number">4.2.10</span> Pick best model based on selected Criterion</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">which.min</span>(reg3.summary<span class="sc">$</span>rss)</span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">which.max</span>(reg3.summary<span class="sc">$</span>adjr2)</span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">which.min</span>(reg3.summary<span class="sc">$</span>cp)</span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">which.min</span>(reg3.summary<span class="sc">$</span>bic)</span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit3.all, a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        AtBat         Hits        HmRun         Runs          RBI 
 163.1035878   -1.9798729    7.5007675    4.3308829   -2.3762100   -1.0449620 
       Walks        Years       CAtBat        CHits       CHmRun        CRuns 
   6.2312863   -3.4890543   -0.1713405    0.1339910   -0.1728611    1.4543049 
        CRBI       CWalks      LeagueN    DivisionW      PutOuts      Assists 
   0.8077088   -0.8115709   62.5994230 -116.8492456    0.2818925    0.3710692 
      Errors   NewLeagueN 
  -3.3607605  -24.7623251 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit3.all, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        AtBat         Hits        Walks       CAtBat        CRuns 
 135.7512195   -2.1277482    6.9236994    5.6202755   -0.1389914    1.4553310 
        CRBI       CWalks      LeagueN    DivisionW      PutOuts      Assists 
   0.7852528   -0.8228559   43.1116152 -111.1460252    0.2894087    0.2688277 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit3.all, c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        AtBat         Hits        Walks       CAtBat        CRuns 
 162.5354420   -2.1686501    6.9180175    5.7732246   -0.1300798    1.4082490 
        CRBI       CWalks    DivisionW      PutOuts      Assists 
   0.7743122   -0.8308264 -112.3800575    0.2973726    0.2831680 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regfit3.all, d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        AtBat         Hits        Walks        CRuns         CRBI 
 117.1520434   -2.0339209    6.8549136    6.4406642    0.7045391    0.5273238 
      CWalks    DivisionW      PutOuts 
  -0.8066062 -123.7798366    0.2753892 </code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
</section>
<section id="lasso-ridge" class="level3" data-number="4.2.11">
<h3 data-number="4.2.11" class="anchored" data-anchor-id="lasso-ridge"><span class="header-section-number">4.2.11</span> Lasso / Ridge</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Lasso</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Ridge</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the necessary library</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the Hitters dataset</span></span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Hitters"</span>)</span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-8"><a href="#cb261-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with missing values</span></span>
<span id="cb261-9"><a href="#cb261-9" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Hitters)</span>
<span id="cb261-10"><a href="#cb261-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-11"><a href="#cb261-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the target variable and predictors</span></span>
<span id="cb261-12"><a href="#cb261-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Salary <span class="sc">~</span> ., Hitters)[, <span class="sc">-</span><span class="dv">1</span>]  <span class="co"># Predictor matrix (exclude intercept)</span></span>
<span id="cb261-13"><a href="#cb261-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Hitters<span class="sc">$</span>Salary  <span class="co"># Response variable</span></span>
<span id="cb261-14"><a href="#cb261-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-15"><a href="#cb261-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross-validation for Lasso regression</span></span>
<span id="cb261-16"><a href="#cb261-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb261-17"><a href="#cb261-17" aria-hidden="true" tabindex="-1"></a>cv.lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>)  <span class="co"># alpha = 1 for Lasso (L1 penalty)</span></span>
<span id="cb261-18"><a href="#cb261-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-19"><a href="#cb261-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the cross-validation results</span></span>
<span id="cb261-20"><a href="#cb261-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv.lasso)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the optimal lambda from cross-validation</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>cv.lasso<span class="sc">$</span>lambda.min</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.674375</code></pre>
</div>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using the optimal lambda</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>lasso.model <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> cv.lasso<span class="sc">$</span>lambda.min)</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on the test data (or using a train-test split)</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>predictions.lasso <span class="ot">&lt;-</span> <span class="fu">predict</span>(lasso.model, <span class="at">s =</span> cv.lasso<span class="sc">$</span>lambda.min, <span class="at">newx =</span> x)</span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the performance (MSE, RMSE, etc.)</span></span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a>mse.lasso <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions.lasso <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a>rmse.lasso <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse.lasso)</span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Lasso RMSE: "</span>, rmse.lasso))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lasso RMSE:  307.405398733538"</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the necessary library</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the Hitters dataset</span></span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Hitters"</span>)</span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with missing values</span></span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Hitters)</span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the target variable and predictors</span></span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Salary <span class="sc">~</span> ., Hitters)[, <span class="sc">-</span><span class="dv">1</span>]  <span class="co"># Predictor matrix (exclude intercept)</span></span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Hitters<span class="sc">$</span>Salary  <span class="co"># Response variable</span></span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross-validation for Ridge regression</span></span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb266-16"><a href="#cb266-16" aria-hidden="true" tabindex="-1"></a>cv.ridge <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">0</span>)  <span class="co"># alpha = 0 for Ridge (L2 penalty)</span></span>
<span id="cb266-17"><a href="#cb266-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-18"><a href="#cb266-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the cross-validation results</span></span>
<span id="cb266-19"><a href="#cb266-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv.ridge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the optimal lambda from cross-validation</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>cv.ridge<span class="sc">$</span>lambda.min</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25.52821</code></pre>
</div>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using the optimal lambda</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>ridge.model <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> cv.ridge<span class="sc">$</span>lambda.min)</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on the test data (or using a train-test split)</span></span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>predictions.ridge <span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge.model, <span class="at">s =</span> cv.ridge<span class="sc">$</span>lambda.min, <span class="at">newx =</span> x)</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the performance (MSE, RMSE, etc.)</span></span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a>mse.ridge <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions.ridge <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a>rmse.ridge <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse.ridge)</span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Ridge RMSE: "</span>, rmse.ridge))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ridge RMSE:  313.174799925814"</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="pcr-regression" class="level3" data-number="4.2.12">
<h3 data-number="4.2.12" class="anchored" data-anchor-id="pcr-regression"><span class="header-section-number">4.2.12</span> PCR regression</h3>
<section id="theory-1" class="level4" data-number="4.2.12.1">
<h4 data-number="4.2.12.1" class="anchored" data-anchor-id="theory-1"><span class="header-section-number">4.2.12.1</span> Theory</h4>
<ul>
<li>PCR may perform better: Lower variance but higher bias (When <span class="math inline">\(M&lt;p\)</span>)</li>
<li>When <span class="math inline">\(M=p\)</span> and no dimension reduction occurs, results are the same as OLS method.</li>
</ul>
</section>
<section id="example-1" class="level4" data-number="4.2.12.2">
<h4 data-number="4.2.12.2" class="anchored" data-anchor-id="example-1"><span class="header-section-number">4.2.12.2</span> Example 1</h4>
<p>Used when there are correlated predictors in the model:</p>
<p>The code below does PCA and the regression separately</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pls)</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>blood <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Datasets/BPressure.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(blood)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            BP      Chol       Age
BP   1.0000000 0.6103997 0.8421835
Chol 0.6103997 1.0000000 0.8360868
Age  0.8421835 0.8360868 1.0000000</code></pre>
</div>
</div>
<p>From the above, we notice that there is high correlation between the features.</p>
<ul>
<li>Basic regression</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>reg.re <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP<span class="sc">~</span>., <span class="at">data=</span>blood)</span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg.re)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ ., data = blood)

Residuals:
      1       2       3       4       5       6       7 
 0.6372  2.3373  3.6873 -0.9627  0.6067  1.9395 -8.2453 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  169.538    205.802   0.824   0.4563  
Chol          -1.283      1.919  -0.668   0.5406  
Age            2.933      1.240   2.366   0.0772 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.809 on 4 degrees of freedom
Multiple R-squared:  0.7385,    Adjusted R-squared:  0.6077 
F-statistic: 5.647 on 2 and 4 DF,  p-value: 0.0684</code></pre>
</div>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(reg.re, blood)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5        6        7 
119.3628 122.6627 124.3127 125.9627 134.3933 138.0605 127.2453 </code></pre>
</div>
</div>
<ul>
<li>Regression with PCR (Uses lm function and pc codes)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>pr.out <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(blood[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">scale=</span><span class="cn">TRUE</span>) <span class="co"># Removing the BP column</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pr.out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                         PC1     PC2
Standard deviation     1.355 0.40486
Proportion of Variance 0.918 0.08196
Cumulative Proportion  0.918 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             PC1         PC2
[1,] -2.06338636  0.10379457
[2,] -0.81497509 -0.16482081
[3,] -0.19076945 -0.29912850
[4,]  0.43343619 -0.43343619
[5,]  0.16482081  0.81497509
[6,]  2.41669438  0.03279536
[7,]  0.05417952 -0.05417952</code></pre>
</div>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>rotation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           PC1        PC2
Chol 0.7071068 -0.7071068
Age  0.7071068  0.7071068</code></pre>
</div>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>lmpr <span class="ot">&lt;-</span> <span class="fu">lm</span>(blood<span class="sc">$</span>BP<span class="sc">~</span>pr.out<span class="sc">$</span>x[,<span class="dv">1</span>]) <span class="co"># Using only the first principle component </span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmpr)               </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = blood$BP ~ pr.out$x[, 1])

Residuals:
     1      2      3      4      5      6      7 
 1.434  1.072  1.391 -4.290  6.863  2.191 -8.661 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    127.429      2.073  61.457 2.16e-08 ***
pr.out$x[, 1]    4.295      1.653   2.599   0.0483 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.486 on 5 degrees of freedom
Multiple R-squared:  0.5746,    Adjusted R-squared:  0.4895 
F-statistic: 6.753 on 1 and 5 DF,  p-value: 0.04832</code></pre>
</div>
</div>
<ul>
<li>The code below uses a predefined function for PCR.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>pcr.re1 <span class="ot">&lt;-</span> <span class="fu">pcr</span>(BP<span class="sc">~</span>., <span class="at">data=</span>blood, <span class="at">scale=</span><span class="cn">TRUE</span>, <span class="at">ncomp=</span><span class="dv">1</span>)</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pcr.re1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data:   X dimension: 7 2 
    Y dimension: 7 1
Fit method: svdpc
Number of components considered: 1
TRAINING: % variance explained
    1 comps
X     91.80
BP    57.46</code></pre>
</div>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>pcr.re1<span class="sc">$</span>fitted.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , 1 comps

        BP
1 118.5659
2 123.9281
3 126.6092
4 129.2903
5 128.1365
6 137.8088
7 127.6613</code></pre>
</div>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>newx1 <span class="ot">&lt;-</span> pcr.re1<span class="sc">$</span>scores <span class="co"># Obtains the principal component score</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Take the obtained principal score and do a regression with it. As shown below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>newx1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Comp 1
1 -2.06338636
2 -0.81497509
3 -0.19076945
4  0.43343619
5  0.16482081
6  2.41669438
7  0.05417952
attr(,"class")
[1] "scores"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>newreg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(blood<span class="sc">$</span>BP <span class="sc">~</span> newx1)</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(newreg1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = blood$BP ~ newx1)

Residuals:
     1      2      3      4      5      6      7 
 1.434  1.072  1.391 -4.290  6.863  2.191 -8.661 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  127.429      2.073  61.457 2.16e-08 ***
newx1          4.295      1.653   2.599   0.0483 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.486 on 5 degrees of freedom
Multiple R-squared:  0.5746,    Adjusted R-squared:  0.4895 
F-statistic: 6.753 on 1 and 5 DF,  p-value: 0.04832</code></pre>
</div>
</div>
<p>If you use M=p, then you go back to the original OLS method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>pcr.re2 <span class="ot">&lt;-</span> <span class="fu">pcr</span>(BP<span class="sc">~</span>., <span class="at">data=</span>blood, <span class="at">scale=</span><span class="cn">TRUE</span>, <span class="at">ncomp=</span><span class="dv">2</span>)</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pcr.re2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data:   X dimension: 7 2 
    Y dimension: 7 1
Fit method: svdpc
Number of components considered: 2
TRAINING: % variance explained
    1 comps  2 comps
X     91.80   100.00
BP    57.46    73.85</code></pre>
</div>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>pcr.re2<span class="sc">$</span>fitted.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , 1 comps

        BP
1 118.5659
2 123.9281
3 126.6092
4 129.2903
5 128.1365
6 137.8088
7 127.6613

, , 2 comps

        BP
1 119.3628
2 122.6627
3 124.3127
4 125.9627
5 134.3933
6 138.0605
7 127.2453</code></pre>
</div>
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>newx2 <span class="ot">&lt;-</span> pcr.re2<span class="sc">$</span>scores</span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>newx2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Comp 1      Comp 2
1 -2.06338636  0.10379457
2 -0.81497509 -0.16482081
3 -0.19076945 -0.29912850
4  0.43343619 -0.43343619
5  0.16482081  0.81497509
6  2.41669438  0.03279536
7  0.05417952 -0.05417952
attr(,"class")
[1] "scores"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>newreg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(blood<span class="sc">$</span>BP <span class="sc">~</span> newx2)</span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(newreg2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = blood$BP ~ newx2)

Residuals:
      1       2       3       4       5       6       7 
 0.6372  2.3373  3.6873 -0.9627  0.6067  1.9395 -8.2453 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  127.429      1.818  70.107 2.48e-07 ***
newx2Comp 1    4.295      1.449   2.964   0.0414 *  
newx2Comp 2    7.677      4.849   1.583   0.1885    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.809 on 4 degrees of freedom
Multiple R-squared:  0.7385,    Adjusted R-squared:  0.6077 
F-statistic: 5.647 on 2 and 4 DF,  p-value: 0.0684</code></pre>
</div>
</div>
<p>Cross compare between the regressions done above.</p>
</section>
<section id="number-of-components-vs-test-mse" class="level4" data-number="4.2.12.3">
<h4 data-number="4.2.12.3" class="anchored" data-anchor-id="number-of-components-vs-test-mse"><span class="header-section-number">4.2.12.3</span> Number of components vs Test MSE:</h4>
<p>The larger the number of components: - the <strong>smaller</strong> the <strong>bias</strong> - the <strong>larger</strong> the <strong>variance</strong></p>
<p>To minimise the MSE in PCR, cross validation is used to determine the number of components.</p>
<p>The code below does the 10fold cross validation as explained earlier:</p>
</section>
<section id="cross-validation-for-pcr" class="level4" data-number="4.2.12.4">
<h4 data-number="4.2.12.4" class="anchored" data-anchor-id="cross-validation-for-pcr"><span class="header-section-number">4.2.12.4</span> Cross validation for pcr</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pls)</span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Hitters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "AtBat"     "Hits"      "HmRun"     "Runs"      "RBI"       "Walks"    
 [7] "Years"     "CAtBat"    "CHits"     "CHmRun"    "CRuns"     "CRBI"     
[13] "CWalks"    "League"    "Division"  "PutOuts"   "Assists"   "Errors"   
[19] "Salary"    "NewLeague"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Hitters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 263  20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(Hitters<span class="sc">$</span>Salary))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Hitters)</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Hitters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 263  20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co"># splitting train and test set</span></span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Hitters), <span class="fu">nrow</span>(Hitters)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> (<span class="sc">-</span>train)</span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true" tabindex="-1"></a><span class="co"># run PCR on the training data with Cross Validation</span></span>
<span id="cb310-7"><a href="#cb310-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb310-8"><a href="#cb310-8" aria-hidden="true" tabindex="-1"></a>pcr.fit <span class="ot">&lt;-</span> <span class="fu">pcr</span>(Salary<span class="sc">~</span>., </span>
<span id="cb310-9"><a href="#cb310-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>Hitters, </span>
<span id="cb310-10"><a href="#cb310-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">subset=</span>train,</span>
<span id="cb310-11"><a href="#cb310-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">scale=</span><span class="cn">TRUE</span>, </span>
<span id="cb310-12"><a href="#cb310-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">validation=</span><span class="st">"CV"</span>) <span class="co"># By default, it uses 10 fold validation.</span></span>
<span id="cb310-13"><a href="#cb310-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pcr.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data:   X dimension: 131 19 
    Y dimension: 131 1
Fit method: svdpc
Number of components considered: 19

VALIDATION: RMSEP
Cross-validated using 10 random segments.
       (Intercept)  1 comps  2 comps  3 comps  4 comps  5 comps  6 comps
CV           428.3    326.2    332.2    326.2    327.6    322.5    326.2
adjCV        428.3    325.7    331.5    325.1    326.7    321.3    324.9
       7 comps  8 comps  9 comps  10 comps  11 comps  12 comps  13 comps
CV       331.9    328.3    331.1     332.1     334.5     338.9     337.7
adjCV    330.3    326.6    328.6     329.9     332.2     336.4     335.1
       14 comps  15 comps  16 comps  17 comps  18 comps  19 comps
CV        338.7     341.7     340.1     344.2     353.3     345.0
adjCV     336.1     338.9     337.0     340.9     349.3     341.1

TRAINING: % variance explained
        1 comps  2 comps  3 comps  4 comps  5 comps  6 comps  7 comps  8 comps
X         39.32    61.57    71.96    80.83    85.95    89.99    93.25    95.34
Salary    43.87    43.93    47.36    47.37    49.52    49.55    49.63    50.98
        9 comps  10 comps  11 comps  12 comps  13 comps  14 comps  15 comps
X         96.55     97.61     98.28     98.85     99.22     99.53     99.79
Salary    53.00     53.00     53.02     53.05     53.80     53.85     54.03
        16 comps  17 comps  18 comps  19 comps
X          99.91     99.97     99.99    100.00
Salary     55.85     55.89     56.21     58.62</code></pre>
</div>
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">validationplot</span>(pcr.fit, <span class="at">val.type=</span><span class="st">"MSEP"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>pcr.fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Principal component regression, fitted with the singular value decomposition algorithm.
Cross-validated using 10 random segments.
Call:
pcr(formula = Salary ~ ., data = Hitters, subset = train, scale = TRUE,     validation = "CV")</code></pre>
</div>
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we find the lowest CV error when M=5</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the test MSE with five components</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Salary<span class="sc">~</span>., Hitters)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Hitters<span class="sc">$</span>Salary</span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a>pcr.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(pcr.fit, x[test,], <span class="at">ncomp=</span><span class="dv">5</span>)</span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((pcr.pred<span class="sc">-</span>y[test])<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 142811.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit PCR on the full data set with M=5</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>pcr.fitall <span class="ot">&lt;-</span> <span class="fu">pcr</span>(Salary<span class="sc">~</span>., <span class="at">data=</span>Hitters, <span class="at">scale=</span><span class="cn">TRUE</span>, <span class="at">ncomp=</span><span class="dv">5</span>)</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pcr.fitall)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data:   X dimension: 263 19 
    Y dimension: 263 1
Fit method: svdpc
Number of components considered: 5
TRAINING: % variance explained
        1 comps  2 comps  3 comps  4 comps  5 comps
X         38.31    60.16    70.84    79.03    84.29
Salary    40.63    41.58    42.17    43.22    44.90</code></pre>
</div>
</div>
</section>
</section>
<section id="partial-least-squares-method" class="level3" data-number="4.2.13">
<h3 data-number="4.2.13" class="anchored" data-anchor-id="partial-least-squares-method"><span class="header-section-number">4.2.13</span> Partial Least Squares Method</h3>
<p>Difference to PCR:</p>
<ul>
<li><p>It identifies the new features in a supervised way:</p>
<ul>
<li>Take each variable of <span class="math inline">\(X_1\)</span> to regress onto each point of <span class="math inline">\(Y_1\)</span>, to obtain the coefficient as <span class="math inline">\(\hat{\beta}_{1,1} , \hat{\beta}_{1,2}, ...\)</span></li>
<li>Afterwhich take the residuals of the regression and do it again against <span class="math inline">\(X_2\)</span></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>pls.fit <span class="ot">&lt;-</span> <span class="fu">plsr</span>(Salary<span class="sc">~</span>., <span class="at">data=</span>Hitters, <span class="at">subset=</span>train,</span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">scale=</span><span class="cn">TRUE</span>, <span class="at">validation=</span><span class="st">"CV"</span>) </span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pls.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data:   X dimension: 131 19 
    Y dimension: 131 1
Fit method: kernelpls
Number of components considered: 19

VALIDATION: RMSEP
Cross-validated using 10 random segments.
       (Intercept)  1 comps  2 comps  3 comps  4 comps  5 comps  6 comps
CV           428.3    325.5    329.9    328.8    339.0    338.9    340.1
adjCV        428.3    325.0    328.2    327.2    336.6    336.1    336.6
       7 comps  8 comps  9 comps  10 comps  11 comps  12 comps  13 comps
CV       339.0    347.1    346.4     343.4     341.5     345.4     356.4
adjCV    336.2    343.4    342.8     340.2     338.3     341.8     351.1
       14 comps  15 comps  16 comps  17 comps  18 comps  19 comps
CV        348.4     349.1     350.0     344.2     344.5     345.0
adjCV     344.2     345.0     345.9     340.4     340.6     341.1

TRAINING: % variance explained
        1 comps  2 comps  3 comps  4 comps  5 comps  6 comps  7 comps  8 comps
X         39.13    48.80    60.09    75.07    78.58    81.12    88.21    90.71
Salary    46.36    50.72    52.23    53.03    54.07    54.77    55.05    55.66
        9 comps  10 comps  11 comps  12 comps  13 comps  14 comps  15 comps
X         93.17     96.05     97.08     97.61     97.97     98.70     99.12
Salary    55.95     56.12     56.47     56.68     57.37     57.76     58.08
        16 comps  17 comps  18 comps  19 comps
X          99.61     99.70     99.95    100.00
Salary     58.17     58.49     58.56     58.62</code></pre>
</div>
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">validationplot</span>(pls.fit, <span class="at">val.type=</span><span class="st">"MSEP"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we find the lowest CV error when M=1</span></span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the test MSE</span></span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true" tabindex="-1"></a>pls.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(pls.fit, x[test,], <span class="at">ncomp=</span><span class="dv">1</span>)</span>
<span id="cb322-4"><a href="#cb322-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((pls.pred<span class="sc">-</span>y[test])<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 151995.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit PLS on the full data set with M=1</span></span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>pls.fitall <span class="ot">&lt;-</span> <span class="fu">plsr</span>(Salary<span class="sc">~</span>., <span class="at">data=</span>Hitters, <span class="at">scale=</span><span class="cn">TRUE</span>, <span class="at">ncomp=</span><span class="dv">1</span>)</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pls.fitall)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data:   X dimension: 263 19 
    Y dimension: 263 1
Fit method: kernelpls
Number of components considered: 1
TRAINING: % variance explained
        1 comps
X         38.08
Salary    43.05</code></pre>
</div>
</div>
<p>Comments:</p>
<ul>
<li><p>PLS seeks directions that have high variance and high correlation with the response while PCR seeks only the high variance direction</p></li>
<li><p>PLS often performs no better than ridge regression or PCR</p></li>
<li><p>PLS is likely to increase variance</p></li>
</ul>
</section>
</section>
</section>
<section id="lesson-5-classification" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Lesson 5: Classification üêë</h1>
<p>The theory for the multinomial logistic regression takes from the basic logistic regression. It uses the form:</p>
<p><span class="math display">\[
p(X) = \frac{e^{\beta_0+\beta_1 X}}{1+e^{\beta_0+\beta_1 X}}
\]</span> Rearranging the above gives:</p>
<p><span class="math display">\[
log(\frac{p(X)}{1-p(X)}) = \beta_0 +\beta_1 X
\]</span> As the response variable is binary, we use the maximum likelihood function to estimate its parameters: <span class="math display">\[
l(\beta_0, \beta)= \prod_{i:y_i=1} p(x_i)\prod_{i:y_i=0} (1-p(x_i))
\]</span> The formula above has the same function type as your conditional probability equation.</p>
<p>The above form is used when the response variable <span class="math inline">\(Y\)</span> is binary.</p>
<section id="multinomial-logistic-regression" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="multinomial-logistic-regression"><span class="header-section-number">5.1</span> Multinomial Logistic Regression</h2>
<p>The multinomial logistic regression is an extension of the logistic regression where the response variable Y has more than 2 classes.</p>
<p>We first take a single class to serve as our baseline, known as <span class="math inline">\(K\)</span>.</p>
<p><span class="math display">\[
log(\frac{Pr(Y=k \space |\space X=x )}{Pr(Y=K \space |\space X=x }) = \beta_{k0} +\beta_{k1}x_1+...+\beta_{kp}x_p
\]</span></p>
<p>The slide below takes the third class, cc, as the baseline.</p>
<p><img src="images/Lesson5_img1.png" class="img-fluid"></p>
<section id="code-example" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="code-example"><span class="header-section-number">5.1.1</span> Code example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)  <span class="co"># Package for neural networks and multinomial logistic regression</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co"># Package for cleaning and structuring model outputs for easier interpretation</span></span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>mlr <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Datasets/MLR.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Y           X1              X2               X3        
 aa:5   Min.   :12.00   Min.   : 2.000   Min.   : 3.000  
 bb:7   1st Qu.:24.00   1st Qu.: 5.000   1st Qu.: 6.000  
 cc:9   Median :27.00   Median : 7.000   Median : 7.000  
        Mean   :25.95   Mean   : 7.143   Mean   : 7.476  
        3rd Qu.:29.00   3rd Qu.: 9.000   3rd Qu.: 8.000  
        Max.   :38.00   Max.   :14.000   Max.   :16.000  </code></pre>
</div>
</div>
<p>For this example, there are 3 classes, aa, bb and cc.</p>
<ul>
<li>Multinomial regression code</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>fit.mlr <span class="ot">&lt;-</span> <span class="fu">multinom</span>(Y<span class="sc">~</span>., <span class="at">data=</span>mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  15 (8 variable)
initial  value 23.070858 
iter  10 value 12.592935
iter  20 value 12.322802
iter  30 value 12.267744
iter  40 value 12.238805
iter  50 value 12.238785
final  value 12.238781 
converged</code></pre>
</div>
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(fit.mlr) # To get summary statistics</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit.mlr, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="co"># Tidies up the summary statistics for easier interpretation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 √ó 8
  y.level term        estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 bb      (Intercept)   -6.73      8.83     -0.762  0.446   -24.0      10.6  
2 bb      X1             0.256     0.228     1.12   0.262    -0.191     0.702
3 bb      X2            -1.05      0.620    -1.70   0.0896   -2.27      0.163
4 bb      X3             1.13      0.771     1.47   0.143    -0.382     2.64 
5 cc      (Intercept)   -1.22      6.87     -0.177  0.859   -14.7      12.3  
6 cc      X1             0.176     0.179     0.983  0.325    -0.175     0.527
7 cc      X2            -0.616     0.429    -1.44   0.151    -1.46      0.225
8 cc      X3             0.355     0.625     0.567  0.571    -0.871     1.58 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(fit.mlr<span class="sc">$</span>fitted.values,<span class="dv">3</span>) <span class="co"># Gets the predicted probabilities for each class of the dataset used</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      aa    bb    cc
1  0.982 0.000 0.018
2  0.990 0.000 0.010
3  0.916 0.003 0.081
4  0.912 0.001 0.087
5  0.048 0.364 0.587
6  0.181 0.119 0.700
7  0.011 0.514 0.475
8  0.088 0.465 0.447
9  0.014 0.340 0.645
10 0.031 0.846 0.123
11 0.000 0.994 0.006
12 0.000 0.998 0.002
13 0.016 0.630 0.354
14 0.125 0.386 0.489
15 0.046 0.233 0.722
16 0.007 0.185 0.808
17 0.166 0.292 0.541
18 0.105 0.144 0.751
19 0.043 0.216 0.741
20 0.243 0.096 0.661
21 0.074 0.173 0.753</code></pre>
</div>
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit.mlr, mlr) <span class="co"># Gets the predicted classes</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] aa aa aa aa cc cc bb bb cc bb bb bb bb cc cc cc cc cc cc cc cc
Levels: aa bb cc</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compares the predicted classes and actual classes</span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(model, mlr<span class="sc">$</span>Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     
model aa bb cc
   aa  4  0  0
   bb  0  5  1
   cc  1  2  8</code></pre>
</div>
</div>
<p>row is predicted class while column is the true class</p>
<ul>
<li>When we want to calculate the probability of a certain class</li>
</ul>
<p>For example we take the 5th observation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>mlr[<span class="dv">5</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Y X1 X2 X3
5 aa 28  6  7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the predicted prob for 5th obs.</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>bbcoef <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">6.733</span>, <span class="fl">0.2555</span>, <span class="sc">-</span><span class="fl">1.052</span>, <span class="fl">1.1302</span>)</span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>cccoef <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.218</span>, <span class="fl">0.1759</span>, <span class="sc">-</span><span class="fl">0.6155</span>, <span class="fl">0.3546</span>)</span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a>fifth_obs_X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">28</span>, <span class="dv">6</span>, <span class="dv">7</span>) <span class="co"># (X value for B0, X1, X2, X3)</span></span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true" tabindex="-1"></a>den <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="fu">sum</span>(bbcoef<span class="sc">*</span>fifth_obs_X))<span class="sc">+</span><span class="fu">exp</span>(<span class="fu">sum</span>(cccoef<span class="sc">*</span>fifth_obs_X)) <span class="co"># Denominator formula</span></span>
<span id="cb340-7"><a href="#cb340-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-8"><a href="#cb340-8" aria-hidden="true" tabindex="-1"></a>proaa <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>den</span>
<span id="cb340-9"><a href="#cb340-9" aria-hidden="true" tabindex="-1"></a>probb <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">sum</span>(bbcoef<span class="sc">*</span>fifth_obs_X))<span class="sc">/</span>den</span>
<span id="cb340-10"><a href="#cb340-10" aria-hidden="true" tabindex="-1"></a>procc <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">sum</span>(cccoef<span class="sc">*</span>fifth_obs_X))<span class="sc">/</span>den</span>
<span id="cb340-11"><a href="#cb340-11" aria-hidden="true" tabindex="-1"></a>proaa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04835577</code></pre>
</div>
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a>probb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3646673</code></pre>
</div>
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>procc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5869769</code></pre>
</div>
</div>
</section>
</section>
<section id="linear-and-quadratic-discriminant-analysis" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="linear-and-quadratic-discriminant-analysis"><span class="header-section-number">5.2</span> Linear and Quadratic Discriminant Analysis</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Linear Discriminant Analysis Vs Logistic Regression</caption>
<colgroup>
<col style="width: 75%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Linear_DA</th>
<th style="text-align: left;">Logistics_Regression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Estimates the distribution of X for each class separately, then use Bayes theorem to flip it around to find P(Y | X).</td>
<td style="text-align: left;">Directly estimates P(Y | X) without modelling the distribution of X.</td>
</tr>
<tr class="even">
<td style="text-align: left;">When classes are well-separated, it is more stable because it models joint distribution of X &amp; Y. If n is small and distribution of X is approximately normal in each classes, LDA estimates are more stable than logistic regression</td>
<td style="text-align: left;">When classes are well-separated, parameter estimates are unstable</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="theory-bayes-theorem" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="theory-bayes-theorem"><span class="header-section-number">5.2.1</span> Theory (Bayes Theorem)</h3>
<p><span class="math display">\[
Pr(Y=k \space | \space X=x) = \frac{Pr(X=x \space | \space Y=k)\cdot Pr(Y=k)}{Pr(X=x)}
\]</span> Suppose that <span class="math inline">\(F_1, F_2, ..., F_n\)</span> are mutually exclusive &amp; exhaustive events such that:</p>
<ul>
<li>Exactly one of the events must occur</li>
<li>Their union covers the entire sample space</li>
</ul>
<p>Now, suppose that event <span class="math inline">\(E\)</span> has occured and we are interested in determining which one of the <span class="math inline">\(F_j\)</span> also occured. By Bayes formula:</p>
<p><span class="math display">\[
Pr(Y=F_j \space | \space X=E) = \frac{Pr(X=E \space | \space Y=F_j)\cdot Pr(Y=F_j)}{Pr(X=E)}
\]</span> Simplifying the notations above we have: <span class="math display">\[
Pr(F_j \space | \space E) = \frac{Pr(E \space | \space F_j)\cdot Pr(F_j)}{Pr(X=E)}
\]</span></p>
<p>By definition from above when event <span class="math inline">\(E\)</span> can occur, it happens in conjunction with any one of the event <span class="math inline">\(F_j\)</span>.</p>
<p><span class="math display">\[
E = \cup^n_{i=1} EF_i
\]</span></p>
<p>Then:</p>
<p><span class="math display">\[
P(E) = \sum^n_{i=1} P(EF_i)=\sum^n_{i=1} P(F_i) \times P(E\space | \space F_i)
\]</span> The above formula is derived from the probability formula: (Event <span class="math inline">\(E\)</span> intersects event <span class="math inline">\(F_i\)</span>) <span class="math display">\[
P(A \cap B)=P(A|B)\cdot P(B)
\]</span></p>
<p>Hence, by using the formula, <span class="math inline">\(P(E)\)</span>, we have:</p>
<p><span class="math display">\[
Pr(F_j \space | \space E) = \frac{Pr(E \space | \space F_j)\cdot Pr(F_j)}{\sum^n_{i=1} P(F_i) \times P(E\space | \space F_i)}
\]</span></p>
<p>The general formula for discriminant analysis is:</p>
<p><span class="math display">\[
Pr(Y=k \space | \space X=x)=\frac{\pi_kf_k(x)}{\sum^K_{l=1} \pi_lf_l(x)}
\]</span> where:</p>
<ul>
<li><span class="math inline">\(f_k (x) = Pr(X=x \space | \space Y=k)\)</span> is the <strong>density</strong> for <span class="math inline">\(X\)</span> in class <span class="math inline">\(k\)</span>.</li>
<li><span class="math inline">\(\pi_k = Pr(Y=k)\)</span> is the marginal or prior probability for class <span class="math inline">\(k\)</span></li>
</ul>
<p><img src="images/Lesson5_img3.png" class="img-fluid"></p>
<p>For <span class="math inline">\(\pi = 0.5, \pi_2=0.5\)</span>,</p>
<ul>
<li><p>The two classes (green &amp; pink) have equal prior probabilities where mean = 0.</p></li>
<li><p>For any value below 0, the class to select is green.</p></li>
</ul>
<p>For <span class="math inline">\(\pi = 0.3, \pi_2=0.7\)</span>,</p>
<ul>
<li><p>The pink class has a higher prior probability at 0.7.</p></li>
<li><p>The decision boundary (black dotted line) shifts to the left to favor the pink class</p></li>
<li><p>Due to the inbalance classification, even if the green density function is slightly higher, the classification may favor the pink class due to higher prior probability.</p></li>
</ul>
</section>
<section id="linear-discriminant-analysis-lda" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="linear-discriminant-analysis-lda"><span class="header-section-number">5.2.2</span> Linear Discriminant Analysis (LDA)</h3>
<p>The Gaussian density has the form:</p>
<p><span class="math display">\[
f_k(x) = \frac{1}{\sqrt{2\pi} \sigma_k}e^{-\frac{1}{2}(\frac{x-\mu_k}{\sigma_k})^2}
\]</span> where:</p>
<ul>
<li><span class="math inline">\(\mu_k\)</span>: mean of class <span class="math inline">\(k\)</span></li>
<li><span class="math inline">\(\sigma_k^2\)</span>: variance of class <span class="math inline">\(k\)</span> <span class="math inline">\(\rightarrow\)</span> We assume all class share the same variance, <span class="math inline">\(\sigma_k = \sigma\)</span>.</li>
</ul>
<p>Using the Bayes Formula <span class="math inline">\(p_k(x) = Pr(Y=k \space| \space X=x)\)</span>:</p>
<p><span class="math display">\[
p_k(x) = \frac{\pi_k \frac{1}{\sqrt{2\pi}\sigma}e^{\frac{1}{2}(\frac{x-\mu_k}{\sigma})^2}}{\sum^K_{l=1} \pi_l \frac{1}{\sqrt{2\pi}\sigma}e^{\frac{1}{2}(\frac{x-\mu_l}{\sigma})^2}}
\]</span></p>
<p>From the above formula, by taking logs and discarding terms that do no depend on k, we see that this is equivalent to assigning <span class="math inline">\(x\)</span> to the class with the largest discriminant score:</p>
<p><span class="math display">\[
\delta_k(x) = x\cdot \frac{\mu_k}{\sigma^2}-\frac{\mu_k^2}{2\sigma^2}+log(\pi_k)
\]</span> Essentially, we see that <span class="math inline">\(\delta_k(x)\)</span> is a linear function of x.</p>
<p>Example: If there are 2 classes <span class="math inline">\((K=2)\)</span> and there is balanced classification <span class="math inline">\((\pi_1=\pi_2 =0.5)\)</span>, then the decision boundary is at :</p>
<p><span class="math display">\[
x = \frac{\mu_1+\mu_2}{2}
\]</span></p>
<p><img src="images/Lesson5_img4.png" class="img-fluid"></p>
<p><strong>Estimation of Parameters</strong></p>
<p>Typically the parameters <span class="math inline">\((\mu_i , \pi_i, \sigma^2)\)</span> are unknown and therefore we will need to estimate them.</p>
<p>$$ _k= \</p>
<p><em>k = </em>{i: y_i=k} x_i \</p>
<p> = ^K_{k=1} _{i: y_i=k} (x_i-<em>k)^2 = ^K</em>{k=1} _k^2 $$ where:</p>
<ul>
<li><span class="math inline">\(n_k\)</span>: no. of observations in a particulas class, <span class="math inline">\(k\)</span></li>
<li><span class="math inline">\(n\)</span>: Total no. of observation</li>
</ul>
<p>For each value of <span class="math inline">\(Y\)</span>, we take the mean,<span class="math inline">\(\mu_i\)</span> of the <span class="math inline">\(X\)</span> features and its <span class="math inline">\(\sum_i\)</span></p>
<p><img src="images/Lesson5_img5.png" class="img-fluid"> <strong>This chapter is actually giving me a headache</strong> ü§°ü§°ü§°</p>
<p>üò¢</p>
<p><img src="images/Lesson5_img6.png" class="img-fluid"></p>
<p><img src="images/Lesson5_img7.png" class="img-fluid"></p>
<section id="lda-coding" class="level4" data-number="5.2.2.1">
<h4 data-number="5.2.2.1" class="anchored" data-anchor-id="lda-coding"><span class="header-section-number">5.2.2.1</span> LDA Coding</h4>
<ul>
<li>Understanding the dataset</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) </span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Smarket)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Year           Lag1                Lag2                Lag3          
 Min.   :2001   Min.   :-4.922000   Min.   :-4.922000   Min.   :-4.922000  
 1st Qu.:2002   1st Qu.:-0.639500   1st Qu.:-0.639500   1st Qu.:-0.640000  
 Median :2003   Median : 0.039000   Median : 0.039000   Median : 0.038500  
 Mean   :2003   Mean   : 0.003834   Mean   : 0.003919   Mean   : 0.001716  
 3rd Qu.:2004   3rd Qu.: 0.596750   3rd Qu.: 0.596750   3rd Qu.: 0.596750  
 Max.   :2005   Max.   : 5.733000   Max.   : 5.733000   Max.   : 5.733000  
      Lag4                Lag5              Volume           Today          
 Min.   :-4.922000   Min.   :-4.92200   Min.   :0.3561   Min.   :-4.922000  
 1st Qu.:-0.640000   1st Qu.:-0.64000   1st Qu.:1.2574   1st Qu.:-0.639500  
 Median : 0.038500   Median : 0.03850   Median :1.4229   Median : 0.038500  
 Mean   : 0.001636   Mean   : 0.00561   Mean   :1.4783   Mean   : 0.003138  
 3rd Qu.: 0.596750   3rd Qu.: 0.59700   3rd Qu.:1.6417   3rd Qu.: 0.596750  
 Max.   : 5.733000   Max.   : 5.73300   Max.   :3.1525   Max.   : 5.733000  
 Direction 
 Down:602  
 Up  :648  
           
           
           
           </code></pre>
</div>
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Smarket)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1250    9</code></pre>
</div>
</div>
<ul>
<li>Train test split</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> (Smarket<span class="sc">$</span>Year <span class="sc">&lt;</span><span class="dv">2005</span>)</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>SMtrain <span class="ot">&lt;-</span> Smarket[train,]</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>SMtest <span class="ot">&lt;-</span> Smarket[<span class="sc">!</span>train,]</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(SMtest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 252   9</code></pre>
</div>
</div>
<ul>
<li>Perform LDA</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>y.test <span class="ot">&lt;-</span> SMtest<span class="sc">$</span>Direction</span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>lda.fit <span class="ot">&lt;-</span> <span class="fu">lda</span>(Direction <span class="sc">~</span>Lag1 <span class="sc">+</span>Lag2, <span class="at">data=</span>Smarket, <span class="at">subset=</span>train)</span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a>lda.fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lda(Direction ~ Lag1 + Lag2, data = Smarket, subset = train)

Prior probabilities of groups:
    Down       Up 
0.491984 0.508016 

Group means:
            Lag1        Lag2
Down  0.04279022  0.03389409
Up   -0.03954635 -0.03132544

Coefficients of linear discriminants:
            LD1
Lag1 -0.6420190
Lag2 -0.5135293</code></pre>
</div>
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lda.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that the plot above approximately supports normal distribution assumption</p>
<ul>
<li>Verify Class Probabilities and mean</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>up <span class="ot">&lt;-</span> SMtrain<span class="sc">$</span>Direction <span class="sc">==</span> <span class="st">"Up"</span>  <span class="co"># Boolean vector for "Up" days</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>probup <span class="ot">&lt;-</span> <span class="fu">length</span>(SMtrain<span class="sc">$</span>Direction[up]) <span class="sc">/</span> <span class="fu">length</span>(SMtrain<span class="sc">$</span>Direction)  <span class="co"># P(Up)</span></span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>probup  <span class="co"># Prior probability of "Up"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.508016</code></pre>
</div>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute mean values of Lag1 and Lag2 for "Up" and "Down" classes</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(SMtrain<span class="sc">$</span>Lag1[<span class="sc">!</span>up])  <span class="co"># Mean Lag1 for "Down" class</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04279022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(SMtrain<span class="sc">$</span>Lag1[up])   <span class="co"># Mean Lag1 for "Up" class</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.03954635</code></pre>
</div>
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(SMtrain<span class="sc">$</span>Lag2[<span class="sc">!</span>up])  <span class="co"># Mean Lag2 for "Down" class</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03389409</code></pre>
</div>
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(SMtrain<span class="sc">$</span>Lag2[up])   <span class="co"># Mean Lag2 for "Up" class</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.03132544</code></pre>
</div>
</div>
<ul>
<li>Make predictions on the Test set</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>lda.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda.fit, SMtest)</span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a>lda.class <span class="ot">&lt;-</span> lda.pred<span class="sc">$</span>class</span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(lda.class, y.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         y.test
lda.class Down  Up
     Down   35  35
     Up     76 106</code></pre>
</div>
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>lda.pred<span class="sc">$</span>posterior</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Down        Up
999  0.4901792 0.5098208
1000 0.4792185 0.5207815
1001 0.4668185 0.5331815
1002 0.4740011 0.5259989
1003 0.4927877 0.5072123
1004 0.4938562 0.5061438
1005 0.4951016 0.5048984
1006 0.4872861 0.5127139
1007 0.4907013 0.5092987
1008 0.4844026 0.5155974
1009 0.4906963 0.5093037
1010 0.5119988 0.4880012
1011 0.4895152 0.5104848
1012 0.4706761 0.5293239
1013 0.4744593 0.5255407
1014 0.4799583 0.5200417
1015 0.4935775 0.5064225
1016 0.5030894 0.4969106
1017 0.4978806 0.5021194
1018 0.4886331 0.5113669
1019 0.5006568 0.4993432
1020 0.5108735 0.4891265
1021 0.5039925 0.4960075
1022 0.4916335 0.5083665
1023 0.5041772 0.4958228
1024 0.5026751 0.4973249
1025 0.4914043 0.5085957
1026 0.4805964 0.5194036
1027 0.4882718 0.5117282
1028 0.5062187 0.4937813
1029 0.5005996 0.4994004
1030 0.4972965 0.5027035
1031 0.4958546 0.5041454
1032 0.4811777 0.5188223
1033 0.4841417 0.5158583
1034 0.4726388 0.5273612
1035 0.4836418 0.5163582
1036 0.5091007 0.4908993
1037 0.5135941 0.4864059
1038 0.4933839 0.5066161
1039 0.4926856 0.5073144
1040 0.4978472 0.5021528
1041 0.4920914 0.5079086
1042 0.5056346 0.4943654
1043 0.5062288 0.4937712
1044 0.4881894 0.5118106
1045 0.4725293 0.5274707
1046 0.4832339 0.5167661
1047 0.4835086 0.5164914
1048 0.4913334 0.5086666
1049 0.4877566 0.5122434
1050 0.4724386 0.5275614
1051 0.4854877 0.5145123
1052 0.4932911 0.5067089
1053 0.4845973 0.5154027
1054 0.4723718 0.5276282
1055 0.4816170 0.5183830
1056 0.4914067 0.5085933
1057 0.4942755 0.5057245
1058 0.4841232 0.5158768
1059 0.5026064 0.4973936
1060 0.5062557 0.4937443
1061 0.4821800 0.5178200
1062 0.4885263 0.5114737
1063 0.5011825 0.4988175
1064 0.5000595 0.4999405
1065 0.5027377 0.4972623
1066 0.4870086 0.5129914
1067 0.4827213 0.5172787
1068 0.4996501 0.5003499
1069 0.4818079 0.5181921
1070 0.4651057 0.5348943
1071 0.4577867 0.5422133
1072 0.4775004 0.5224996
1073 0.5034250 0.4965750
1074 0.4801664 0.5198336
1075 0.5046171 0.4953829
1076 0.5044752 0.4955248
1077 0.4964663 0.5035337
1078 0.4892965 0.5107035
1079 0.4876236 0.5123764
1080 0.4805625 0.5194375
1081 0.4958518 0.5041482
1082 0.5115212 0.4884788
1083 0.4958572 0.5041428
1084 0.5082871 0.4917129
1085 0.5022091 0.4977909
1086 0.4875892 0.5124108
1087 0.4995948 0.5004052
1088 0.4841917 0.5158083
1089 0.4858843 0.5141157
1090 0.4826969 0.5173031
1091 0.4745012 0.5254988
1092 0.5008540 0.4991460
1093 0.5127766 0.4872234
1094 0.5135472 0.4864528
1095 0.5095127 0.4904873
1096 0.4950201 0.5049799
1097 0.4956088 0.5043912
1098 0.4964643 0.5035357
1099 0.4874363 0.5125637
1100 0.4970339 0.5029661
1101 0.5003751 0.4996249
1102 0.4846137 0.5153863
1103 0.4976914 0.5023086
1104 0.5043081 0.4956919
1105 0.4843366 0.5156634
1106 0.4860664 0.5139336
1107 0.4930417 0.5069583
1108 0.4887219 0.5112781
1109 0.4968147 0.5031853
1110 0.4944989 0.5055011
1111 0.4924743 0.5075257
1112 0.4980141 0.5019859
1113 0.4978727 0.5021273
1114 0.4994390 0.5005610
1115 0.5028317 0.4971683
1116 0.4964503 0.5035497
1117 0.4883202 0.5116798
1118 0.4899801 0.5100199
1119 0.4771957 0.5228043
1120 0.4694030 0.5305970
1121 0.4824692 0.5175308
1122 0.5037943 0.4962057
1123 0.5000974 0.4999026
1124 0.4805303 0.5194697
1125 0.4876953 0.5123047
1126 0.5070782 0.4929218
1127 0.4901776 0.5098224
1128 0.4860999 0.5139001
1129 0.5108497 0.4891503
1130 0.5135547 0.4864453
1131 0.5020218 0.4979782
1132 0.4956830 0.5043170
1133 0.4965536 0.5034464
1134 0.4964590 0.5035410
1135 0.4855719 0.5144281
1136 0.4951439 0.5048561
1137 0.5060048 0.4939952
1138 0.4880643 0.5119357
1139 0.4921175 0.5078825
1140 0.4927195 0.5072805
1141 0.4901661 0.5098339
1142 0.5001986 0.4998014
1143 0.5047746 0.4952254
1144 0.4875267 0.5124733
1145 0.4847648 0.5152352
1146 0.5028405 0.4971595
1147 0.5008435 0.4991565
1148 0.4825591 0.5174409
1149 0.4732124 0.5267876
1150 0.4797731 0.5202269
1151 0.4983172 0.5016828
1152 0.4968824 0.5031176
1153 0.4997031 0.5002969
1154 0.4914721 0.5085279
1155 0.4892300 0.5107700
1156 0.4787694 0.5212306
1157 0.4799234 0.5200766
1158 0.4913818 0.5086182
1159 0.4916287 0.5083713
1160 0.4948795 0.5051205
1161 0.4890900 0.5109100
1162 0.4790944 0.5209056
1163 0.4878531 0.5121469
1164 0.4861838 0.5138162
1165 0.4935558 0.5064442
1166 0.4941329 0.5058671
1167 0.5020762 0.4979238
1168 0.5043051 0.4956949
1169 0.4890430 0.5109570
1170 0.5062006 0.4937994
1171 0.5092767 0.4907233
1172 0.4893670 0.5106330
1173 0.4987776 0.5012224
1174 0.4997456 0.5002544
1175 0.4806852 0.5193148
1176 0.4790536 0.5209464
1177 0.4889496 0.5110504
1178 0.5039466 0.4960534
1179 0.4934174 0.5065826
1180 0.4748985 0.5251015
1181 0.4706261 0.5293739
1182 0.4868978 0.5131022
1183 0.4967554 0.5032446
1184 0.4929449 0.5070551
1185 0.4922853 0.5077147
1186 0.4933690 0.5066310
1187 0.5053601 0.4946399
1188 0.5030552 0.4969448
1189 0.4905837 0.5094163
1190 0.4762390 0.5237610
1191 0.4603392 0.5396608
1192 0.4697932 0.5302068
1193 0.4925300 0.5074700
1194 0.4861143 0.5138857
1195 0.4811376 0.5188624
1196 0.4812474 0.5187526
1197 0.4842383 0.5157617
1198 0.5026218 0.4973782
1199 0.5052312 0.4947688
1200 0.4813184 0.5186816
1201 0.5015397 0.4984603
1202 0.4877161 0.5122839
1203 0.4774171 0.5225829
1204 0.5168827 0.4831173
1205 0.5072640 0.4927360
1206 0.4833515 0.5166485
1207 0.4726701 0.5273299
1208 0.5032667 0.4967333
1209 0.5202350 0.4797650
1210 0.4950279 0.5049721
1211 0.5018767 0.4981233
1212 0.5089142 0.4910858
1213 0.4968911 0.5031089
1214 0.4951595 0.5048405
1215 0.4895942 0.5104058
1216 0.4904653 0.5095347
1217 0.5055318 0.4944682
1218 0.5055416 0.4944584
1219 0.4942470 0.5057530
1220 0.4857495 0.5142505
1221 0.4901606 0.5098394
1222 0.5069730 0.4930270
1223 0.5084764 0.4915236
1224 0.5041288 0.4958712
1225 0.5048299 0.4951701
1226 0.5023879 0.4976121
1227 0.4986903 0.5013097
1228 0.4824758 0.5175242
1229 0.4825469 0.5174531
1230 0.4831600 0.5168400
1231 0.5017497 0.4982503
1232 0.5058708 0.4941292
1233 0.4890321 0.5109679
1234 0.4911052 0.5088948
1235 0.4864250 0.5135750
1236 0.4847062 0.5152938
1237 0.4944890 0.5055110
1238 0.4962261 0.5037739
1239 0.5005702 0.4994298
1240 0.5039068 0.4960932
1241 0.4946376 0.5053624
1242 0.4864366 0.5135634
1243 0.4807022 0.5192978
1244 0.4851439 0.5148561
1245 0.4951734 0.5048266
1246 0.5005893 0.4994107
1247 0.4972210 0.5027790
1248 0.4791988 0.5208012
1249 0.4831673 0.5168327
1250 0.4892591 0.5107409</code></pre>
</div>
</div>
</section>
</section>
<section id="quadratic-discriminant-analysis-qda" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="quadratic-discriminant-analysis-qda"><span class="header-section-number">5.2.3</span> Quadratic Discriminant Analysis (QDA)</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Linear Discriminant Analysis Vs Quadratic Discriminant Analysis</caption>
<colgroup>
<col style="width: 51%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">QDA</th>
<th style="text-align: left;">LDA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Recommended if training set is very large so that the variance of the classifier is not a major concern.</td>
<td style="text-align: left;">Recommended if there are relatively few training observations and so reducing variance is crucial</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="performing-qda" class="level4" data-number="5.2.3.1">
<h4 data-number="5.2.3.1" class="anchored" data-anchor-id="performing-qda"><span class="header-section-number">5.2.3.1</span> Performing QDA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) </span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="co">#run the QDA</span></span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>qda.fit <span class="ot">&lt;-</span> <span class="fu">qda</span>(Direction <span class="sc">~</span>Lag1 <span class="sc">+</span>Lag2, <span class="at">data=</span>Smarket, <span class="at">subset=</span>train)</span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>qda.fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
qda(Direction ~ Lag1 + Lag2, data = Smarket, subset = train)

Prior probabilities of groups:
    Down       Up 
0.491984 0.508016 

Group means:
            Lag1        Lag2
Down  0.04279022  0.03389409
Up   -0.03954635 -0.03132544</code></pre>
</div>
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>qda.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(qda.fit, SMtest)</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>qda.class <span class="ot">&lt;-</span> qda.pred<span class="sc">$</span>class</span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(qda.class, y.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         y.test
qda.class Down  Up
     Down   30  20
     Up     81 121</code></pre>
</div>
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>qda.pred<span class="sc">$</span>posterior </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Down        Up
999  0.4873243 0.5126757
1000 0.4759011 0.5240989
1001 0.4636911 0.5363089
1002 0.4739253 0.5260747
1003 0.4903426 0.5096574
1004 0.4913561 0.5086439
1005 0.4922951 0.5077049
1006 0.4847447 0.5152553
1007 0.4889595 0.5110405
1008 0.4818971 0.5181029
1009 0.4900684 0.5099316
1010 0.5088085 0.4911915
1011 0.4894810 0.5105190
1012 0.4688268 0.5311732
1013 0.4722794 0.5277206
1014 0.4777870 0.5222130
1015 0.4911091 0.5088909
1016 0.5002717 0.4997283
1017 0.4955825 0.5044175
1018 0.4857602 0.5142398
1019 0.4978382 0.5021618
1020 0.5088226 0.4911774
1021 0.5019936 0.4980064
1022 0.4890898 0.5109102
1023 0.5011552 0.4988448
1024 0.5029427 0.4970573
1025 0.4885935 0.5114065
1026 0.4773670 0.5226330
1027 0.4875491 0.5124509
1028 0.5031841 0.4968159
1029 0.4988682 0.5011318
1030 0.4943720 0.5056280
1031 0.4932670 0.5067330
1032 0.4779771 0.5220229
1033 0.4828989 0.5171011
1034 0.4686765 0.5313235
1035 0.4867180 0.5132820
1036 0.5061436 0.4938564
1037 0.5109079 0.4890921
1038 0.4931027 0.5068973
1039 0.4910824 0.5089176
1040 0.4958007 0.5041993
1041 0.4892484 0.5107516
1042 0.5022091 0.4977909
1043 0.5053155 0.4946845
1044 0.4855167 0.5144833
1045 0.4690712 0.5309288
1046 0.4831366 0.5168634
1047 0.4805682 0.5194318
1048 0.4902077 0.5097923
1049 0.4858337 0.5141663
1050 0.4698923 0.5301077
1051 0.4843959 0.5156041
1052 0.4905323 0.5094677
1053 0.4815862 0.5184138
1054 0.4689277 0.5310723
1055 0.4814049 0.5185951
1056 0.4885751 0.5114249
1057 0.4914448 0.5085552
1058 0.4812931 0.5187069
1059 0.5012718 0.4987282
1060 0.5081566 0.4918434
1061 0.4790439 0.5209561
1062 0.4868818 0.5131182
1063 0.4982584 0.5017416
1064 0.4975554 0.5024446
1065 0.4996502 0.5003498
1066 0.4851946 0.5148054
1067 0.4815853 0.5184147
1068 0.4966225 0.5033775
1069 0.4796464 0.5203536
1070 0.4636960 0.5363040
1071 0.4538151 0.5461849
1072 0.4820244 0.5179756
1073 0.5003805 0.4996195
1074 0.4780442 0.5219558
1075 0.5068050 0.4931950
1076 0.5124387 0.4875613
1077 0.4949757 0.5050243
1078 0.4887039 0.5112961
1079 0.4870105 0.5129895
1080 0.4778475 0.5221525
1081 0.4969183 0.5030817
1082 0.5113935 0.4886065
1083 0.4935659 0.5064341
1084 0.5046634 0.4953366
1085 0.5034993 0.4965007
1086 0.4848677 0.5151323
1087 0.4966190 0.5033810
1088 0.4824520 0.5175480
1089 0.4862712 0.5137288
1090 0.4801670 0.5198330
1091 0.4734669 0.5265331
1092 0.4984590 0.5015410
1093 0.5113217 0.4886783
1094 0.5104849 0.4895151
1095 0.5084539 0.4915461
1096 0.4927715 0.5072285
1097 0.4928004 0.5071996
1098 0.4939716 0.5060284
1099 0.4845296 0.5154704
1100 0.4944847 0.5055153
1101 0.4984496 0.5015504
1102 0.4816396 0.5183604
1103 0.4959069 0.5040931
1104 0.5032464 0.4967536
1105 0.4814185 0.5185815
1106 0.4844718 0.5155282
1107 0.4902366 0.5097634
1108 0.4858445 0.5141555
1109 0.4940543 0.5059457
1110 0.4924324 0.5075676
1111 0.4897973 0.5102027
1112 0.4951866 0.5048134
1113 0.4950927 0.5049073
1114 0.4965423 0.5034577
1115 0.4999547 0.5000453
1116 0.4942398 0.5057602
1117 0.4854456 0.5145544
1118 0.4872440 0.5127560
1119 0.4736838 0.5263162
1120 0.4681314 0.5318686
1121 0.4809855 0.5190145
1122 0.5005476 0.4994524
1123 0.4994331 0.5005669
1124 0.4773193 0.5226807
1125 0.4862639 0.5137361
1126 0.5036709 0.4963291
1127 0.4896752 0.5103248
1128 0.4851648 0.5148352
1129 0.5070126 0.4929874
1130 0.5129701 0.4870299
1131 0.4999357 0.5000643
1132 0.4929348 0.5070652
1133 0.4936597 0.5063403
1134 0.4937373 0.5062627
1135 0.4826509 0.5173491
1136 0.4932151 0.5067849
1137 0.5037614 0.4962386
1138 0.4858747 0.5141253
1139 0.4905885 0.5094115
1140 0.4907389 0.5092611
1141 0.4877295 0.5122705
1142 0.4972110 0.5027890
1143 0.5019573 0.4980427
1144 0.4855927 0.5144073
1145 0.4834442 0.5165558
1146 0.4996410 0.5003590
1147 0.4991655 0.5008345
1148 0.4794670 0.5205330
1149 0.4707038 0.5292962
1150 0.4780817 0.5219183
1151 0.4955906 0.5044094
1152 0.4952687 0.5047313
1153 0.4967963 0.5032037
1154 0.4901190 0.5098810
1155 0.4874167 0.5125833
1156 0.4756804 0.5243196
1157 0.4805796 0.5194204
1158 0.4885518 0.5114482
1159 0.4888133 0.5111867
1160 0.4920147 0.5079853
1161 0.4863075 0.5136925
1162 0.4760189 0.5239811
1163 0.4862133 0.5137867
1164 0.4834118 0.5165882
1165 0.4918010 0.5081990
1166 0.4923133 0.5076867
1167 0.4992719 0.5007281
1168 0.5037133 0.4962867
1169 0.4862067 0.5137933
1170 0.5030510 0.4969490
1171 0.5099411 0.4900589
1172 0.4866822 0.5133178
1173 0.4962618 0.5037382
1174 0.4985132 0.5014868
1175 0.4774517 0.5225483
1176 0.4772544 0.5227456
1177 0.4863863 0.5136137
1178 0.5006561 0.4993439
1179 0.4926004 0.5073996
1180 0.4719438 0.5280562
1181 0.4679760 0.5320240
1182 0.4864026 0.5135974
1183 0.4942093 0.5057907
1184 0.4901043 0.5098957
1185 0.4894416 0.5105584
1186 0.4905175 0.5094825
1187 0.5019707 0.4980293
1188 0.5020337 0.4979663
1189 0.4877589 0.5122411
1190 0.4726802 0.5273198
1191 0.4569078 0.5430922
1192 0.4715695 0.5284305
1193 0.4901943 0.5098057
1194 0.4836028 0.5163972
1195 0.4793580 0.5206420
1196 0.4781441 0.5218559
1197 0.4822462 0.5177538
1198 0.4994533 0.5005467
1199 0.5037213 0.4962787
1200 0.4784324 0.5215676
1201 0.5015932 0.4984068
1202 0.4916045 0.5083955
1203 0.4803519 0.5196481
1204 0.5121334 0.4878666
1205 0.5117356 0.4882644
1206 0.4804165 0.5195835
1207 0.4691104 0.5308896
1208 0.5035075 0.4964925
1209 0.5224072 0.4775928
1210 0.4936598 0.5063402
1211 0.4991553 0.5008447
1212 0.5079052 0.4920948
1213 0.4944798 0.5055202
1214 0.4922825 0.5077175
1215 0.4868812 0.5131188
1216 0.4879647 0.5120353
1217 0.5021684 0.4978316
1218 0.5040885 0.4959115
1219 0.4916514 0.5083486
1220 0.4827964 0.5172036
1221 0.4877420 0.5122580
1222 0.5034870 0.4965130
1223 0.5072026 0.4927974
1224 0.5013232 0.4986768
1225 0.5022002 0.4977998
1226 0.4998972 0.5001028
1227 0.4960284 0.5039716
1228 0.4795114 0.5204886
1229 0.4814821 0.5185179
1230 0.4800757 0.5199243
1231 0.4999209 0.5000791
1232 0.5065969 0.4934031
1233 0.4861643 0.5138357
1234 0.4884233 0.5115767
1235 0.4835435 0.5164565
1236 0.4823991 0.5176009
1237 0.4916742 0.5083258
1238 0.4935411 0.5064589
1239 0.4975061 0.5024939
1240 0.5014406 0.4985594
1241 0.4922761 0.5077239
1242 0.4835458 0.5164542
1243 0.4776625 0.5223375
1244 0.4831210 0.5168790
1245 0.4922994 0.5077006
1246 0.4976701 0.5023299
1247 0.4947874 0.5052126
1248 0.4758642 0.5241358
1249 0.4826950 0.5173050
1250 0.4864459 0.5135541</code></pre>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="lesson-6-support-vector-machines" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Lesson 6: Support Vector Machines üê¥</h1>
<p>A hyperplane has the form: <span class="math display">\[
\beta_0+\beta_1X_1+\beta_2X_2 +... +\beta_pX_p=0
\]</span> - Has a subspace of dimension <span class="math inline">\(p-1\)</span> where <span class="math inline">\(p\)</span> is the number of features</p>
<p><img src="images/Lesson6_img1.png" class="img-fluid"></p>
<p>The above graph showcases a one dimensional plane. A vertical line (hyperplane) can be drawn to separate the blue and red dots.</p>
<ul>
<li>Ideally the distance from the blue dot to the line and the distance from the red dot to the line should be approximately equal. (See topic on margin)</li>
</ul>
<p><img src="images/Lesson5_img3.png" class="img-fluid"> Example: The hyperplane separates the points: - For the blue line, any point on the right is positive while any point on the left is negative <span class="math display">\[
-6+0.8X_1+0.6X_2=0
\]</span> Looking at Points (7,4) and (2,5), Sub in the points into the above equation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">6</span><span class="fl">+0.8</span><span class="sc">*</span>(<span class="dv">7</span>)<span class="sc">+</span><span class="fl">0.6</span><span class="sc">*</span><span class="dv">4</span> <span class="co"># Positive</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">6</span><span class="fl">+0.8</span><span class="sc">*</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.6</span><span class="sc">*</span><span class="dv">5</span> <span class="co"># negative</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.4</code></pre>
</div>
</div>
<section id="separating-hyperplane" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="separating-hyperplane"><span class="header-section-number">6.1</span> Separating Hyperplane</h2>
<p>Insert slide 6 of Note 6</p>
<p>Ensure that all purple points are more than 0. Any deviations would suggest misclassification aka, the hyperplane did not properly separate the two <span class="math inline">\(Y\)</span> observations.</p>
</section>
<section id="margin" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="margin"><span class="header-section-number">6.2</span> Margin</h2>
<ul>
<li>Denoted as <span class="math inline">\(M\)</span>
<ul>
<li>Distance from the observation to the hyperplane is known as Margin</li>
</ul></li>
</ul>
</section>
<section id="maximal-margin-classifier" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="maximal-margin-classifier"><span class="header-section-number">6.3</span> Maximal Margin Classifier</h2>
<ul>
<li>Maximise the margin (biggest gap) between the two classes</li>
</ul>
<p>Insert slide 8</p>
<p>The points that results in a distance within the margin is not that important.</p>
</section>
<section id="support-vector-classifier" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="support-vector-classifier"><span class="header-section-number">6.4</span> Support Vector classifier</h2>
<p>More often, data points generally do not allow for a clean separation. This is where we use support vector classifier that maximises a soft margin.</p>
<p>Insert Slide 11: - This allows for some misclassification that maximises the margin. - If a hard margin is wanted, one will have to sacrifise for a smaller margin.</p>
<p>Insert slide 12</p>
<p>Point 1 is called the incorrect side of the margin as it passed the margin line.</p>
<p>Point 11 is called the incorrect side of the hyperplane.</p>
<p>Insert slide 13:</p>
<p>The parameter <span class="math inline">\(C\)</span> controls for the severity of the classication/margin errors.</p>
<p>Insert Slide 14:</p>
<p>From the graph above: <span class="math inline">\(\epsilon_i=0\)</span>: 2, 3, 4, 5, 6,7, 9, 10 <span class="math inline">\(0&lt;\epsilon_i&lt;1\)</span>: 1, 8 <span class="math inline">\(\epsilon_i&gt;1\)</span>: 11, 12</p>
<p>Support vectors are: 2, 7, 9</p>
<p>Insert Slide 16:</p>
<p>Why variance is reduced when C is bigger? Since the margin is much wider, this means more observations becomes the support vector. If any one of the observation changes, it has little impact on the hyperplane as compared to when there is only two support vector.</p>
<p><strong>CODING FOR SVM</strong></p>
<p>The key is to maximise <span class="math inline">\(M\)</span> subject to <span class="math inline">\(\sum^{p}_{j=1} \beta_j^2=1\)</span></p>
<p>However, in SVM in R, it only takes in the ‚Äúcost‚Äù argument.</p>
<ul>
<li>A larger cost parameter <span class="math inline">\(\rightarrow\)</span> Low Budget C
<ul>
<li>Narrower margin</li>
<li>Fewer support vector</li>
<li>Lower bias and higher variance</li>
</ul></li>
<li>A smaller cost parameter <span class="math inline">\(\rightarrow\)</span> High Budget C
<ul>
<li>Larger margin</li>
<li>More support vector</li>
<li>Higher bias and lower variance</li>
</ul></li>
</ul>
</section>
<section id="numeric-example-1" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="numeric-example-1"><span class="header-section-number">6.5</span> Numeric Example 1:</h2>
<section id="simulation-of-data-and-basic-logistic-regression" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="simulation-of-data-and-basic-logistic-regression"><span class="header-section-number">6.5.1</span> Simulation of data and basic logistic regression</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Support Vector Classifier example</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="co"># numerical example 1</span></span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation of Data</span></span>
<span id="cb379-5"><a href="#cb379-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"aa"</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">"bb"</span>, <span class="dv">7</span>))</span>
<span id="cb379-6"><a href="#cb379-6" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">9</span>)</span>
<span id="cb379-7"><a href="#cb379-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">9</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">3</span>)</span>
<span id="cb379-8"><a href="#cb379-8" aria-hidden="true" tabindex="-1"></a>ss<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">7</span>))</span>
<span id="cb379-9"><a href="#cb379-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x2,x1, <span class="at">col=</span>ss<span class="sc">+</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>dd3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y, x1, x2, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple logistics regression</span></span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a>log1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y<span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">data=</span>dd3, <span class="at">family=</span>binomial)</span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true" tabindex="-1"></a>log1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = y ~ x1 + x2, family = binomial, data = dd3)

Coefficients:
(Intercept)           x1           x2  
    -5.9478       0.5869       0.8073  

Degrees of Freedom: 11 Total (i.e. Null);  9 Residual
Null Deviance:      16.3 
Residual Deviance: 9.041    AIC: 15.04</code></pre>
</div>
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(log1, <span class="at">data=</span>dd3, <span class="at">type=</span><span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1          2          3          4          5          6          7 
0.32353301 0.05025697 0.80056135 0.16535419 0.12073221 0.98256923 0.27729558 
         8          9         10         11         12 
0.98596778 0.58957488 0.91814491 0.93325123 0.85275864 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"predict aa"</span>, <span class="dv">12</span>)</span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a>gg[log1<span class="sc">$</span>fitted.values<span class="sc">&gt;</span><span class="fl">0.5</span>] <span class="ot">&lt;-</span> <span class="st">"Predicted bb"</span></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gg, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              y
gg             aa bb
  predict aa    4  1
  Predicted bb  1  6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "predict aa"   "predict aa"   "Predicted bb" "predict aa"   "predict aa"  
 [6] "Predicted bb" "predict aa"   "Predicted bb" "Predicted bb" "Predicted bb"
[11] "Predicted bb" "Predicted bb"</code></pre>
</div>
</div>
</section>
<section id="svm-with-cost-0.10" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="svm-with-cost-0.10"><span class="header-section-number">6.5.2</span> SVM with cost= 0.10</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>svm1 <span class="ot">&lt;-</span> <span class="fu">svm</span>(y<span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">data=</span>dd3, <span class="at">kernel=</span><span class="st">"linear"</span>, <span class="at">cost=</span>.<span class="dv">1</span>, <span class="at">scale=</span><span class="cn">FALSE</span>)</span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(svm1,dd3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a>svm1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm(formula = y ~ x1 + x2, data = dd3, kernel = "linear", cost = 0.1, 
    scale = FALSE)


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  linear 
       cost:  0.1 

Number of Support Vectors:  9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a>svm1<span class="sc">$</span>index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  3  4  5  7  9 10 11 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a>svm1<span class="sc">$</span>fitted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 1  2  3  4  5  6  7  8  9 10 11 12 
aa aa bb aa aa bb aa bb bb bb bb bb 
Levels: aa bb</code></pre>
</div>
</div>
</section>
<section id="svm-with-cost-10" class="level3" data-number="6.5.3">
<h3 data-number="6.5.3" class="anchored" data-anchor-id="svm-with-cost-10"><span class="header-section-number">6.5.3</span> SVM with cost= 10</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>svm2 <span class="ot">&lt;-</span> <span class="fu">svm</span>(y<span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">data=</span>dd3, <span class="at">kernel=</span><span class="st">"linear"</span>, <span class="at">cost=</span><span class="dv">10</span>, <span class="at">scale=</span><span class="cn">FALSE</span>)</span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(svm2,dd3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a>svm2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm(formula = y ~ x1 + x2, data = dd3, kernel = "linear", cost = 10, 
    scale = FALSE)


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  linear 
       cost:  10 

Number of Support Vectors:  7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a>svm2<span class="sc">$</span>index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  3  4  7  9 10 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a>svm2<span class="sc">$</span>fitted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 1  2  3  4  5  6  7  8  9 10 11 12 
aa aa bb aa aa bb aa bb bb bb bb bb 
Levels: aa bb</code></pre>
</div>
</div>
</section>
</section>
<section id="classification-with-non-linear-decision-boundaries-numeric-example-2" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="classification-with-non-linear-decision-boundaries-numeric-example-2"><span class="header-section-number">6.6</span> Classification with Non-Linear Decision Boundaries (Numeric Example 2)</h2>
<p>Purpose: To address <strong>non-linearity</strong> in the model - Enlarge Features with Polynomial Functions - Enlarge the feature space by including quadratic/cubic polynomials.</p>
<ul>
<li>Inner Product: Takes the sum of point coordinates <span class="math display">\[
(x_i, x_i')=\sum^{p}_{i=1} x_{ij}x_{i'j}
\]</span> For example: <span class="math inline">\(X_1: 4, 7, 6, 9\)</span> <span class="math inline">\(X_2: 2, 5, 4, 6\)</span></li>
</ul>
<p><span class="math inline">\((x_i, x_i')= 4\times2+7\times5+6\times4+9\times6\)</span></p>
<p><span class="math display">\[
f(x)=\beta_0 +\sum^{n}_{i=1} \alpha_i(x,x_i)
\]</span> Most <span class="math inline">\(\alpha\)</span>s can be zero as the observation that are away from the separation line do not contribute much to the parameters.</p>
<ul>
<li>Linear Kernel
<ul>
<li>Quantifies the similarity of the two observations</li>
</ul></li>
</ul>
</section>
<section id="numeric-example-2" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="numeric-example-2"><span class="header-section-number">6.7</span> Numeric Example 2:</h2>
<section id="simulation-of-data" class="level3" data-number="6.7.1">
<h3 data-number="6.7.1" class="anchored" data-anchor-id="simulation-of-data"><span class="header-section-number">6.7.1</span> Simulation of data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># numerical example 2:</span></span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">20</span><span class="sc">*</span><span class="dv">2</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>))</span>
<span id="cb402-6"><a href="#cb402-6" aria-hidden="true" tabindex="-1"></a>x[y <span class="sc">==</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> x[y <span class="sc">==</span><span class="dv">1</span>, ]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb402-7"><a href="#cb402-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">2</span>], x[,<span class="dv">1</span>], <span class="at">col=</span><span class="dv">3</span><span class="sc">-</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span><span class="fu">as.factor</span>(y))</span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          x.1         x.2  y
1  -0.6264538  0.91897737 -1
2   0.1836433  0.78213630 -1
3  -0.8356286  0.07456498 -1
4   1.5952808 -1.98935170 -1
5   0.3295078  0.61982575 -1
6  -0.8204684 -0.05612874 -1
7   0.4874291 -0.15579551 -1
8   0.7383247 -1.47075238 -1
9   0.5757814 -0.47815006 -1
10 -0.3053884  0.41794156 -1
11  2.5117812  2.35867955  1
12  1.3898432  0.89721227  1
13  0.3787594  1.38767161  1
14 -1.2146999  0.94619496  1
15  2.1249309 -0.37705956  1
16  0.9550664  0.58500544  1
17  0.9838097  0.60571005  1
18  1.9438362  0.94068660  1
19  1.8212212  2.10002537  1
20  1.5939013  1.76317575  1</code></pre>
</div>
</div>
</section>
<section id="svm-with-cost-10-1" class="level3" data-number="6.7.2">
<h3 data-number="6.7.2" class="anchored" data-anchor-id="svm-with-cost-10-1"><span class="header-section-number">6.7.2</span> SVM with cost 10</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>svmfit <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> ., <span class="at">data =</span>dat, <span class="at">kernel=</span><span class="st">"linear"</span>, <span class="at">cost =</span><span class="dv">10</span>, <span class="at">scale=</span><span class="cn">FALSE</span>)</span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(svmfit, dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a>svmfit<span class="sc">$</span>fitted <span class="co"># Shows how SVM classifies the points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 
-1  1 -1 -1  1 -1 -1 -1 -1 -1  1  1  1 -1  1  1  1  1  1  1 
Levels: -1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a>svmfit<span class="sc">$</span>index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  2  5  7 14 16 17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(svmfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm(formula = y ~ ., data = dat, kernel = "linear", cost = 10, scale = FALSE)


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  linear 
       cost:  10 

Number of Support Vectors:  7

 ( 4 3 )


Number of Classes:  2 

Levels: 
 -1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(svmfit<span class="sc">$</span>fitted, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    y
     -1 1
  -1  8 1
  1   2 9</code></pre>
</div>
</div>
</section>
<section id="svm-with-cost-0.1" class="level3" data-number="6.7.3">
<h3 data-number="6.7.3" class="anchored" data-anchor-id="svm-with-cost-0.1"><span class="header-section-number">6.7.3</span> SVM with cost 0.1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a>svmfit1 <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> ., <span class="at">data =</span>dat, <span class="at">kernel=</span><span class="st">"linear"</span>, <span class="at">cost =</span><span class="fl">0.1</span>, <span class="at">scale=</span><span class="cn">FALSE</span>)</span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(svmfit1, dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a>svmfit<span class="sc">$</span>fitted <span class="co"># Shows how SVM classifies the points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 
-1  1 -1 -1  1 -1 -1 -1 -1 -1  1  1  1 -1  1  1  1  1  1  1 
Levels: -1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>svmfit1<span class="sc">$</span>index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  7  9 10 12 13 14 15 16 17 18 20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(svmfit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm(formula = y ~ ., data = dat, kernel = "linear", cost = 0.1, scale = FALSE)


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  linear 
       cost:  0.1 

Number of Support Vectors:  16

 ( 8 8 )


Number of Classes:  2 

Levels: 
 -1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(svmfit1<span class="sc">$</span>fitted, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    y
     -1  1
  -1 10  1
  1   0  9</code></pre>
</div>
</div>
</section>
<section id="tuning-cross-validation" class="level3" data-number="6.7.4">
<h3 data-number="6.7.4" class="anchored" data-anchor-id="tuning-cross-validation"><span class="header-section-number">6.7.4</span> Tuning (Cross validation)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a>tune.out <span class="ot">&lt;-</span> <span class="fu">tune</span>(svm, y<span class="sc">~</span>., <span class="at">data=</span>dat, <span class="at">kernel=</span><span class="st">"linear"</span>, </span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ranges=</span><span class="fu">list</span>(<span class="at">cost=</span><span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">100</span>))) <span class="co"># Testing a range of cost</span></span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tune.out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Parameter tuning of 'svm':

- sampling method: 10-fold cross validation 

- best parameters:
 cost
  0.1

- best performance: 0.05 

- Detailed performance results:
   cost error dispersion
1 1e-03  0.55  0.4377975
2 1e-02  0.55  0.4377975
3 1e-01  0.05  0.1581139
4 1e+00  0.15  0.2415229
5 5e+00  0.15  0.2415229
6 1e+01  0.15  0.2415229
7 1e+02  0.15  0.2415229</code></pre>
</div>
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a>bestmod <span class="ot">&lt;-</span> tune.out<span class="sc">$</span>best.model</span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb425-5"><a href="#cb425-5" aria-hidden="true" tabindex="-1"></a>xtest <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">20</span><span class="sc">*</span><span class="dv">2</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb425-6"><a href="#cb425-6" aria-hidden="true" tabindex="-1"></a>ytest <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dv">20</span> , <span class="at">rep=</span><span class="cn">TRUE</span>)</span>
<span id="cb425-7"><a href="#cb425-7" aria-hidden="true" tabindex="-1"></a>xtest[ytest<span class="sc">==</span><span class="dv">1</span>, ] <span class="ot">&lt;-</span> xtest[ytest<span class="sc">==</span><span class="dv">1</span>,]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb425-8"><a href="#cb425-8" aria-hidden="true" tabindex="-1"></a>testdat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>xtest, <span class="at">y=</span><span class="fu">as.factor</span>(ytest))</span>
<span id="cb425-9"><a href="#cb425-9" aria-hidden="true" tabindex="-1"></a>ypred <span class="ot">&lt;-</span> <span class="fu">predict</span>(bestmod, testdat)</span>
<span id="cb425-10"><a href="#cb425-10" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">predict=</span>ypred, <span class="at">truth=</span>testdat<span class="sc">$</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       truth
predict -1 1
     -1  9 3
     1   2 6</code></pre>
</div>
</div>
</section>
</section>
<section id="polynomial-kernel" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="polynomial-kernel"><span class="header-section-number">6.8</span> Polynomial Kernel</h2>
<p><span class="math display">\[
f(x)=\beta_0+\sum_{i\subset S} \alpha_i K(x,x_i)
\]</span></p>
<p><span class="math display">\[
K(x_i, x_i')=(1+\sum^p_{j=1} x_{ij}x_{i'j})^d
\]</span></p>
<ul>
<li>d=1, it is standard linear kernel</li>
<li>d&gt;1, it fits a SVC in a higher dimensional space.</li>
</ul>
</section>
<section id="radial-kernel" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="radial-kernel"><span class="header-section-number">6.9</span> Radial Kernel</h2>
<p><span class="math display">\[
K(x_i,x_{i'})=exp(-\gamma \sum^p_{j=1} (x_{ij}-x_{i'j})^2)
\]</span></p>
<p><span class="math display">\[
f(x)=\beta_0 +\sum_{i\subset S} \hat{\alpha}_iK(x,x_i)
\]</span> This Kernel is more concern about the squared distance between two observation. - Thereby controls variance by reducing most dimensions severely</p>
<p>Insert Slide 30 Graph</p>
<p>Insert Slide 31: R function svm() will perform multi-class classification using OVO.</p>
</section>
<section id="numeric-example-3" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="numeric-example-3"><span class="header-section-number">6.10</span> Numeric Example 3:</h2>
<section id="simulation-of-data-1" class="level3" data-number="6.10.1">
<h3 data-number="6.10.1" class="anchored" data-anchor-id="simulation-of-data-1"><span class="header-section-number">6.10.1</span> Simulation of data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb427"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Support Vector Machine</span></span>
<span id="cb427-2"><a href="#cb427-2" aria-hidden="true" tabindex="-1"></a><span class="co"># numerical example 3: radial kernel</span></span>
<span id="cb427-3"><a href="#cb427-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb427-4"><a href="#cb427-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">200</span><span class="sc">*</span><span class="dv">2</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb427-5"><a href="#cb427-5" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,] <span class="ot">&lt;-</span> x[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb427-6"><a href="#cb427-6" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">101</span><span class="sc">:</span><span class="dv">150</span>, ] <span class="ot">&lt;-</span> x[<span class="dv">101</span><span class="sc">:</span><span class="dv">150</span>,]<span class="sc">-</span><span class="dv">2</span></span>
<span id="cb427-7"><a href="#cb427-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">150</span>), <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">50</span>))</span>
<span id="cb427-8"><a href="#cb427-8" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span><span class="fu">as.factor</span>(y))</span>
<span id="cb427-9"><a href="#cb427-9" aria-hidden="true" tabindex="-1"></a>dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            x.1           x.2 y
1    1.37354619  2.4094018397 1
2    2.18364332  3.6888732862 1
3    1.16437139  3.5865884334 1
4    3.59528080  1.6690921993 1
5    2.32950777 -0.2852355353 1
6    1.17953162  4.4976615898 1
7    2.48742905  2.6670661668 1
8    2.73832471  2.5413273360 1
9    2.57578135  1.9866004769 1
10   1.69461161  2.5101084230 1
11   3.51178117  1.8356241682 1
12   2.38984324  2.4206946433 1
13   1.37875942  1.5997532560 1
14  -0.21469989  0.6297921225 1
15   3.12493092  2.9878382675 1
16   1.95506639  3.5197450255 1
17   1.98380974  1.6912594308 1
18   2.94383621  0.7467102444 1
19   2.82122120  2.6422413057 1
20   2.59390132  1.9552908631 1
21   2.91897737  0.2667815932 1
22   2.78213630  2.0021318597 1
23   2.07456498  1.3696996661 1
24   0.01064830  1.6590314201 1
25   2.61982575  0.8434276374 1
26   1.94387126  3.8031419079 1
27   1.84420449  1.6688679636 1
28   0.52924762  0.3944865877 1
29   1.52184994  2.1971934387 1
30   2.41794156  2.2631756464 1
31   3.35867955  1.0141732996 1
32   1.89721227 -0.8889206717 1
33   2.38767161  1.3595182974 1
34   1.94619496  2.5705076359 1
35   0.62294044  1.9402767240 1
36   1.58500544  1.9018212560 1
37   1.60571005  2.5608207286 1
38   1.94068660  0.8135413614 1
39   3.10002537  3.0967770443 1
40   2.76317575  1.9946559717 1
41   1.83547640  2.7073106674 1
42   1.74663832  3.0341077347 1
43   2.69696338  2.2234804149 1
44   2.55666320  1.1212923871 1
45   1.31124431  3.1629645560 1
46   1.29250484 -0.0001649448 1
47   2.36458196  1.4552092600 1
48   2.76853292  1.7443292908 1
49   1.88765379  1.8338789632 1
50   2.88110773  3.0204639088 1
51   2.39810588  2.1362218931 1
52   1.38797361  2.4071676034 1
53   2.34111969  1.9303451870 1
54   0.87063690  1.7523356584 1
55   3.43302370  2.6955508066 1
56   3.98039990  3.1462283572 1
57   1.63277852 -0.4030962149 1
58   0.95586537  2.5727395552 1
59   2.56971963  2.3747244068 1
60   1.86494540  1.5747322784 1
61   4.40161776  2.9510128076 1
62   1.96076000  1.6107628183 1
63   2.68973936  1.7156693382 1
64   2.02800216  2.8574097781 1
65   1.25672679  3.7196272991 1
66   2.18879230  2.2700549009 1
67   0.19504137  1.5778159902 1
68   3.46555486  0.8108867051 1
69   2.15325334  1.6689670211 1
70   4.17261167  1.0601706735 1
71   2.47550953  1.7410674169 1
72   1.29005357  2.3943791682 1
73   2.61072635  1.1481429080 1
74   1.06590237  4.6491668811 1
75   0.74636660  2.1560116757 1
76   2.29144624  3.1302072675 1
77   1.55670813 -0.2891239798 1
78   2.00110535  2.7410011572 1
79   2.07434132  0.6837548395 1
80   1.41047905  2.9198036776 1
81   1.43133127  2.3981301555 1
82   1.86482138  1.5924714207 1
83   3.17808700  3.3242586302 1
84   0.47643320  1.2987683308 1
85   2.59394619  1.4193856958 1
86   2.33295037  0.9989278190 1
87   3.06309984  1.3318213932 1
88   1.69581608  2.9451849534 1
89   2.37001881  2.4337021495 1
90   2.26709879  3.0051592177 1
91   1.45747997  1.6098813359 1
92   3.20786781  2.3763702918 1
93   3.16040262  2.2441649245 1
94   2.70021365  0.5737426576 1
95   3.58683345  3.7784292875 1
96   2.55848643  2.1344476609 1
97   0.72340779  2.7655989992 1
98   1.42673459  2.9551366769 1
99   0.77538739  1.9494342986 1
100  1.52659936  1.6941845802 1
101 -2.62036668 -1.1063262976 1
102 -1.95788413 -3.0472981491 1
103 -2.91092165 -0.0286626138 1
104 -1.84197123 -2.3836321063 1
105 -2.65458464 -0.3458546977 1
106 -0.23271273 -0.4877873060 1
107 -1.28329252 -1.9170342664 1
108 -1.08982577 -1.4327790851 1
109 -1.61581464 -3.0245484795 1
110 -0.31782392 -1.6769934970 1
111 -2.63573645 -0.9563875416 1
112 -2.46164473 -1.9009215131 1
113 -0.56771776 -2.4541369092 1
114 -2.65069635 -2.6557818525 1
115 -2.20738074 -2.0359224226 1
116 -2.39280793 -0.9308385393 1
117 -2.31999287 -2.4839749303 1
118 -2.27911330 -2.1210101113 1
119 -1.50581167 -3.2941400038 1
120 -2.17733048 -1.5056871640 1
121 -2.50595746 -0.6920984799 1
122 -0.65696117 -0.5029589906 1
123 -2.21457941 -1.1852972691 1
124 -2.17955653 -3.8697887902 1
125 -2.10019074 -1.5179704959 1
126 -1.28733369 -1.5438643967 1
127 -2.07356440 -2.3534002858 1
128 -2.03763417 -1.8295105291 1
129 -2.68166048 -2.8640359541 1
130 -2.32427027 -1.3207692260 1
131 -1.93983956 -2.3271010147 1
132 -2.58889449 -3.5690821851 1
133 -1.46850381 -2.3674507562 1
134 -3.51839408 -0.6355650709 1
135 -1.69344214 -2.3342813647 1
136 -3.53644982 -1.2672499578 1
137 -2.30097613 -1.0534143598 1
138 -2.52827990 -1.9956012957 1
139 -2.65209478 -2.3523223055 1
140 -2.05689678 -2.5296955091 1
141 -3.91435943 -1.2604107744 1
142 -0.82341669 -3.0634574155 1
143 -3.66497244 -1.7537891565 1
144 -2.46353040 -2.2894993666 1
145 -3.11592011 -4.2648893565 1
146 -2.75081900 -3.4088504561 1
147  0.08716655 -1.0839806712 1
148 -1.98260438 -2.1912789505 1
149 -3.28630053 -1.1967167839 1
150 -3.64060553 -0.1125255367 1
151  0.45018710  1.4738811811 2
152 -0.01855983  0.6772684923 2
153 -0.31806837  0.3799626866 2
154 -0.92936215 -0.1927984265 2
155 -1.48746031  1.5778917949 2
156 -1.07519230  0.5962341093 2
157  1.00002880 -1.1735769409 2
158 -0.62126669 -0.1556425349 2
159 -1.38442685 -1.9189098203 2
160  1.86929062 -0.1952588461 2
161  0.42510038 -2.5923276699 2
162 -0.23864710  1.3140021672 2
163  1.05848305 -0.6355430010 2
164  0.88642265 -0.4299788387 2
165 -0.61924305 -0.1693183323 2
166  2.20610246  0.6122181740 2
167 -0.25502703  0.6783401772 2
168 -1.42449465  0.5679519725 2
169 -0.14439960 -0.5725426039 2
170  0.20753834 -1.3632912563 2
171  2.30797840 -0.3887222443 2
172  0.10580237  0.2779141325 2
173  0.45699881 -0.8230811216 2
174 -0.07715294 -0.0688409345 2
175 -0.33400084 -1.1676623261 2
176 -0.03472603 -0.0083090142 2
177  0.78763961  0.1288554016 2
178  2.07524501 -0.1458756285 2
179  1.02739244 -0.1639109567 2
180  1.20790840  1.7635520028 2
181 -1.23132342  0.7625865124 2
182  0.98389557  1.1114310807 2
183  0.21992480 -0.9232069528 2
184 -1.46725003  0.1643418384 2
185  0.52102274  1.1548251871 2
186 -0.15875460 -0.0565214245 2
187  1.46458731 -2.1293606482 2
188 -0.76608200  0.3448457621 2
189 -0.43021175 -1.9049554456 2
190 -0.92610950 -0.8111701531 2
191 -0.17710396  1.3240043213 2
192  0.40201178  0.6156368493 2
193 -0.73174817  1.0916689555 2
194  0.83037317  0.3066048615 2
195 -1.20808279 -0.1101587625 2
196 -1.04798441 -0.9243127731 2
197  1.44115771  1.5929137537 2
198 -1.01584747  0.0450105981 2
199  0.41197471 -0.7151284007 2
200 -0.38107605  0.8652230997 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb429"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">2</span>], x[,<span class="dv">1</span>], <span class="at">col=</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="train-test-split" class="level3" data-number="6.10.2">
<h3 data-number="6.10.2" class="anchored" data-anchor-id="train-test-split"><span class="header-section-number">6.10.2</span> Train-test split</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">200</span>, <span class="dv">100</span>)</span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a>svmfit3 <span class="ot">&lt;-</span> <span class="fu">svm</span>(y<span class="sc">~</span>., <span class="at">data=</span>dat[train,], <span class="at">kernel=</span><span class="st">"radial"</span>,</span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">gamma=</span><span class="dv">1</span>, <span class="at">cost=</span><span class="dv">1</span>)</span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(svmfit3, dat[train,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Notes_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="perform-cv-to-select-gamma-and-cost" class="level3" data-number="6.10.3">
<h3 data-number="6.10.3" class="anchored" data-anchor-id="perform-cv-to-select-gamma-and-cost"><span class="header-section-number">6.10.3</span> Perform CV to select <span class="math inline">\(\gamma\)</span> and cost</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="co">#perform the cross-validation to select gamma and cost</span></span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a>tune.out <span class="ot">&lt;-</span> <span class="fu">tune</span>(svm, y<span class="sc">~</span>., <span class="at">data=</span>dat[train,],</span>
<span id="cb431-3"><a href="#cb431-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel =</span><span class="st">"radial"</span>,</span>
<span id="cb431-4"><a href="#cb431-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ranges=</span><span class="fu">list</span>(</span>
<span id="cb431-5"><a href="#cb431-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cost=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>, <span class="dv">1000</span>),</span>
<span id="cb431-6"><a href="#cb431-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gamma=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)))</span>
<span id="cb431-7"><a href="#cb431-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tune.out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Parameter tuning of 'svm':

- sampling method: 10-fold cross validation 

- best parameters:
 cost gamma
    1   0.5

- best performance: 0.06 

- Detailed performance results:
    cost gamma error dispersion
1  1e-01   0.5  0.27 0.14944341
2  1e+00   0.5  0.06 0.08432740
3  1e+01   0.5  0.07 0.08232726
4  1e+02   0.5  0.10 0.09428090
5  1e+03   0.5  0.12 0.10327956
6  1e-01   1.0  0.18 0.16865481
7  1e+00   1.0  0.07 0.09486833
8  1e+01   1.0  0.09 0.09944289
9  1e+02   1.0  0.10 0.08164966
10 1e+03   1.0  0.09 0.09944289
11 1e-01   2.0  0.26 0.15776213
12 1e+00   2.0  0.08 0.11352924
13 1e+01   2.0  0.12 0.12292726
14 1e+02   2.0  0.12 0.13165612
15 1e+03   2.0  0.13 0.10593499
16 1e-01   3.0  0.27 0.13374935
17 1e+00   3.0  0.09 0.11005049
18 1e+01   3.0  0.10 0.13333333
19 1e+02   3.0  0.13 0.10593499
20 1e+03   3.0  0.15 0.10801234
21 1e-01   4.0  0.27 0.13374935
22 1e+00   4.0  0.09 0.12866839
23 1e+01   4.0  0.10 0.13333333
24 1e+02   4.0  0.15 0.13540064
25 1e+03   4.0  0.17 0.13374935</code></pre>
</div>
<div class="sourceCode cell-code" id="cb433"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a>tune.out<span class="sc">$</span>best.parameters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cost gamma
2    1   0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb435"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a>bestmod1 <span class="ot">&lt;-</span> tune.out<span class="sc">$</span>best.model</span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true" tabindex="-1"></a>pred1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(bestmod1, <span class="at">newdata=</span>dat[<span class="sc">-</span>train,])</span>
<span id="cb435-3"><a href="#cb435-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">true=</span>dat[<span class="sc">-</span>train, <span class="st">"y"</span>], pred1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    pred1
true  1  2
   1 67 10
   2  2 21</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>